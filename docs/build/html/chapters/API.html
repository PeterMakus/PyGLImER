

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>PyGLImER API &mdash; PyGLImER 0.01 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Common Conversion Point Stacking" href="ccp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PyGLImER
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Waveform Download, preprocessing, and receiver function creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="receiver_function.html">Handling Receiver Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ccp.html">Common Conversion Point Stacking</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">PyGLImER</span></code> API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-waveform">pyglimer.waveform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.request">pyglimer.waveform.request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.download">pyglimer.waveform.download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.preprocess">pyglimer.waveform.preprocess</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.preprocessh5">pyglimer.waveform.preprocessh5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.qc">pyglimer.waveform.qc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.rotate">pyglimer.waveform.rotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.errorhandler">pyglimer.waveform.errorhandler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-rf">pyglimer.rf</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.rf.create">pyglimer.rf.create</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.rf.deconvolve">pyglimer.rf.deconvolve</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.rf.moveout">pyglimer.rf.moveout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-database">pyglimer.database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.database.stations">pyglimer.database.stations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.database.asdf">pyglimer.database.asdf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-test">pyglimer.test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.test.rate">pyglimer.test.rate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.test.synthetic">pyglimer.test.synthetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pyglimer-test-tests">pyglimer.test.tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-utils">pyglimer.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.changedb">pyglimer.utils.changedb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.create_geom">pyglimer.utils.create_geom</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.createvmodel">pyglimer.utils.createvmodel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.geo_utils">pyglimer.utils.geo_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.nextpowof2">pyglimer.utils.nextpowof2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.roundhalf">pyglimer.utils.roundhalf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.signalproc">pyglimer.utils.signalproc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.utils">pyglimer.utils.utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-ccp">pyglimer.ccp</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.ccp.ccp">pyglimer.ccp.ccp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.ccp.io">pyglimer.ccp.io</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.ccp.compute.bin">pyglimer.ccp.compute.bin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-plot">pyglimer.plot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.plot.plot_map">pyglimer.plot.plot_map</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.plot.plot_utils">pyglimer.plot.plot_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.plot.plot_volume">pyglimer.plot.plot_volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.plot.ui_utils">pyglimer.plot.ui_utils</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyGLImER</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">PyGLImER</span></code> API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/chapters/API.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pyglimer-api">
<span id="api-label"></span><h1><code class="docutils literal notranslate"><span class="pre">PyGLImER</span></code> API<a class="headerlink" href="#pyglimer-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pyglimer-waveform">
<h2>pyglimer.waveform<a class="headerlink" href="#pyglimer-waveform" title="Permalink to this headline">¶</a></h2>
<p>Waveform download and preprocess</p>
<div class="section" id="module-pyglimer.waveform.request">
<span id="pyglimer-waveform-request"></span><h3>pyglimer.waveform.request<a class="headerlink" href="#module-pyglimer.waveform.request" title="Permalink to this headline">¶</a></h3>
<p>Contains the request class that is used to initialise the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Monday, 27th April 2020 10:55:03 pm
Last Modified: Thursday, 25th March 2021 04:04:50 pm</p>
<dl class="py class">
<dt id="pyglimer.waveform.request.Request">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.request.</span></code><code class="sig-name descname"><span class="pre">Request</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evtloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deconmeth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavdownload</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'v'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minmag</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">re_client</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['IRIS']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evtcat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>“Initialises the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<p>Create object that is used to start the receiver function
workflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>str</em>) – Arrival phase that is to be used as source phase.
“S” to create S-Sp receiver functions and “P” for P-Ps receiver
functions, “SKS” or “ScS” are allowed as well.</p></li>
<li><p><strong>rot</strong> (<em>str</em>) – The coordinate system in that the seismogram should be
rotated
prior to deconvolution. Options are “RTZ” for radial, transverse,
vertical; “LQT” for an orthogonal coordinate system computed by
minimising primary energy on the
converted component, or “PSS” for a rotation along the polarisation
directions using the Litho1.0 surface wave tomography model.</p></li>
<li><p><strong>evtloc</strong> (<em>str</em>) – Directory, in which to store the event catalogue (xml).</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Directory, in which to store the station inventories
(xml).</p></li>
<li><p><strong>rawloc</strong> (<em>str</em>) – Directory, in which to store the raw waveform data.</p></li>
<li><p><strong>preproloc</strong> (<em>str</em>) – Directory, in which to store
the preprocessed waveform data (mseed).</p></li>
<li><p><strong>rfloc</strong> (<em>str</em>) – Directory, in which to store the receiver functions in
time domain (sac).</p></li>
<li><p><strong>deconmeth</strong> (<em>str</em>) – The deconvolution method to use for the RF creation.
Possible options are:
‘it’: iterative time domain deconvolution (Ligorria &amp; Ammon, 1999)
‘dampedf’: damped frequency deconvolution
‘fqd’: frequency dependent damping - not a good choice for SRF
‘waterlevel’: Langston (1977)
‘multit’: for multitaper (Helffrich, 2006)
False/None: don’t create RFs</p></li>
<li><p><strong>starttime</strong> (<em>UTCDateTime</em>) – Earliest event date to be considered.</p></li>
<li><p><strong>endtime</strong> (<em>UTCDateTime</em>) – Latest event date to be considered.</p></li>
<li><p><strong>wavdownload</strong> (<em>bool</em><em>, </em><em>optional</em>) – Do you want to start a new download (True),
update the current database (True) or only preprocess and create
RFs from an existing database (False). False is a lot faster as all
CPUs can be used and the preprocessing does not have to wait for
the download, defaults to True.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarisation to use as source wavelet. Either “v” for
vertically polarised or ‘h’ for horizontally polarised S-waves.
Will be ignored if phase=’S’, by default ‘v’.</p></li>
<li><p><strong>minmag</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum magnitude, by default 5.5</p></li>
<li><p><strong>event_coords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – In case you wish to constrain events to certain
origns. Given in the form (minlat, maxlat, minlon, maxlon),
by default None.</p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Limit the dowloand and preprocessing to a certain
network or several networks (if type==list).
Wildcards are allowed, by default None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Limit the download and preprocessing to a certain
station or several stations. Use only if network!=None.
Wildcards are allowed, by default None.</p></li>
<li><p><strong>waveform_client</strong> (<em>list</em><em>, </em><em>optional</em>) – List of FDSN compatible servers to download
waveforms from.
See obspy documentation for obspy.Client for allowed acronyms.
A list of servers by region can be found at
<a class="reference external" href="https://www.fdsn.org/webservices/datacenters/">https://www.fdsn.org/webservices/datacenters/</a>. None means
that all known servers are requested, defaults to None.</p></li>
<li><p><strong>re_client</strong> (<em>list</em><em>, </em><em>optional</em>) – Only relevant, when debug=True. List of servers that
will be used if data is missing and the script will attempt a
redownload, usually it’s easier to just run a request several
times. Same logic as for waveform_client applies,
defaults to [‘IRIS’]</p></li>
<li><p><strong>evtcat</strong> (<em>str</em><em>, </em><em>optional</em>) – In case you want to use an already existing event
catalogue
in evtloc. If None a new catalogue will be downloaded (with the
parameters defined before), by default None, defaults to None</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, all loggers will go to DEBUG mode and all
warnings
will be shown. That will result in a lot of information being
shown! Also joblib will fall back to using only few cores,
by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NameError</strong> – For invalid phases.</p>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.waveform.request.Request.download_waveforms">
<code class="sig-name descname"><span class="pre">download_waveforms</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.download_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.download_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the download of waveforms and response files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Set True if you wish to log the output of the obspy MassDownloader.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.waveform.request.Request.preprocess">
<code class="sig-name descname"><span class="pre">preprocess</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hc_filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess an existing database. With parameters defined in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hc_filt</strong> (<em>float</em><em> or </em><em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Highcut frequency to filter with right before deconvolution.
Recommended if time domain deconvolution is used. For spectral
division, filtering can still be done after deconvolution (i.e.
set in <a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="pyglimer.ccp.ccp.CCPStack.compute_stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_stack()</span></code></a>).
Value for PRFs should usually be lower than 2 Hz and for SRFs lower
than .4 Hz, by default None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.download">
<span id="pyglimer-waveform-download"></span><h3>pyglimer.waveform.download<a class="headerlink" href="#module-pyglimer.waveform.download" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tue May 26 2019 13:31:30
Last Modified: Thursday, 25th March 2021 04:02:08 pm</p>
<dl class="py function">
<dt id="pyglimer.waveform.download.downloadwav">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></code><code class="sig-name descname"><span class="pre">downloadwav</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_epid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_cat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveasdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#downloadwav"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.downloadwav" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Downloads the waveforms for all events in the catalogue</dt><dd><p>for a circular domain around the epicentre with defined epicentral
distances from Clients defined in clients. Also Station
xmls for corresponding stations are downloaded.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>string</em>) – Arrival phase to be used. P, S, SKS, or ScS.</p></li>
<li><p><strong>min_epid</strong> (<em>float</em>) – Minimal epicentral distance to be downloaded.</p></li>
<li><p><strong>max_epid</strong> (<em>float</em>) – Maxmimal epicentral distance to be downloaded.</p></li>
<li><p><strong>model</strong> (<em>obspy.taup.TauPyModel</em>) – 1D velocity model to calculate arrival.</p></li>
<li><p><strong>event_cat</strong> (<em>Obspy event catalog</em>) – Catalog containing all events, for which waveforms should be
downloaded.</p></li>
<li><p><strong>tz</strong> (<em>int</em>) – time window before first arrival to download (seconds)</p></li>
<li><p><strong>ta</strong> (<em>int</em>) – time window after first arrival to download (seconds)</p></li>
<li><p><strong>statloc</strong> (<em>string</em>) – Directory containing the station xmls.</p></li>
<li><p><strong>rawloc</strong> (<em>string</em>) – Directory containing the raw seismograms.</p></li>
<li><p><strong>clients</strong> (<em>list</em>) – List of FDSN servers. See obspy.Client documentation for acronyms.</p></li>
<li><p><strong>network</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Network restrictions. Only download from these networks, wildcards
allowed. The default is None.</p></li>
<li><p><strong>station</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Only allowed if network != None. Station restrictions.
Only download from these stations, wildcards are allowed.
The default is None.</p></li>
<li><p><strong>saveasdf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save the dataset as Adaptable Seismic Data Format (asdf; recommended).
Else, one will be left with .mseeds.</p></li>
<li><p><strong>logdir</strong> (<em>string</em><em>, </em><em>optional</em>) – Set the directory to where the download log is saved</p></li>
<li><p><strong>debug</strong> (<em>Bool</em><em>, </em><em>optional</em>) – All loggers go to debug mode.</p></li>
<li><p><strong>verbose</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Set True, when experiencing issues with download. Output of
obspy MassDownloader will be logged in download.log.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.download.get_mseed_storage">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></code><code class="sig-name descname"><span class="pre">get_mseed_storage</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#get_mseed_storage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.get_mseed_storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the files and checks if files are already downloaded</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.download.wav_in_asdf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></code><code class="sig-name descname"><span class="pre">wav_in_asdf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#wav_in_asdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.wav_in_asdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the waveform already in the asdf database?</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.download.wav_in_db">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></code><code class="sig-name descname"><span class="pre">wav_in_db</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#wav_in_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.wav_in_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if waveform is already downloaded.</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.preprocess">
<span id="pyglimer-waveform-preprocess"></span><h3>pyglimer.waveform.preprocess<a class="headerlink" href="#module-pyglimer.waveform.preprocess" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 19th May 2019 8:59:40 pm
Last Modified: Sunday, 25th April 2021 11:37:16 am</p>
<dl class="py exception">
<dt id="pyglimer.waveform.preprocess.SNRError">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></code><code class="sig-name descname"><span class="pre">SNRError</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#SNRError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.SNRError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when the SNR is too high</p>
</dd></dl>

<dl class="py exception">
<dt id="pyglimer.waveform.preprocess.StreamLengthError">
<em class="property"><span class="pre">exception</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></code><code class="sig-name descname"><span class="pre">StreamLengthError</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#StreamLengthError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.StreamLengthError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when stream has fewer than 3 components</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.preprocess.preprocess">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></code><code class="sig-name descname"><span class="pre">preprocess</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_perc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_cat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.event.catalog.Catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.taup.tau.TauPyModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deconmeth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc_filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveasdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netrestr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statrestr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Preprocesses waveforms to create receiver functions</p>
<blockquote>
<div><p>1. Clips waveform to the right length
(tz before and ta after theorethical arrival.)
2. Demean &amp; Detrend
3. Tapering
4. Remove Instrument response, convert to velocity &amp;
simulate havard station.
5. Rotation to NEZ and, subsequently, to RTZ.
6. Compute SNR for highpass filtered waveforms
(highpass f defined in qc.lowco).
If SNR lower than in qc.SNR_criteria for all filters,
rejects waveform.
7. Write finished and filtered waveforms to folder
specified in qc.outputloc.
8. Write info file with shelf containing station,
event and waveform information.</p>
<p>Only starts after all waveforms of the event have been
downloaded by download.py.
(checked over the dynamic variables prepro_folder and tmp.folder)</p>
<p>Saves preprocessed waveform files.
Creates info file to save parameters.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>string</em>) – “P” or “S”</p></li>
<li><p><strong>rot</strong> (<em>string</em>) – Coordinate system to cast seismogram in before deconvolution.
Options are “RTZ”, “LQT”, or “PSS”.</p></li>
<li><p><strong>pol</strong> (<em>string</em>) – “h” for Sh or “v” for Sv, only for PRFs.</p></li>
<li><p><strong>taper_perc</strong> (<em>FLOAT</em>) – Percentage to be tapered in beginning and at the end of waveforms.</p></li>
<li><p><strong>taper_type</strong> (<em>STRING</em>) – Taper type (see obspy documentation stream.taper).</p></li>
<li><p><strong>event_cat</strong> (<em>event catalogue</em>) – catalogue containing all events of waveforms.</p></li>
<li><p><strong>model</strong> (<em>obspy.taup.TauPyModel</em>) – 1D velocity model to calculate arrival.</p></li>
<li><p><strong>tz</strong> (<em>int</em>) – time window before first arrival in seconds</p></li>
<li><p><strong>ta</strong> (<em>int</em>) – time window after first arrival in seconds</p></li>
<li><p><strong>logdir</strong> (<em>string</em><em>, </em><em>optional</em>) – Set the directory to where the download log is saved</p></li>
<li><p><strong>debug</strong> (<em>Bool</em><em>, </em><em>optional</em>) – All loggers go to debug mode.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.preprocess.write_info">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></code><code class="sig-name descname"><span class="pre">write_info</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dictionary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#write_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.write_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes information dictionary in shelve format in each of the station
folders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>str</em>) – Network Code.</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Station code.</p></li>
<li><p><strong>dictionary</strong> (<em>dict</em>) – Dictionary containing the information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.preprocessh5">
<span id="pyglimer-waveform-preprocessh5"></span><h3>pyglimer.waveform.preprocessh5<a class="headerlink" href="#module-pyglimer.waveform.preprocessh5" title="Permalink to this headline">¶</a></h3>
<p>This is a newer version of preprocess.py meant to be used with pyasdf.
Now, we will have to work in a very different manner than for .mseed files
and process files station wise rather than event wise.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Thursday, 18th February 2021 02:26:03 pm
Last Modified: Thursday, 25th March 2021 04:02:30 pm</p>
</div>
<div class="section" id="module-pyglimer.waveform.qc">
<span id="pyglimer-waveform-qc"></span><h3>pyglimer.waveform.qc<a class="headerlink" href="#module-pyglimer.waveform.qc" title="Permalink to this headline">¶</a></h3>
<p>Contains quality control for waveforms used for receiver function creation.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 10th April 2020 11:38:40 am
Last Modified: Thursday, 25th March 2021 04:03:31 pm</p>
<dl class="py function">
<dt id="pyglimer.waveform.qc.qcp">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.qc.</span></code><code class="sig-name descname"><span class="pre">qcp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/qc.html#qcp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.qc.qcp" title="Permalink to this definition">¶</a></dt>
<dd><p>Quality control for the downloaded waveforms that are used to create
PRFS. Works with various filters and SNR criteria</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>'~obspy.Stream'</em>) – Input stream.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>sampling_f</strong> (<em>FLOAT</em>) – Sampling frequency (Hz).</p></li>
<li><p><strong>onset</strong> (<em>float</em>) – Onset in seconds after trace’s start.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>st</strong> (<em>‘~obspy.Stream’</em>) – Output stream. If stream was accepted, then this will contain the
filtered stream, filtered with the broadest accepted filter.</p></li>
<li><p><strong>crit</strong> (<em>BOOL</em>) – True if stream was accepted, false if it wasn’t.</p></li>
<li><p><strong>f</strong> (<em>FLOAT</em>) – Last used low-cut frequency. If crit=True, this will be the frequency
for which the stream was accepted.</p></li>
<li><p><strong>noisemat</strong> (<em>np.array</em>) – SNR values in form of a matrix. Rows represent the different filters
and columns the different criteria.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.qc.qcs">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.qc.</span></code><code class="sig-name descname"><span class="pre">qcs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/qc.html#qcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.qc.qcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Quality control for waveforms that are used to produce SRF. In contrast
to the ones used for PRF this is a very rigid criterion and will reject
&gt;95% of the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>'~obspy.Stream'</em>) – Input stream.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>sampling_f</strong> (<em>FLOAT</em>) – Sampling frequency (Hz).</p></li>
<li><p><strong>onset</strong> (<em>float</em>) – Onset in seconds after trace’s start.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>st</strong> (<em>‘~obspy.Stream’</em>) – Output stream. If stream was accepted, then this will contain the
filtered stream, filtered with the broadest accepted filter.</p></li>
<li><p><strong>crit</strong> (<em>BOOL</em>) – True if stream was accepted, false if it wasn’t.</p></li>
<li><p><strong>f</strong> (<em>FLOAT</em>) – Last used high-cut frequency. If crit=True, this will be the frequency
for which the stream was accepted.</p></li>
<li><p><strong>noisemat</strong> (<em>np.array</em>) – SNR values in form of a matrix. Rows represent the different filters
and columns the different criteria.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.rotate">
<span id="pyglimer-waveform-rotate"></span><h3>pyglimer.waveform.rotate<a class="headerlink" href="#module-pyglimer.waveform.rotate" title="Permalink to this headline">¶</a></h3>
<p>Contains functions to rotate a stream into different domains</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Saturday, 21st March 2020 07:26:03 pm
Last Modified: Thursday, 25th March 2021 04:05:35 pm</p>
<dl class="py function">
<dt id="pyglimer.waveform.rotate.rotate_LQT">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.rotate.</span></code><code class="sig-name descname"><span class="pre">rotate_LQT</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_LQT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_LQT" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a stream given in RTZ to LQT using Singular Value Decomposition
Use rotate_LQT_min as it tends to deliver better results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input Stream in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “S” for Sp or “P” for Ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>LQT</strong> (<em>obspy.Stream</em>) – Output Stream in LQT.</p></li>
<li><p><strong>QC</strong> (<em>FLOAT</em>) – Quality control criterion. Energy balance at first arrival for L and Q.
Should deviate from 1 as far as possible.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.rotate.rotate_LQT_min">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.rotate.</span></code><code class="sig-name descname"><span class="pre">rotate_LQT_min</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_LQT_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_LQT_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates stream to LQT by minimising the energy of the S-wave primary
arrival on the L component (SRF) or maximising the primary arrival
energy on L (PRF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input stream in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>LQT</strong> (<em>obspy.Stream</em>) – Output stream in LQT.</p></li>
<li><p><strong>ia</strong> (<em>float</em>) – Computed incidence angle in degree. Can serve as QC criterion.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.rotate.rotate_PSV">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.rotate.</span></code><code class="sig-name descname"><span class="pre">rotate_PSV</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statlon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rayp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_PSV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_PSV" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the incidence angle of an incoming ray with the weighted average
of the lithosphere’s P velocity with a velocity model compiled from
Litho1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statlat</strong> (<em>FLOAT</em>) – station latitude.</p></li>
<li><p><strong>statlon</strong> (<em>FLOAT</em>) – station longitude.</p></li>
<li><p><strong>rayp</strong> (<em>FLOAT</em>) – ray parameter / slownesss in s/m.</p></li>
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input stream given in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Primary phase, either P or S.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>avp</strong> (<em>FLOAT</em>) – Average P-wave velocity.</p></li>
<li><p><strong>avs</strong> (<em>FLOAT</em>) – Average S-wave velocity.</p></li>
<li><p><strong>PSvSh</strong> (<em>obspy.Stream</em>) – Stream in P-Sv-Sh.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.errorhandler">
<span id="pyglimer-waveform-errorhandler"></span><h3>pyglimer.waveform.errorhandler<a class="headerlink" href="#module-pyglimer.waveform.errorhandler" title="Permalink to this headline">¶</a></h3>
<p>Files contains all Errorhandler for the Glimer to obspy project</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Saturday, 21th March 2020 19:16:41
Last Modified: Thursday, 25th March 2021 04:02:16 pm</p>
<dl class="py function">
<dt id="pyglimer.waveform.errorhandler.NoMatchingResponseHandler">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.errorhandler.</span></code><code class="sig-name descname"><span class="pre">NoMatchingResponseHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#NoMatchingResponseHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.NoMatchingResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Error handler for when the No matching response found error occurs.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.errorhandler.redownload">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.errorhandler.</span></code><code class="sig-name descname"><span class="pre">redownload</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#redownload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.redownload" title="Permalink to this definition">¶</a></dt>
<dd><p>Errorhandler that Redownloads the stream for the given input.
Used when the stream has less than three channels.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.errorhandler.redownload_statxml">
<code class="sig-prename descclassname"><span class="pre">pyglimer.waveform.errorhandler.</span></code><code class="sig-name descname"><span class="pre">redownload_statxml</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#redownload_statxml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.redownload_statxml" title="Permalink to this definition">¶</a></dt>
<dd><p>Errorhandler: Redownload station xml in case that it is not found.</p>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-rf">
<h2>pyglimer.rf<a class="headerlink" href="#pyglimer-rf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.rf.create">
<span id="pyglimer-rf-create"></span><h3>pyglimer.rf.create<a class="headerlink" href="#module-pyglimer.rf.create" title="Permalink to this headline">¶</a></h3>
<p>A toolset to create RFs and RF classes</p>
<p>Database management and overview for the PyGLImER database.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 12th February 2020 03:24:30 pm
Last Modified: Sunday, 25th April 2021 12:08:38 pm</p>
<p>!The file is split and has a second copyright disclaimer!
Some parts of this code are modified versions of the rf module by
Tom Eulenfeld.</p>
<dl class="py class">
<dt id="pyglimer.rf.create.RFStream">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></code><code class="sig-name descname"><span class="pre">RFStream</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.stream.Stream</span></code></p>
<p>Class providing the necessary functions for receiver function calculation.
:param traces: list of traces, single trace or stream object
To initialize a RFStream from a Stream object use
&gt;&gt;&gt; rfstream = RFStream(stream)
To initialize a RFStream from a file use
&gt;&gt;&gt; rfstream = read_rf(‘test.SAC’)
Format specific headers are loaded into the stats object of all traces.</p>
<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.method">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">method</span></code><a class="headerlink" href="#pyglimer.rf.create.RFStream.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Property for used rf method, ‘P’ or ‘S’</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.moveout">
<code class="sig-name descname"><span class="pre">moveout</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.moveout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration of all receiver functions given Stream.
Also calculates piercing points and adds them to RFTrace.stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel</strong> (<em>str</em>) – Velocity model located in /data/vmodel.
Standard options are iasp91.dat and 3D (GYPSuM).</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Appends two multiple mode RFs to the returned
RFStream.
False by default.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
<li><p><strong>taper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the last 10km of the RF will be tapered, which
avoids jumps in station stacks. Should be False for CCP stacks,
defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1D np.ndarray containing depths and an
object of type depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.ndarray, <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'PRF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epilimits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalingfactor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a receiver function section as a function
of epicentral distance or single plot if len(RFStream)==1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – y axis time limits in seconds (if self.stats.type==time)
or depth in km (if self.stats==depth) (len(list)==2).
If <cite>None</cite> full traces is plotted.
Default None.</p></li>
<li><p><strong>epilimits</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None = None</em><em>,</em>) – y axis time limits in seconds (len(list)==2).
If <cite>None</cite> from 30 to 90 degrees plotted.
Default None.</p></li>
<li><p><strong>scalingfactor</strong> (<em>float</em>) – sets the scale for the traces. Could be automated in
future functions(Something like mean distance between
traces)
Defaults to 2.0</p></li>
<li><p><strong>line</strong> (<em>bool</em>) – plots black line of the actual RF
Defaults to True</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – sets linewidth of individual traces</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>, optional) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – If True, clears out all axes and plots RF only.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>matplotlib.pyplot.Axes</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.plot_distribution">
<code class="sig-name descname"><span class="pre">plot_distribution</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.plot_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.plot_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot back azimuth and rayparameter distributions.</p>
<p>nbins (int) : Number of bins. Default
v (float) : assummed surface velocity for the computation of the</p>
<blockquote>
<div><p>incidence angle. Default 5.8 km/s.</p>
</div></blockquote>
<dl class="simple">
<dt>outputfile (str or None)<span class="classifier">Path to savefile. If None plot is not saved</span></dt><dd><p>just shown. Defaults to None.</p>
</dd>
</dl>
<p>format (str): outputfile format
dpi (int) : only used if file format is none vector.</p>
<p>None</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.ppoint">
<code class="sig-name descname"><span class="pre">ppoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iasp91.dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.ppoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates piercing points for all receiver functions in given
RFStream and adds them to self.stats in form of lat, lon and depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – velocity model located in /data/vmodel.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.slice2">
<code class="sig-name descname"><span class="pre">slice2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reftime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_empty_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.slice2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.slice2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative slice method accepting relative times.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">slice()</span></code> and <cite>trim2()</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.station_stack">
<code class="sig-name descname"><span class="pre">station_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iasp91.dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.station_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.station_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a moveout correction and stacks all receiver functions
in Stream. Make sure that Stream only contains RF from one station!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – 1D velocity model in data/vmodels.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Should RFs for multiples be calculated? If yes,
the parameter has to be a string, providing the stacking mode;
i.e. ‘linear’, ‘zk’ for a Zhu &amp; Kanamori approach, or ‘pws’ for
a phase-weighted stacking.
False by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>z : Depth Vector.
stack : Object containing station stack.
RF_mo : Object containing depth migrated traces.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>z : 1D np.ndarray
stack : <a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a>
RF_mo : <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.trim2">
<code class="sig-name descname"><span class="pre">trim2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reftime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.trim2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.trim2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative trim method accepting relative times.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">trim()</span></code>.
:param starttime,endtime: accept UTCDateTime or seconds relative to</p>
<blockquote>
<div><p>reftime</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reftime</strong> – reference time, can be an UTCDateTime object or a
string. The string will be looked up in the stats dictionary
(e.g. ‘starttime’, ‘endtime’, ‘onset’).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.type">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">type</span></code><a class="headerlink" href="#pyglimer.rf.create.RFStream.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Property for the type of stream, ‘rf’, ‘profile’ or None</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Save stream to file including format specific headers.
See <cite>Stream.write() &lt;obspy.core.stream.Stream.write&gt;</cite> in ObsPy.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyglimer.rf.create.RFTrace">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></code><code class="sig-name descname"><span class="pre">RFTrace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.trace.Trace</span></code></p>
<p>Class providing the Trace object for receiver function calculation.</p>
<p>This object is a modified version of Tom Eulenfeld’s rf project’s RFStream
class. License below.</p>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2013-2019 Tom Eulenfeld</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the “Software”),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.</p>
<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.moveout">
<code class="sig-name descname"><span class="pre">moveout</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.moveout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration of the receiver function.
Also calculates piercing points and adds them to RFTrace.stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel</strong> (<em>str</em>) – Velocity model located in /data/vmodel.
Standard options are iasp91.dat and 3D (GYPSuM).</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> , </em><em>optional</em>) – Should RFs from multiples be computed and returned?
False by default.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
<li><p><strong>taper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the last 10km of the RF will be tapered, which
avoids jumps in station stacks. Should be False for CCP stacks,
defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1D np.ndarray containing depths and an
RFTrace object of type depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.ndarray, <a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a single receiver function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – x axis time limits in seconds or km (depth) (len(list)==2).
If <cite>None</cite> full trace is plotted.
Default None.</p></li>
<li><p><strong>depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 1D array of depths</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>, optional) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – If True, clears out all axes and plots RF only.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>matplotlib.pyplot.Axes</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.ppoint">
<code class="sig-name descname"><span class="pre">ppoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.ppoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates piercing points for receiver function in and adds them
to self.stats in form of lat, lon and depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – velocity model located in /data/vmodel.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Save current trace into a file  including format specific headers.
See <cite>Trace.write() &lt;obspy.core.trace.Trace.write&gt;</cite> in ObsPy.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.createRF">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></code><code class="sig-name descname"><span class="pre">createRF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'v'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'it'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#createRF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.createRF" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a receiver function with the defined method from an obspy
stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st_in</strong> (<em>Stream</em>) – Stream of which components are to be deconvolved.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S”.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarisation to be deconvolved from. Only for phase = P,
defaults to ‘v’</p></li>
<li><p><strong>onset</strong> (<em>UTCDateTime</em><em>, </em><em>optional</em>) – Is used to shift function rather than shift if provided.
If info is provided, it will be extracted from info file,
defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Deconvolution method, “waterlevel”, ‘dampedf’ for constant
damping level, ‘it’ for iterative time domain deconvoltuion, ‘multit’
for multitaper or ‘fqd’ for frequency dependently damped spectral
division. The default is iterative time domain (‘it’).</p></li>
<li><p><strong>trim</strong> (<em>tuple</em><em>, </em><em>optional</em>) – taper/truncate. Given as tuple (a, b) in s - left,right.
The default is None.</p></li>
<li><p><strong>event</strong> (<em>event</em><em>, </em><em>optional</em>) – Event File used to extract additional information about
arrival. Provide either event and station or info dict. The default is
None.</p></li>
<li><p><strong>station</strong> (<em>'~obspy.core.station'</em><em>, </em><em>optional</em>) – Dictionary containing station information,
defaults to None</p></li>
<li><p><strong>info</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing information about the waveform, used to
extract additional information for header. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – If deconvolution method is unknown.</p></li>
<li><p><strong>Exception</strong> – For wrong trim input.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>RFTrace object containing receiver function.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.obj2stats">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></code><code class="sig-name descname"><span class="pre">obj2stats</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#obj2stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.obj2stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Map event and station object to stats with attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code>, optional) – Event File. The default is None.</p></li>
<li><p><strong>station</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Station</span></code>, optional) – Station file with attributes lat, lon, and elevation.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stats object with station and event attributes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AttribDict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.read_by_station">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></code><code class="sig-name descname"><span class="pre">read_by_station</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#read_by_station"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.read_by_station" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method to read all available receiver functions of one station
and a particular phase into one single stream. Subsequently, one could
for instance do a station stack by using
<a class="reference internal" href="#pyglimer.rf.create.RFStream.station_stack" title="pyglimer.rf.create.RFStream.station_stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">station_stack()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>str</em>) – Network shortcut, two digits, e.g. “IU”.</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Station shortcut, three digits, e.g. “HRV”</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Primary phase (“S” or “P”)</p></li>
<li><p><strong>rfdir</strong> (<em>str</em>) – Parental directory, in that the RF database is located</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RFStream object containing all receiver function of station x.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.read_rf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></code><code class="sig-name descname"><span class="pre">read_rf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathname_or_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#read_rf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.read_rf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read waveform files into RFStream object.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code> in ObsPy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pathname_or_url</strong> (<em>str</em>) – Path to file.</p></li>
<li><p><strong>format</strong> (<em>e.g. &quot;MSEED&quot;</em><em> or </em><em>&quot;SAC&quot;. Will attempt to determine from ending
if = None. The default is None.</em>) – str, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RFStream object from file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.rfstats">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></code><code class="sig-name descname"><span class="pre">rfstats</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'IASP91'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#rfstats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.rfstats" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a stats object for a RFTrace object. Provide an info dic and
starttime or event and station object. Latter will take longer since
computations are redone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S” for main phase.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Dictionary containing information about waveform. Can be None
if event and station are provided. Has to be given in combination with
starttime, defaults to None.</p></li>
<li><p><strong>starttime</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>, optional) – Starttime of first trace in stream, used as identifier in
info dict. The default is None.</p></li>
<li><p><strong>event</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code>, optional) – Event file, provide together with station file if info=None.
The default is None.</p></li>
<li><p><strong>station</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Station</span></code>, optional) – Station inventory with attributes lat, lon, and elevation,
defaults to None</p></li>
<li><p><strong>tt_model</strong> (<em>str</em><em>, </em><em>optional</em>) – TauPy model to calculate arrival, only used if no info
file is given. The default is “IASP91”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For unavailable phases</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Stats file for a RFTrace object with event and station
attributes, distance, back_azimuth, onset and
ray parameter.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AttribDict</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.rf.deconvolve">
<span id="pyglimer-rf-deconvolve"></span><h3>pyglimer.rf.deconvolve<a class="headerlink" href="#module-pyglimer.rf.deconvolve" title="Permalink to this headline">¶</a></h3>
<p>Various Deconvolution approaches used for the RF technique.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Wednesday, 16th October 2019 02:24:30 pm
Last Modified: Thursday, 25th March 2021 03:50:57 pm</p>
<dl class="py function">
<dt id="pyglimer.rf.deconvolve.damped">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">damped</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#damped"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.damped" title="Permalink to this definition">¶</a></dt>
<dd><p>Outdated use function spectraldivision instead!
A simple damped deconvolution. I just used it to benchmark
INPUT:</p>
<blockquote>
<div><p>P: denominator (t-domain)
H: enumerator (t-domain)
mu: damping factor</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.it">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">it</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#it"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.it" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterative deconvolution after Ligorria &amp; Ammon (1999)
Essentially, P will be deconvolved from H.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>1D np.ndarray</em>) – The source wavelet estimation / denominator.</p></li>
<li><p><strong>H</strong> (<em>1D np.ndarray</em>) – The enumerator (impulse response * source wavelet estimation).</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>shift</strong> (<em>float</em><em>, </em><em>optional</em>) – Time shift of main arrival [s]. The default is 0.</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width parameter. The default is 2.5.</p></li>
<li><p><strong>omega_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence control parameter (percentage improvement
per iteration). The default is 0.5.</p></li>
<li><p><strong>it_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximal number of iterations before the algorithm
interrupts, defaults to 400</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rf : The receiver function.
it : Number of iterations until algorithm converged.
IR : Estimation of the medium’s impulse response.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rf : np.ndarray
it : int
IR : np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.multitaper">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">multitaper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regul</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#multitaper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.multitaper" title="Permalink to this definition">¶</a></dt>
<dd><p>Output has to be filtered (Noise appears in high-frequency)!
multitaper: takes Ved-Kathrins code and changes inputs to
make it run like Helffrich algorithm, minus normalization and with
questionable calculation of pre-event noise (have to double check this
and compare it to the regular FFT based estimate without any tapers).</p>
<p>Findings: when P arrival is not in the center of the window, the
amplitudes are not unity at the beginning and decreasing from there on.
Instead they peak at the time shift which corresponds to the middle index
in the P time window.</p>
<p>TB  = time bandwidth product (usually between 2 and 4)
NT  = number of tapers to use, has to be &lt;= 2*TB-1
TB = 4; NT = 7; #choice of TB = 4, NT = 3 is supposed to be optimal
t0 = -5; t1 = max(time); # This defines the beginning and end of the lag
times for the receiver function</p>
<p>changed by KS June 2016, added coherence and variance estimate; output
RF in time domain (rf), RF in freq. domain (tmpp), and variance of RF
(var_rf); can be used as input for multitaper_weighting.m
the input “regul” defines which type of regularization is used,
regul=’fqd’ defines frequency dependent regularisation from pre-event
noise, regul=’con’ defines adding a constant value (here maximum of
pre-event noise) as regularisation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>np.ndarray</em>) – Source time function estimation.</p></li>
<li><p><strong>D</strong> (<em>np.ndarray</em>) – Component containing the converted wave.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, either ‘fqd’ for frequency dependentor ‘con’ for
constant.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For unknown input.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>rf</strong> (<em>np.ndarray</em>) – The receiver function.</p></li>
<li><p><strong>lrf</strong> (<em>np.ndarray</em>) – The source-time wavelet convolved by itself.</p></li>
<li><p><strong>var_rf</strong> (<em>np.ndarray</em>) – The receiver function’s variance.</p></li>
<li><p><strong>tmpp</strong> (<em>np.ndarray</em>) – Receiver function without variance weighting.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.spectraldivision">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">spectraldivision</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#spectraldivision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.spectraldivision" title="Permalink to this definition">¶</a></dt>
<dd><p>Function spectraldivision(v,u,ndt,tshift,regul) is a standard spectral
division frequency domain deconvolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>1D np.ndarray</em>) – Source wavelet estimation (denominator).</p></li>
<li><p><strong>u</strong> (<em>1D np.ndarray</em>) – Impulse response convolved by v (enumerator).</p></li>
<li><p><strong>ndt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, can be chosen by the variable “regul”, this
can be ‘con’, ‘wat’, or ‘fqd’ for constant damping factor, waterlevel,
or frequency-dependent damping, respectively</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Phase either “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – for uknown regulisations</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>qrf : Receiver function.
lrf : Output of deoncolution of source wavelet estimation from
longitudinal component.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>1D np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.rf.moveout">
<span id="pyglimer-rf-moveout"></span><h3>pyglimer.rf.moveout<a class="headerlink" href="#module-pyglimer.rf.moveout" title="Permalink to this headline">¶</a></h3>
<p>Contains functions for moveout correction and station stacking.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>!The file is split and has a second copyright disclaimer!</p>
<p>Created: Tuesday, 7th April 2020 10:08:30 am
Last Modified: Thursday, 25th March 2021 03:51:18 pm</p>
<dl class="py class">
<dt id="pyglimer.rf.moveout.SimpleModel">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></code><code class="sig-name descname"><span class="pre">SimpleModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#SimpleModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.SimpleModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple 1D velocity model for move out and piercing point calculation.
Calculated with Earth flattening algorithm as described by P. M. Shearer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> – depths in km</p></li>
<li><p><strong>vp</strong> – P wave velocities at provided depths in km/s</p></li>
<li><p><strong>vs</strong> – S wave velocities at provided depths in km/s</p></li>
<li><p><strong>n</strong> – number of support points between provided depths</p></li>
</ul>
</dd>
</dl>
<p>All arguments can be of type numpy.ndarray or list.
taken from the RF module based on obspy by Tom Eulenfeld</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.dt_table">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></code><code class="sig-name descname"><span class="pre">dt_table</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#dt_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.dt_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a phase delay table and calculates piercing points
for a specific ray parameter,
using the equation as in Rondenay 2009.
For SRF: The length of the output vectors is determined by the depth, at
which Sp conversion is supercritical (vertical slowness = complex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>float</em>) – ray-parameter given in s/deg.</p></li>
<li><p><strong>fname</strong> (<em>string</em>) – 1D velocity model, located in data/vmodels.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” for Sp or “P” for Ps.</p></li>
<li><p><strong>el</strong> (<em>float</em>) – station elevation in m.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em>) – Compute conversion time for PPS and PSS.</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, A Cartesioan rather than a spherical Earth is assumed. By
default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>htab</strong> (<em>np.array</em>) – Vector containing conversion depths.</p></li>
<li><p><strong>dt</strong> (<em>np.array</em>) – Vector containing delay times between primary arrival and converted
wave.</p></li>
<li><p><strong>delta</strong> (<em>np.array</em>) – Vector containing angular distance of piercing point from the
station at depth z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.dt_table_3D">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></code><code class="sig-name descname"><span class="pre">dt_table_3D</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#dt_table_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.dt_table_3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a phase delay table and calculates piercing points
for a specific ray parameter,
using the equation as in Rondenay 2009.
For SRF: The length of the output vectors is determined by the depth, at
which Sp conversion is supercritical (vertical slowness = complex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>float</em>) – ray-parameter given in s/deg.</p></li>
<li><p><strong>fname</strong> (<em>string</em>) – 1D velocity model, located in data/vmodels.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” for Sp or “P” for Ps.</p></li>
<li><p><strong>el</strong> (<em>float</em>) – station elevation in m.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D raytraycing.
Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em>) – Tuple in Form (minlon, maxlon)</p></li>
<li><p><strong>test</strong> (<em>Bool</em>) – If True, the raysum 3D model is loaded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>htab</strong> (<em>np.array</em>) – Vector containing conversion depths.</p></li>
<li><p><strong>dt</strong> (<em>np.array</em>) – Vector containing delay times between primary arrival and converted
wave.</p></li>
<li><p><strong>delta</strong> (<em>np.array</em>) – Vector containing Euclidian distance of piercing point from the
station at depth z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.earth_flattening">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></code><code class="sig-name descname"><span class="pre">earth_flattening</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#earth_flattening"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.earth_flattening" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a flat-earth approximated velocity model down to maxz as in
Peter M. Shearer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxz</strong> (<em>int</em>) – Maximal intepolation depth [km]. Given at beginning of file.</p></li>
<li><p><strong>z</strong> (<em>np.array</em>) – Depth vector [km].</p></li>
<li><p><strong>dz</strong> (<em>np.array</em>) – Layer thicknesses in km.</p></li>
<li><p><strong>vp</strong> (<em>np.array</em>) – P wave velocities [km/s].</p></li>
<li><p><strong>vs</strong> (<em>np.array</em>) – S wave velocities [km/s].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em>) – Same as input, but shortened to maxz.</p></li>
<li><p><strong>dz</strong> (<em>np.array</em>) – Same as input, but shortened to maxz.</p></li>
<li><p><strong>zf</strong> (<em>np.array</em>) – Depths in a Cartesian coordinate system.</p></li>
<li><p><strong>dzf</strong> (<em>np.array</em>) – Layer thicknesse in a Cartesian coordinate system.</p></li>
<li><p><strong>vpf</strong> (<em>np.array</em>) – P wave velocities in a Cartesian coordinate system.</p></li>
<li><p><strong>vsf</strong> (<em>np.array</em>) – S wave velocities in a Cartesian coordinate system.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.load_model">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></code><code class="sig-name descname"><span class="pre">load_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iasp91.dat'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 1D velocity model from file.
The model file should have 4 columns with depth, vp, vs, n.
The model file for iasp91 starts like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#IASP91 velocity model</span>
<span class="c1">#depth  vp    vs   n</span>
  <span class="mf">0.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">0</span>
  <span class="mf">0.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">0</span>
<span class="mf">10.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>string</em><em>, </em><em>optional</em>) – filename of model in data or ‘iasp91’.
The default is ‘iasp91.dat’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns SimpleModel instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.rf.moveout.SimpleModel" title="pyglimer.rf.moveout.SimpleModel">SimpleModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.moveout">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></code><code class="sig-name descname"><span class="pre">moveout</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.trace.Stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#moveout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration for RF.
Corrects the for the moveout of a converted phase. Flips time axis
and polarity of SRF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>1D np.ndarray</em>) – Receiver Function.</p></li>
<li><p><strong>st</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeDict</span></code>) – Stats from stream object.</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – 1D velocity model for moveout correction.
Use ‘3D’ for a 3D raytracing.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D raytraycing.
Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em>) – Tuple in Form (minlon, maxlon)</p></li>
<li><p><strong>taper</strong> (<em>bool</em>) – If True, the last 10km of the RF will be tapered,
which avoids jumps in station stacks. If False, the upper 5 km will be
tapered. Should be False for CCP stacks.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Either False (don’t include multiples), ‘linear’ for
linear stack, ‘PWS’ (phase weighted stack or “zk” for a zhu &amp;
kanamori approach). False by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>z2 : Depth vector in km.
RF2 : Vector containing the depth migrated RF.
delta : Vector containing Euclidian distance of piercing point from the</p>
<blockquote>
<div><p>station at depth z.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>3 times 1D np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.ppoint">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></code><code class="sig-name descname"><span class="pre">ppoint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_a</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_b</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#ppoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spherical distance between piercing point and station.
INPUT has to be in Cartesian/ flat Earth:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_a</strong> (<em>float</em>) – Vertical P-wave slowness in s/km.</p></li>
<li><p><strong>q_b</strong> (<em>float</em>) – Vertical S-wave slowness in s/km.</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – Vertical distance between two consecutive piercing points [km].</p></li>
<li><p><strong>p</strong> (<em>float</em>) – slowness in s/km.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” or “P”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x_delta</strong> – Euclidean distance between station and piercing point.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-database">
<h2>pyglimer.database<a class="headerlink" href="#pyglimer-database" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.database.stations">
<span id="pyglimer-database-stations"></span><h3>pyglimer.database.stations<a class="headerlink" href="#module-pyglimer.database.stations" title="Permalink to this headline">¶</a></h3>
<p>Database management and overview for the PyGLImER database.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 12th February 2020 03:24:30 pm
Last Modified: Thursday, 25th March 2021 03:47:07 pm</p>
<dl class="py function">
<dt id="pyglimer.database.stations.redownload_missing_statxmls">
<code class="sig-prename descclassname"><span class="pre">pyglimer.database.stations.</span></code><code class="sig-name descname"><span class="pre">redownload_missing_statxmls</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/stations.html#redownload_missing_statxmls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.stations.redownload_missing_statxmls" title="Permalink to this definition">¶</a></dt>
<dd><p>Fairly primitive program that walks through existing raw waveforms in
rawdir and looks for missing station xmls in statloc and, afterwards,
attemps a redownload</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clients</strong> (<em>list</em>) – List of clients (see obspy documentation for
<cite>~obspy.Client</cite>).</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S”, defines in which folder to look for mseeds.</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Folder, in which the station xmls are saved</p></li>
<li><p><strong>rawdir</strong> (<em>str</em>) – Uppermost directory, in which the raw mseeds are saved
(i.e. the directory above the phase division).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show some extra information, by default True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.database.asdf">
<span id="pyglimer-database-asdf"></span><h3>pyglimer.database.asdf<a class="headerlink" href="#module-pyglimer.database.asdf" title="Permalink to this headline">¶</a></h3>
<p>A module to handle and rewrite the PyGLiMER database to and in Adaptable
Seismic Format (asdf).</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 12th February 2021 03:24:30 pm
Last Modified: Thursday, 25th March 2021 03:36:57 pm</p>
<dl class="py function">
<dt id="pyglimer.database.asdf.writeraw">
<code class="sig-prename descclassname"><span class="pre">pyglimer.database.asdf.</span></code><code class="sig-name descname"><span class="pre">writeraw</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.event.event.Event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawfolder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/asdf.html#writeraw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.asdf.writeraw" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the downloaded miniseed, event, and stationxmls to a single asdf
file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<em>obspy.core.event.event.Event</em>) – Event that all the waveforms are associated to.</p></li>
<li><p><strong>rawfolder</strong> (<em>str</em>) – Folder to save the .h5 file to.</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Folder, in which the station xmls can be found</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – show warnings?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-test">
<h2>pyglimer.test<a class="headerlink" href="#pyglimer-test" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.test.rate">
<span id="pyglimer-test-rate"></span><h3>pyglimer.test.rate<a class="headerlink" href="#module-pyglimer.test.rate" title="Permalink to this headline">¶</a></h3>
<p>Contains various functions used to evaluate the quality of RF and waveforms</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 25th February 2020 07:28:30 pm
Last Modified: Thursday, 25th March 2021 03:49:56 pm</p>
<dl class="py function">
<dt id="pyglimer.test.rate.automatic_rate">
<code class="sig-prename descclassname"><span class="pre">pyglimer.test.rate.</span></code><code class="sig-name descname"><span class="pre">automatic_rate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#automatic_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.rate.automatic_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the automatic QC criteria for SRF waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (2 letters).</p></li>
<li><p><strong>station</strong> (<em>STRING</em>) – Station code (3 letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” or “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>diff</strong> (<em>INTEGER</em>) – Number of waveforms that were not rated 3 or 4.</p></li>
<li><p><strong>ret</strong> (<em>INTEGER</em>) – Number of automatically retained waveforms.</p></li>
<li><p><strong>sts</strong> (<em>LIST</em>) – List containing all retained + filtered streams.</p></li>
<li><p><strong>crits</strong> (<em>LIST</em>) – List containing bools (retained or not) corresponding to streams in
sts.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.rate.rate">
<code class="sig-prename descclassname"><span class="pre">pyglimer.test.rate.</span></code><code class="sig-name descname"><span class="pre">rate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">review</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decon_meth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'it'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_tt_calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.rate.rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Module to rate and review the quality of Sp or Ps waveforms from the given
station. Shows the automatic rating from qc. Tapers can be controlled with
the mouse. Rating is done with the keyboard. Makes only sense if the
files in preproloc have not been quality controlled (the script is a
reminant from an earlier alpha version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (two letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em>) – Either “P” for Ps or “S” Sp. The default is “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Station code (three letters).</p></li>
<li><p><strong>review</strong> (<em>INTEGER</em><em>, </em><em>optional</em>) – If true, already rated waveforms are shown.
Can also be an integer between 1 and 4. Then, only waveforms rated
with the respected rating are shown. The default is False.</p></li>
<li><p><strong>retained</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Show only waveforms retained by qcp or qcs. The default is False.</p></li>
<li><p><strong>decon_meth</strong> (<em>STRING</em><em>, </em><em>optional</em>) – Deconvolution method, “waterlevel”, ‘dampedf’ for constant
damping level, ‘it’ for iterative time domain deconvoltuion, ‘multit’
for multitaper or ‘fqd’ for frequency dependently damped spectral
division. The default is ‘it’</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For Typing mistakes.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.rate.sort_rated">
<code class="sig-prename descclassname"><span class="pre">pyglimer.test.rate.</span></code><code class="sig-name descname"><span class="pre">sort_rated</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#sort_rated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.rate.sort_rated" title="Permalink to this definition">¶</a></dt>
<dd><p>Functions that sorts waveforms in 4 folders,
depending on their manual rating.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (2 letters).</p></li>
<li><p><strong>station</strong> (<em>STRING</em>) – Station code (3 letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” or “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.test.synthetic">
<span id="pyglimer-test-synthetic"></span><h3>pyglimer.test.synthetic<a class="headerlink" href="#module-pyglimer.test.synthetic" title="Permalink to this headline">¶</a></h3>
<p>Create synthetic impulse resonses.
Used to test the deconvolve module.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Wednesday, 23rd October 2019 09:37:30 am
Last Modified: Thursday, 25th March 2021 03:53:12 pm</p>
<dl class="py function">
<dt id="pyglimer.test.synthetic.create_R">
<code class="sig-prename descclassname"><span class="pre">pyglimer.test.synthetic.</span></code><code class="sig-name descname"><span class="pre">create_R</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/synthetic.html#create_R"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.synthetic.create_R" title="Permalink to this definition">¶</a></dt>
<dd><p>Program to create random reflectivity series
INPUT
N2: half-length of the signal (N=2*N2+1)
M: number of seismic discontinuities</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.synthetic.synthetic">
<code class="sig-prename descclassname"><span class="pre">pyglimer.test.synthetic.</span></code><code class="sig-name descname"><span class="pre">synthetic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/synthetic.html#synthetic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.synthetic.synthetic" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create synthetic seismograms (given Impulse response convolved with a Ricker wavelet)
INPUT:</p>
<blockquote>
<div><p>N2: half-length of the Input traces, (full length N= N2*2+1)
dt: sampling rate
R: Impulse response / reflectivity series with length N
SNR: ratio of maximal amplitude of the source wavelet to max noise amplitude
stdv : standard deviation of the source pulse (controls width)</p>
</div></blockquote>
<dl>
<dt>Output:</dt><dd><dl class="simple">
<dt>v_noise: the theorethical source wavelet with noise independent from the noise on the horizontal compoennt</dt><dd><p>(equal to the hoizontal component of a seismogram in RF)</p>
</dd>
</dl>
<p>h_noise: The horizontal component of the seismogram with noise</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="pyglimer-test-tests">
<h3>pyglimer.test.tests<a class="headerlink" href="#pyglimer-test-tests" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="pyglimer-utils">
<h2>pyglimer.utils<a class="headerlink" href="#pyglimer-utils" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.utils.changedb">
<span id="pyglimer-utils-changedb"></span><h3>pyglimer.utils.changedb<a class="headerlink" href="#module-pyglimer.utils.changedb" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Monday, 25th May 2020 10:40:03
Last Modified: Thursday, 25th March 2021 03:55:01 pm</p>
<dl class="py function">
<dt id="pyglimer.utils.changedb.shortennames">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.changedb.</span></code><code class="sig-name descname"><span class="pre">shortennames</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/changedb.html#shortennames"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.changedb.shortennames" title="Permalink to this definition">¶</a></dt>
<dd><p>That was kinda a one-time function to correct a bug.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>phase</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.create_geom">
<span id="pyglimer-utils-create-geom"></span><h3>pyglimer.utils.create_geom<a class="headerlink" href="#module-pyglimer.utils.create_geom" title="Permalink to this headline">¶</a></h3>
<p>Automatic creation of raysum geom files</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Thursday, 14th May 2020 10:23:03
Last Modified: Thursday, 25th March 2021 03:56:04 pm</p>
<dl class="py function">
<dt id="pyglimer.utils.create_geom.create_geom">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.create_geom.</span></code><code class="sig-name descname"><span class="pre">create_geom</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bazv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raypv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cross'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/create_geom.html#create_geom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.create_geom.create_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates geometry files for Raysum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – Number of stations. Has to be uneven if shape=cross.
Else has to be N=M**2. Were M is a natural number</p></li>
<li><p><strong>bazv</strong> (<em>np.ndarray</em><em>(</em><em>1D</em><em>)</em>) – 1D array containing the backzimuths per station (deg).</p></li>
<li><p><strong>raypv</strong> (<em>np.ndarray</em><em>(</em><em>1D</em><em>)</em>) – 1D array containing the slownesses in s/m per backzimuth.</p></li>
<li><p><strong>shift_max</strong> (<em>int</em>) – Maximum horizontal shift in m.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the output file.</p></li>
<li><p><strong>shape</strong> (<em>str</em>) – shape of the array</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For Even Ns.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.createvmodel">
<span id="pyglimer-utils-createvmodel"></span><h3>pyglimer.utils.createvmodel<a class="headerlink" href="#module-pyglimer.utils.createvmodel" title="Permalink to this headline">¶</a></h3>
<p>Create a 3D velocity model using Litho1.0</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 01st May 2020 12:11:03
Last Modified: Thursday, 25th March 2021 03:56:56 pm</p>
<dl class="py function">
<dt id="pyglimer.utils.createvmodel.load_avvmodel">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.createvmodel.</span></code><code class="sig-name descname"><span class="pre">load_avvmodel</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/createvmodel.html#load_avvmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.createvmodel.load_avvmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a model over the average P and S-wave velocities in the upper
crust. These are used by the P-SV-SH rotation algorithm. Model data
is extracted from the Litho1.0 model (location provided above).
The package is distributed with a readily compiled model.</p>
<p>Litho1.0 must be installed and location must be set correct for a
complete compilation! However, function will first look in RAM and then
in data for a pickle file.</p>
<p>Compiling takes up to one hour!</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Model containing average velocities for upper crust.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.createvmodel.load_gyps">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.createvmodel.</span></code><code class="sig-name descname"><span class="pre">load_gyps</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/createvmodel.html#load_gyps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.createvmodel.load_gyps" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiles the GyPSuM 3D-velocity object from included GyPSuM text files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Pickle the 3D velocity model after compiling it for the first time.
This will allow for faster access to the model. Saving the model takes
about 800 MB disk space.
The default is False, as it lead to unstabilities with joblib.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Creates a submodel from the full model. In form (minlat, maxlat).</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – (minlon, maxlon)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Object that can be queried for velocities.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ComplexModel object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.geo_utils">
<span id="pyglimer-utils-geo-utils"></span><h3>pyglimer.utils.geo_utils<a class="headerlink" href="#module-pyglimer.utils.geo_utils" title="Permalink to this headline">¶</a></h3>
<p>Geographical utilities.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: November 2019</p>
<dl class="py function">
<dt id="pyglimer.utils.geo_utils.cart2geo">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></code><code class="sig-name descname"><span class="pre">cart2geo</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#cart2geo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.cart2geo" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes geographical coordinates from cartesian coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>numpy.array corresponding to y/z arrays</strong><strong>)</strong> (<em>x</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> (<em>z</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>r, latitude, longitude tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.epi2euc">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></code><code class="sig-name descname"><span class="pre">epi2euc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#epi2euc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.epi2euc" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts epicentral distance in to a euclidean distance along the
corresponding chord.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.euc2epi">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></code><code class="sig-name descname"><span class="pre">euc2epi</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">euc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#euc2epi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.euc2epi" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts euclidean distance to epicentral distance</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.geo2cart">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></code><code class="sig-name descname"><span class="pre">geo2cart</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#geo2cart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.geo2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cartesian coordinates from geographical coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>float</strong><strong> or </strong><strong>numpy.array corresponding to lat/lon arrays</strong><strong>)</strong> (<em>r</em>) – </p></li>
<li><p><strong>location</strong> – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> (<em>longitude</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xyz coordinates coordinates of same size as latitude and longitude arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.reckon">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></code><code class="sig-name descname"><span class="pre">reckon</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bearing</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#reckon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.reckon" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes new latitude and longitude from bearing and distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>lon</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>bearing</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>distance</strong> (<em>in degrees</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lat, lon</p>
</dd>
</dl>
<p>lat1 = math.radians(52.20472)  # Current lat point converted to radians
lon1 = math.radians(0.14056)  # Current long point converted to radians
bearing = np.pi/2 # 90 degrees
# lat2  52.20444 - the lat result I’m hoping for
# lon2  0.36056 - the long result I’m hoping for.</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.nextpowof2">
<span id="pyglimer-utils-nextpowof2"></span><h3>pyglimer.utils.nextpowof2<a class="headerlink" href="#module-pyglimer.utils.nextpowof2" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 18th October 2019 08:11:03 pm
Last Modified: Thursday, 25th March 2021 03:56:56 pm</p>
<dl class="py function">
<dt id="pyglimer.utils.nextpowof2.nextPowerOf2">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.nextpowof2.</span></code><code class="sig-name descname"><span class="pre">nextPowerOf2</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/nextpowof2.html#nextPowerOf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.nextpowof2.nextPowerOf2" title="Permalink to this definition">¶</a></dt>
<dd><p>just returns the next higher power of two from n</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.roundhalf">
<span id="pyglimer-utils-roundhalf"></span><h3>pyglimer.utils.roundhalf<a class="headerlink" href="#module-pyglimer.utils.roundhalf" title="Permalink to this headline">¶</a></h3>
<p>Rounds to next 0.5</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Saturday, 02nd May 2020 01:48:03 pm
Last Modified: Thursday, 25th March 2021 04:00:02 pm</p>
<dl class="py function">
<dt id="pyglimer.utils.roundhalf.roundhalf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.roundhalf.</span></code><code class="sig-name descname"><span class="pre">roundhalf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">float</span><a class="reference internal" href="../_modules/pyglimer/utils/roundhalf.html#roundhalf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.roundhalf.roundhalf" title="Permalink to this definition">¶</a></dt>
<dd><p>Rounds to next half of integer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number</strong> (<em>float/int</em>) – number to be rounded.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Closest half of integer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.signalproc">
<span id="pyglimer-utils-signalproc"></span><h3>pyglimer.utils.signalproc<a class="headerlink" href="#module-pyglimer.utils.signalproc" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Sunday, 20th October 2019 10:31:03 am
Last Modified: Thursday, 25th March 2021 04:01:06 pm</p>
<dl class="py function">
<dt id="pyglimer.utils.signalproc.convf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></code><code class="sig-name descname"><span class="pre">convf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#convf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.convf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolution conducted in the frequency domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>np.array</em>) – Array 1.</p></li>
<li><p><strong>v</strong> (<em>np.array</em>) – Array 2.</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling Interval [s].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>c</strong> – Convolution of u with v.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.corrf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></code><code class="sig-name descname"><span class="pre">corrf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#corrf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.corrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Cross-correlation in frequency domain,
calculates the x=crosscorr(u,v). Hence, v is the flipped vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>np.array</em>) – flipped vector.</p></li>
<li><p><strong>v</strong> (<em>np.array</em>) – Vector that the correlation is measured to.</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – Correlation vector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.filter">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></code><code class="sig-name descname"><span class="pre">filter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolves a filter with a signal (given in time domain).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>np.array</em>) – Signal given in time domain.</p></li>
<li><p><strong>F</strong> (<em>np.array</em>) – Filter’s amplitude response.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s_f</strong> – Filtered signal.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.gaussian">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></code><code class="sig-name descname"><span class="pre">gaussian</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a zero-phase Gaussian function. In particular meant to be
convolved with the impulse
response that is the output of an iterative deconvolution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>INTEGER</em>) – Length of the desired array.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>width</strong> (<em>FLOAT</em>) – Width parameter of the Gaussian function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>G</strong> – Gaussian window.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.noise">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></code><code class="sig-name descname"><span class="pre">noise</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.noise" title="Permalink to this definition">¶</a></dt>
<dd><p>create random noise
INPUT:</p>
<blockquote>
<div><p>N: signal length
A: maximal amplitude</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.ricker">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></code><code class="sig-name descname"><span class="pre">ricker</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#ricker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.ricker" title="Permalink to this definition">¶</a></dt>
<dd><p>create a zero-phase Ricker / Mexican hat wavelet
INPUT:</p>
<blockquote>
<div><p>sigma - standard deviation
dt - sampling Interval
N2 - number of samples/2 (halflength). Full length = 2*N2+1</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.sshift">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></code><code class="sig-name descname"><span class="pre">sshift</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#sshift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.sshift" title="Permalink to this definition">¶</a></dt>
<dd><p>shift a signal by a given time-shift in the frequency domain
INPUT:</p>
<blockquote>
<div><p>s: signal
N2: length of the signal in f-domain (usually equals the next pof 2)
dt: sampling interval
shift: the time shift in seconds</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.utils">
<span id="pyglimer-utils-utils"></span><h3>pyglimer.utils.utils<a class="headerlink" href="#module-pyglimer.utils.utils" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: November 2019</p>
<dl class="py function">
<dt id="pyglimer.utils.utils.chunks">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></code><code class="sig-name descname"><span class="pre">chunks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield successive n-sized chunks from lst. Useful for multi-threading</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.utils.dt_string">
<code class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></code><code class="sig-name descname"><span class="pre">dt_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#dt_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.dt_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Time elapsed string depending on how much time has passed.
After a certain amount of seconds it returns minutes, and after a certain
amount of minutes it returns the elapsed time in hours.</p>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-ccp">
<h2>pyglimer.ccp<a class="headerlink" href="#pyglimer-ccp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.ccp.ccp">
<span id="pyglimer-ccp-ccp"></span><h3>pyglimer.ccp.ccp<a class="headerlink" href="#module-pyglimer.ccp.ccp" title="Permalink to this headline">¶</a></h3>
<p>Module for the Common Conversion Stack Computation and handling of the
objects resulting from such.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 10th April 2020 05:30:18 pm
Last Modified: Thursday, 25th March 2021 03:34:58 pm</p>
<dl class="py class">
<dt id="pyglimer.ccp.ccp.CCPStack">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">CCPStack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Is a CCP Stack matrix. Its size depends upon stations that are used as
input.</p>
<p>Creates an empy object template for a CCP stack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of all seismic stations.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of all seismic stations.</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Inter bin distance in angular distance.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true -&gt; console output. The default is True.</p></li>
<li><p><strong>logdir</strong> – Directory for log file</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.compute_kdtree_volume">
<code class="sig-name descname"><span class="pre">compute_kdtree_volume</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">glon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">glat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minillum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.compute_kdtree_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.compute_kdtree_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the CCP kdtree, we get the closest few points and compute
the weighting using a distance metric. if points are too far away,
they aren’t weighted</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>glon</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – grid defining array for longitude</p></li>
<li><p><strong>glat</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – grid defining array for latitude</p></li>
<li><p><strong>gz</strong> (<em>np.array</em><em> or </em><em>list</em>) – grid defining array for z</p></li>
<li><p><strong>r</strong> (<em>float</em><em> or </em><em>None</em>) – outside r everything is nan</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.compute_stack">
<code class="sig-name descname"><span class="pre">compute_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vel_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'output/waveforms/RF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'output/stations'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'output/waveforms/preprocessed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocoords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.57735026918962573</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.compute_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp, using the data from rfloc.
The stack can be limited to some networks and
stations. This will take a long while for big data sets!
Note that the grid should be big enough for the provided networks and
stations. Best to create the CCPStack object by using ccp.init_ccp().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either <cite>iasp91.dat</cite>
for 1D raytracing or <cite>3D</cite> for 3D raytracing with GYPSuM model.
Using 3D Raytracing will cause the code to take about 30% longer.</p></li>
<li><p><strong>rfloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder in which the receiver functions in
time domain are. The default is ‘output/waveforms/RF.</p></li>
<li><p><strong>statloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Folder containing the response information. Only needed
if option geocoords is used. The default is ‘output/stations’.</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder containing the preprocessed mseeds.
Only needed if option geocoords is used. The default is
‘output/waveforms/preprocessed’.</p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Network or networks that are to be included in the ccp stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Station or stations that are to be included in the ccp stack.
Standard unix wildcards are allowed.
Can only be list if type(network)=str.
If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Include all stations in the rectangle given by
(minlat, maxlat, minlon, maxlon). Will be ignored if pattern or
network is given, by default None.</p></li>
<li><p><strong>pattern</strong> (<em>list</em><em>, </em><em>optional</em>) – Search pattern for .sac files. Overwrites network,
station, and geocooords options. Usually only used by
<a class="reference internal" href="#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a>, defaults to None.</p></li>
<li><p><strong>save</strong> (<em>str</em><em> or </em><em>bool</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with
filename will be saved in config.ccp. Will be saved as pickle file.</p></li>
<li><p><strong>filt</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Decides whether to filter the receiver function prior to
depth migration. Either a Tuple of form <cite>(lowpassf, highpassf)</cite> or
<cite>None</cite> / <cite>False</cite>.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – Defines the bin radius with
bin radius = binrad*distance_bins.
Full Overlap = 1/(2*cosd(30)), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – appends piercing point coordinates if True, so they
can later be plotted. Not recommended for big data sets.
The default is false. <strong>Deprecated for multi-core</strong></p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Append receiver functions for first order multiples.
It can be decided later, whether they should be used in the final
ccp stack. Will result in a longer computation time.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For wrong inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.conclude_ccp">
<code class="sig-name descname"><span class="pre">conclude_ccp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_empty</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_water</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.conclude_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.conclude_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Averages the CCP-bin and populates empty cells with average of
neighbouring cells. No matter which option is
chosen for the parameters, data is never lost entirely. One can always
execute a new conclude_ccp() command. However, decisions that are
taken here will affect the .mat output and plotting outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_empty</strong> (<em>bool</em><em>, </em><em>optional</em>) – Keep entirely empty bins. The default is False.</p></li>
<li><p><strong>keep_water</strong> (<em>bool</em><em>, </em><em>optional</em>) – For False all bins that are on water-covered areas
will be discarded, defaults to False</p></li>
<li><p><strong>r</strong> (<em>int</em><em>, </em><em>optional</em>) – Fields with less than r hits will be set equal 0.
r has to be &gt;= 1, defaults to 3.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> or </em><em>str</em>) – Use multiples in stack. Either False or weigthing;
i.e. ‘linear’ for linearly weighted stack between the three phases,
‘zk’ for a Zhu &amp; Kanamori approach, or ‘pws’ for a phase weighted
stack. Use ‘m1’ to use only first multiple mode (no stack),
‘m2’ for
RFs created only with 2nd multiple phase (PSS), and m for an
equal-weight stack of m1 and m2. By default False.</p></li>
<li><p><strong>z_multiple</strong> (<em>int</em><em>, </em><em>optional</em>) – Until which depth [km] should multiples be
considered,
maximal value is 200 [km]. Will only be used if multiple=True.
By default 200 km.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.create_vtk_mesh">
<code class="sig-name descname"><span class="pre">create_vtk_mesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.create_vtk_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.create_vtk_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a mesh with given bounding box s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo</strong> (<em>bool</em><em>, </em><em>optional</em>) – flag whether the output mesh is in geographical coordinates or
meters, by default True</p></li>
<li><p><strong>bbox</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – bounding box [minlon, maxlon, minlat, maxlat]. If None
No boundaries are taken, by default None</p></li>
<li><p><strong>filename</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set, the computed grid will be output as VTK file under the given
filename. This file can then later be opened using either the
plotting tool or, e.g., Paraview. If None, no file is written.
By default, None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs a vtk mesh that can be opened in, e.g., Paraview.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VTK.UnstructuredGrid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.explore">
<code class="sig-name descname"><span class="pre">explore</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minillum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.explore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.explore" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a volume exploration window set. One window is for all
plots, and the other window is generated with sliders such that one
can explore how future plots should be generated. It technically does
not require any inputs, as simply the binning size will be used to
create a meshgrid fitting to the bin distance distribution.
One can however set a factor by which to divide the bin distance for a
finer grid.</p>
<dl class="simple">
<dt>factor: float, optional</dt><dd><p>Bingrid epicentral distance multiplier to refine grid.
Defaults to 0.5.</p>
</dd>
<dt>maxz: float or None, optional</dt><dd><p>Maximum Depth if None, the max ccp bin depth is used.
Defaults to None.</p>
</dd>
<dt>minillum: int or None, optional</dt><dd><p>Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p>
</dd>
</dl>
<p>extent : list or tuple or Non, optional
:returns:
:rtype: VolumeExploration</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.map_plot">
<code class="sig-name descname"><span class="pre">map_plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_stations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_illum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_direct</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.map_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.map_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a map plot of the CCP Stack containing user-defined information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_stations</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot the station locations, by default False</p></li>
<li><p><strong>plot_bins</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot bin location, by default False</p></li>
<li><p><strong>plot_illum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot bin location with colour depending on the depth-cumulative
illumination at bin b, by default False</p></li>
<li><p><strong>profile</strong> (<em>list</em><em> or </em><em>tupleor None</em><em>, </em><em>optional</em>) – Plot locations of cross sections into the plot. Information about
each cross section is given as a tuple (lon1, lon2, lat1, lat2),
several cross sections are given as a list of tuples in said
format, by default None.</p></li>
<li><p><strong>p_direct</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true the list in profile decribes areas with coordinates of the
lower left and upper right corner, by default True</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Save plot to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format for the file to be saved as, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI for none vector format plots, by default 300</p></li>
<li><p><strong>geology</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot a geological map. Requires internet connection</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Set title for plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.multicore_stack">
<code class="sig-name descname"><span class="pre">multicore_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_closest_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.multicore_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.multicore_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in chunks of data to be processed on one core.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<em>list</em>) – List of file locations.</p></li>
<li><p><strong>append_pp</strong> (<em>Bool</em>) – Should piercing points be appended?.</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of Closest points that the KDTree
should query.</p></li>
<li><p><strong>vmodel</strong> (<em>str</em>) – Name of the velocity model that should be used for the
raytraycing.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em>) – Tuple in Form (minlon, maxlon). To save RAM on 3D
raytraycing. Will remain unused for 1D RT</p></li>
<li><p><strong>filt</strong> (<em>bool</em><em> or </em><em>tuple</em><em>]</em>) – Should the RFs be filtered before the ccp stack?
If so, provide (lowcof, highcof).</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – Index for progress bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Three lists containing indices and rf-data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.pick_phase">
<code class="sig-name descname"><span class="pre">pick_phase</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'+'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyglimer.ccp.ccp.PhasePick" title="pyglimer.ccp.ccp.PhasePick"><span class="pre">pyglimer.ccp.ccp.PhasePick</span></a><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.pick_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.pick_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick the strongest negative or strongest positive gradient from a
predefined depth-range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Either ‘+’ for positive velocity gradient or ‘-‘ for negative
gradient, by default ‘+’</p></li>
<li><p><strong>depth</strong> (<em>list</em><em>, </em><em>optional</em>) – List with two elements [minz, maxz], defines in which depth window
the phase picker is gonna look for maxima and minima,
by default [None, None]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A phasepick object, which subsequently can be plotted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.ccp.ccp.PhasePick" title="pyglimer.ccp.ccp.PhasePick">PhasePick</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For errandeous inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.plot_bins">
<code class="sig-name descname"><span class="pre">plot_bins</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple map view of the bins.</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.plot_volume_sections">
<code class="sig-name descname"><span class="pre">plot_volume_sections</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minillum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_volume_sections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_volume_sections" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the same plot as the <cite>explore</cite> tool, but(!) statically and
with more options left to the user.</p>
<p>!!! IT IS IMPORTANT for the plotting function that the input arrays
are monotonically increasing!!!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lons</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>lats</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>lonsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of lon is used,
by default None</p></li>
<li><p><strong>latsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of lat is used,
by default None</p></li>
<li><p><strong>zsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of depth is used,
by default None</p></li>
<li><p><strong>r</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Max radius for interpolation values taken into account [km],
if None bingrid.edist * DEG2KM * 2.0, by default None</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VolumePlot</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.query_bin_tree">
<code class="sig-name descname"><span class="pre">query_bin_tree</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_closest_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.query_bin_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Find closest bins for provided latitude and longitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of piercing points.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of piercing points.</p></li>
<li><p><strong>data</strong> (<em>1-D numpy.ndarray</em>) – Depth migrated receiver function data</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of closest points to be found.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bin index k and depth index j</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pickle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the CCPStream file as pickle or matlab file. Only save
as Matlab file for exporting, as not all information can be
preserved!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name as which to save, file extensions aren’t
necessary.</p></li>
<li><p><strong>folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Output folder, defaults to ‘output/ccps’</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – Either “pickle” or “matlab” for .mat, defaults to “pickle”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyglimer.ccp.ccp.PhasePick">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">PhasePick</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitudes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarity</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depthrange</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#PhasePick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.PhasePick" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A phasepick object, just created for more convenient plotting.</p>
<p>Initialise object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em>) – 2-d array containing latitudes and longitudes.</p></li>
<li><p><strong>amplitudes</strong> (<em>np.ndarray</em>) – 1-D array containg amplitude values of each bin</p></li>
<li><p><strong>polarity</strong> (<em>str</em>) – Either ‘+’ for positive velocity gradients or ‘-‘ for negative</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – 1D array containing depth of maxima/minima per bin</p></li>
<li><p><strong>depthrange</strong> (<em>list</em><em>, </em><em>optional</em>) – list containing depth restrictions in form of [zmin, zmax],
by default [None, None]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.ccp.PhasePick.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_amplitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'gist_rainbow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#PhasePick.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.PhasePick.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot heatmap containing depth or amplitude of picked phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_amplitude</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True amplitude instead of depths is plotted, by default False</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Write Figure to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – File format, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – Resolution for non-vector graphics, by default 300</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap</p></li>
<li><p><strong>geology</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot geological map.</p></li>
<li><p><strong>title</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.ccp.init_ccp">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">init_ccp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'output/stations'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'output/waveforms/preprocessed'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'output/waveforms/RF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocoords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_stack</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.86602540378443871</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><span class="pre">pyglimer.ccp.ccp.CCPStack</span></a><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#init_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.init_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp using data from statloc and rfloc.
The stack can be limited to some networks and
stations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spacing</strong> (<em>float</em>) – Angular distance between each bingrid point.</p></li>
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either iasp91 (1D
raytracing) or 3D for 3D raytracing using a model compiled from GyPSuM.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either ‘S’ or ‘P’. Use ‘S’ if dataset contains both SRFs and
PRFs.</p></li>
<li><p><strong>statloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory in that the station xmls are saved,
defaults to ‘output/stations’</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental directory in that the preprocessed miniseeds are
saved, defaults to ‘output/waveforms/preprocessed’</p></li>
<li><p><strong>rfloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental directory in that the RFs are saved,
defaults to ‘output/waveforms/RF’</p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Network or networks that are to be included in the ccp
stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Station or stations that are to be included in the ccp
stack. Standard unix wildcards are allowed. Can only be list if
type(network)=str. If None, the whole database will be used.
The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – An alternative way of selecting networks and stations.
Given in the form (minlat, maxlat, minlon, maxlon), defaults to None</p></li>
<li><p><strong>compute_stack</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true it will compute the stack by calling
<a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="pyglimer.ccp.ccp.CCPStack.compute_stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_stack()</span></code></a>.
That can take a long time! The default is False.</p></li>
<li><p><strong>filt</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Decides whether to filter the receiver function prior to
depth migration. Either a Tuple of form <cite>(lowpassf, highpassf)</cite> or
<cite>None</cite> / <cite>False</cite>.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – Only used if compute_stack=True
Defines the bin radius with bin radius = binrad*distance_bins.
Full Overlap = cosd(30), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – Only used if compute_stack=True.
Appends piercing point locations to object. Can be used to plot
pps on map. Not recommended for large datasets as it takes A LOT
longer and makes the file a lot larger.
The default is False., defaults to False</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the CCP Stack be prepared to work with multiples?
It can be chosen later, whether the RFs from multiples are to be
incorporated into the CCP Stack. By default False.</p></li>
<li><p><strong>save</strong> (<em>ool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with
filename will be saved. Will be saved as pickle file.
The default is False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display info in terminal., defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – For wrong inputs.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPstack</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.ccp.read_ccp">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">read_ccp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><span class="pre">pyglimer.ccp.ccp.CCPStack</span></a><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#read_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.read_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CCP-Stack class file from input folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of the input file with file ending.
The default is ‘ccp.pkl’.</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – File format, can be none if the filename has an ending,
possible options are “pickle. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPStack</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.io">
<span id="pyglimer-ccp-io"></span><h3>pyglimer.ccp.io<a class="headerlink" href="#module-pyglimer.ccp.io" title="Permalink to this headline">¶</a></h3>
<p>This module will handle file IO. The problematic functions here are the
incoming <cite>.mat</cite> files that are produced by the GLImER database.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<dl class="py function">
<dt id="pyglimer.ccp.io.load_rawrf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></code><code class="sig-name descname"><span class="pre">load_rawrf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/io.html#load_rawrf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_rawrf" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>(</strong><strong>str</strong><strong>)</strong> (<em>filename</em>) – <p>The <cite>.mat</cite>-file is expected to contain following parameters:</p>
<blockquote>
<div><p>crfs: MxN matrix of M Receiver Functions and N elements
cbaz: M elements long vector with back azimuth values</p>
<blockquote>
<div><p>corresponding to Receiver functions</p>
</div></blockquote>
<dl class="simple">
<dt>crayp: M elements long vector with ray parameter values</dt><dd><p>corresponding to Receiver functions</p>
</dd>
<dt>cslat: M elements long vector with station latitude</dt><dd><p>corresponding to Receiver functions</p>
</dd>
<dt>cslon: M elements long vector with station longitude</dt><dd><p>corresponding to Receiver functions</p>
</dd>
</dl>
<p>celev: M elements long vector with station elevation
dt: sampling interval</p>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rfs, baz, rayp, lat, lon, elev, dt</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.io.load_tracefile">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></code><code class="sig-name descname"><span class="pre">load_tracefile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/io.html#load_tracefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_tracefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loading an RF file that has been raytraced.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.io.load_velocity_model">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></code><code class="sig-name descname"><span class="pre">load_velocity_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/io.html#load_velocity_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_velocity_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads velocity model and outputs velocities and corresponding
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vlat, vlon, vdep, vp, vs</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.compute.bin">
<span id="pyglimer-ccp-compute-bin"></span><h3>pyglimer.ccp.compute.bin<a class="headerlink" href="#module-pyglimer.ccp.compute.bin" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)
Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Created: November 2019
Last Modified: Thursday, 25th March 2021 03:31:51 pm</p>
<dl class="py class">
<dt id="pyglimer.ccp.compute.bin.BinGrid">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.compute.bin.</span></code><code class="sig-name descname"><span class="pre">BinGrid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates Bingrid object from parameters</p>
<p>BinGrid object that can be used to find closest neighbours to
stations and CCP bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.array</cite>) – Latitudes</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.array</cite>) – Longitudes</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Distance (in degree) between bin centres.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – consoel output?, defaults to True</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.compute_bins">
<code class="sig-name descname"><span class="pre">compute_bins</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.compute_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.compute_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bins close to all stations</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.query_bin_tree">
<code class="sig-name descname"><span class="pre">query_bin_tree</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_bin_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>binrad</strong> (<em>float</em>) – maximum  distance to be queried in euclidean distance
Equals the radius of the bin, higher = more averaging -&gt;
–&gt; less noise, lower resolution</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of neighbours to return. Note that this directly
depends on the ratio of deltabin/binrad.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.query_station_tree">
<code class="sig-name descname"><span class="pre">query_station_tree</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_station_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>maxdist</strong> (<em>float</em>) – maximum  distance to be queried in degree</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Euclidian distances to next point, indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple with 2 1D <cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.station_tree">
<code class="sig-name descname"><span class="pre">station_tree</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.station_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the input</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-plot">
<h2>pyglimer.plot<a class="headerlink" href="#pyglimer-plot" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.plot.plot_map">
<span id="pyglimer-plot-plot-map"></span><h3>pyglimer.plot.plot_map<a class="headerlink" href="#module-pyglimer.plot.plot_map" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 4th August 2020 11:02:52 am
Last Modified: Thursday, 25th March 2021 03:40:07 pm</p>
<dl class="py function">
<dt id="pyglimer.plot.plot_map.plot_bins">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></code><code class="sig-name descname"><span class="pre">plot_bins</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binlon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots bins into a map</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_map.plot_map">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></code><code class="sig-name descname"><span class="pre">plot_map</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_map" title="Permalink to this definition">¶</a></dt>
<dd><p>plot a map</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_map.plot_stations">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></code><code class="sig-name descname"><span class="pre">plot_stations</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_stations" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots stations into a map</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_map.plot_vel_grad">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></code><code class="sig-name descname"><span class="pre">plot_vel_grad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_amplitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'gist_rainbow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_vel_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_vel_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot velocity gradient. Use method implemented into object!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em>) – lats and lons</p></li>
<li><p><strong>a</strong> (<em>np.ndarray</em>) – picked amplitudes</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – picked depths</p></li>
<li><p><strong>plot_amplitude</strong> (<em>bool</em>) – Plot Amplitude or depth?</p></li>
<li><p><strong>lat</strong> (<em>tuple</em><em> or </em><em>None</em>) – Latitude boarder for map</p></li>
<li><p><strong>lon</strong> (<em>tuple o rNone</em>) – Longitude boarder for map</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em>, </em><em>optional</em>) – write plot to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – file format, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – resolution for none-vector plots, by default 300</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.plot.plot_utils">
<span id="pyglimer-plot-plot-utils"></span><h3>pyglimer.plot.plot_utils<a class="headerlink" href="#module-pyglimer.plot.plot_utils" title="Permalink to this headline">¶</a></h3>
<p>Plot utilities not to modify plots or base plots.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)
Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Last Update: June 19, 2020</p>
<dl class="py function">
<dt id="pyglimer.plot.plot_utils.baz_hist">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">baz_hist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#baz_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.baz_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in backazimuth distribution and number of bins to compute
the distribution of incoming angles.</p>
<dl>
<dt>az<span class="classifier"><cite>numpy.ndarray</cite></span></dt><dd><p>azimuthal distribution in 1D array</p>
</dd>
<dt>nbins<span class="classifier">int</span></dt><dd><p>Number of bins</p>
</dd>
</dl>
<p>None</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_utils.plot_catalog">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">plot_catalog</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#plot_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.plot_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in event catalog and plots events as a function of location and
moment magnitude.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_utils.plot_section">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">plot_section</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timelimits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epilimits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalingfactor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#plot_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.plot_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a receiver function section as a function
of epicentral distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rfst</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pyglimer.RFStream</span></code>) – Stream of receiver functions</p></li>
<li><p><strong>timelimits</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – y axis time limits in seconds (len(list)==2).
If <cite>None</cite> full traces is plotted.
Default None.</p></li>
<li><p><strong>epilimits</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None = None</em><em>,</em>) – y axis time limits in seconds (len(list)==2).
If <cite>None</cite> from 30 to 90 degrees plotted.
Default None.</p></li>
<li><p><strong>scalingfactor</strong> (<em>float</em>) – sets the scale for the traces. Could be automated in
future functions(Something like mean distance between
traces)
Defaults to 2.0</p></li>
<li><p><strong>line</strong> (<em>bool</em>) – plots black line of the actual RF
Defaults to True</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – sets linewidth of individual traces</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – <dl class="simple">
<dt>If True, clears out all axes and plots RF only.</dt><dd><p>Defaults to False.</p>
</dd>
</dl>
<p>Returns</p>
</p></li>
<li><p><strong>-------</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_utils.plot_single_rf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">plot_single_rf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#plot_single_rf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.plot_single_rf" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a single receiver function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pyglimer.RFTrace</span></code>) – single receiver function trace</p></li>
<li><p><strong>tlim</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – x axis time limits in seconds if type==’time’ or depth in km if
type==depth (len(list)==2).
If <cite>None</cite> full trace is plotted.
Default None.</p></li>
<li><p><strong>depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 1D array of depths</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – <dl class="simple">
<dt>If True, clears out all axes and plots RF only.</dt><dd><p>Defaults to False.</p>
</dd>
</dl>
<p>Returns</p>
</p></li>
<li><p><strong>-------</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_utils.rayp_hist">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">rayp_hist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#rayp_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.rayp_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in rayparameter distribution and number of bins to compute
the distribution of incoming angles.</p>
<dl class="simple">
<dt>rayp: <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></dt><dd><p>1D ndarray of rayparameters</p>
</dd>
<dt>nbins: int</dt><dd><p>Number of bins</p>
</dd>
<dt>v: float</dt><dd><p>assummed surface velocity for the computation of the
incidence angle. Default 5.8 km/s.</p>
</dd>
<dt>phase: string</dt><dd><p>indicates which incidence wave is meant ‘S’ or ‘P’. Default is ‘P’
simple defines boundaries of the plot nothing more nothing less.</p>
</dd>
</dl>
<p>None</p>
<p>Get Incidence angle p = sin i/v &lt;–&gt; v sin i / p &lt;–&gt; i = asin(vp)
Default value 5.8 km/s taken from PREM.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_utils.remove_all">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">remove_all</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#remove_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.remove_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all frames and ticks.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_utils.remove_topright">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">remove_topright</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#remove_topright"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.remove_topright" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes top and right border and ticks from input axes.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.plot.plot_utils.stream_dist">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></code><code class="sig-name descname"><span class="pre">stream_dist</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#stream_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.stream_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses backazimuth and rayparameter histogram plotting tools to create
combined overview over the Distribution of incident waves.</p>
<p>Parameters:
rayp: <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
<blockquote>
<div><p>1D ndarray of rayparameters</p>
</div></blockquote>
<dl class="simple">
<dt>az: <cite>numpy.ndarray</cite></dt><dd><p>azimuthal distribution in 1D array</p>
</dd>
<dt>nbins: int</dt><dd><p>Number of bins</p>
</dd>
<dt>v: float</dt><dd><p>assummed surface velocity for the computation of the
incidence angle. Default 5.8 km/s.</p>
</dd>
<dt>phase: string</dt><dd><p>indicates which incidence wave is meant ‘S’ or ‘P’. Default is ‘P’
simple defines boundaries of the rayparemeter plot nothing
more nothing less.</p>
</dd>
<dt>outputfile:  str or None</dt><dd><p>Path to savefile. If None plot is not saved just shown.
Defaults to None.</p>
</dd>
<dt>format: str</dt><dd><p>outputfile format</p>
</dd>
<dt>dpi: int</dt><dd><p>only used if file format is none vector.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.plot.plot_volume">
<span id="pyglimer-plot-plot-volume"></span><h3>pyglimer.plot.plot_volume<a class="headerlink" href="#module-pyglimer.plot.plot_volume" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: June 19, 2020</p>
</div>
<div class="section" id="module-pyglimer.plot.ui_utils">
<span id="pyglimer-plot-ui-utils"></span><h3>pyglimer.plot.ui_utils<a class="headerlink" href="#module-pyglimer.plot.ui_utils" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: June 19, 2020</p>
<dl class="py function">
<dt id="pyglimer.plot.ui_utils.set_sliderval_no_callback">
<code class="sig-prename descclassname"><span class="pre">pyglimer.plot.ui_utils.</span></code><code class="sig-name descname"><span class="pre">set_sliderval_no_callback</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slider</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">matplotlib.widgets.Slider</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/ui_utils.html#set_sliderval_no_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.ui_utils.set_sliderval_no_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Set slider value to <em>val</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>float</em>) – </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="ccp.html" class="btn btn-neutral float-left" title="Common Conversion Point Stacking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, the PyGLImER development team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>