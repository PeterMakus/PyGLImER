

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PyGLImER API &mdash; PyGLImER 0.01 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Common Conversion Point Stacking" href="ccp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> PyGLImER
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Waveform Download, preprocessing, and receiver function creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="receiver_function.html">Handling Receiver Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ccp.html">Common Conversion Point Stacking</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">PyGLImER</span></code> API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-waveform">pyglimer.waveform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.request">pyglimer.waveform.request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-0">pyglimer.waveform.download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.preprocess">pyglimer.waveform.preprocess</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.qc">pyglimer.waveform.qc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.rotate">pyglimer.waveform.rotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.waveform.errorhandler">pyglimer.waveform.errorhandler</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-rf">pyglimer.rf</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.rf.create">pyglimer.rf.create</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.rf.deconvolve">pyglimer.rf.deconvolve</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.rf.moveout">pyglimer.rf.moveout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-database">pyglimer.database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.database.stations">pyglimer.database.stations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-test">pyglimer.test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.test.rate">pyglimer.test.rate</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.test.synthetic">pyglimer.test.synthetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.test.tests">pyglimer.test.tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-utils">pyglimer.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.changedb">pyglimer.utils.changedb</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.create_geom">pyglimer.utils.create_geom</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.createvmodel">pyglimer.utils.createvmodel</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.geo_utils">pyglimer.utils.geo_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.nextpowof2">pyglimer.utils.nextpowof2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.roundhalf">pyglimer.utils.roundhalf</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.signalproc">pyglimer.utils.signalproc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.utils.utils">pyglimer.utils.utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pyglimer-ccp">pyglimer.ccp</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.ccp.ccp">pyglimer.ccp.ccp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-pyglimer.ccp.compute.bin">pyglimer.ccp.compute.bin</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PyGLImER</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">PyGLImER</span></code> API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/chapters/API.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pyglimer-api">
<span id="api-label"></span><h1><code class="docutils literal notranslate"><span class="pre">PyGLImER</span></code> API<a class="headerlink" href="#pyglimer-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pyglimer-waveform">
<h2>pyglimer.waveform<a class="headerlink" href="#pyglimer-waveform" title="Permalink to this headline">¶</a></h2>
<p>Waveform download and preprocess</p>
<div class="section" id="module-pyglimer.waveform.request">
<span id="pyglimer-waveform-request"></span><h3>pyglimer.waveform.request<a class="headerlink" href="#module-pyglimer.waveform.request" title="Permalink to this headline">¶</a></h3>
<p>Contains the request class that is used to initialise the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<p>Created on Mon Apr 27 10:55:10 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py class">
<dt id="pyglimer.waveform.request.Request">
<em class="property">class </em><code class="sig-prename descclassname">pyglimer.waveform.request.</code><code class="sig-name descname">Request</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">rot</span></em>, <em class="sig-param"><span class="n">evtloc</span></em>, <em class="sig-param"><span class="n">statloc</span></em>, <em class="sig-param"><span class="n">rawloc</span></em>, <em class="sig-param"><span class="n">preproloc</span></em>, <em class="sig-param"><span class="n">rfloc</span></em>, <em class="sig-param"><span class="n">deconmeth</span></em>, <em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">endtime</span></em>, <em class="sig-param"><span class="n">wavdownload</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">pol</span><span class="o">=</span><span class="default_value">'v'</span></em>, <em class="sig-param"><span class="n">minmag</span><span class="o">=</span><span class="default_value">5.5</span></em>, <em class="sig-param"><span class="n">event_coords</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">network</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waveform_client</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">re_client</span><span class="o">=</span><span class="default_value">['IRIS']</span></em>, <em class="sig-param"><span class="n">evtcat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.request.Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>“Initialises the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<p>Create object that is used to start the receiver function
workflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>str</em>) – Primary arrival that is to be used as source phase.
“S” to create S-Sp receiver functions and “P” for P-Ps receiver
functions.</p></li>
<li><p><strong>rot</strong> (<em>str</em>) – The coordinate system in that the seismogram should be rotated
prior to deconvolution. Options are “RTZ” for radial, transverse,
vertical; “LQT” for an orthogonal coordinate system computed using
singular value decomposition, “LQT_min” for an orthogonal
coordinate system computed by minimising primary energy on the
converted component, or “PSS” for a rotation along the polarisation
directions using the Litho1.0 surface wave tomography model.</p></li>
<li><p><strong>evtloc</strong> (<em>str</em>) – Directory, in which to store the event catalogue (xml).</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Directory, in which to store the station inventories (xml).</p></li>
<li><p><strong>rawloc</strong> (<em>str</em>) – Directory, in which to store the raw waveform data (mseed).</p></li>
<li><p><strong>preproloc</strong> (<em>str</em>) – Directory, in which to store
the preprocessed waveform data (mseed).</p></li>
<li><p><strong>rfloc</strong> (<em>str</em>) – Directory, in which to store the receiver functions in
time domain (sac).</p></li>
<li><p><strong>deconmeth</strong> (<em>str</em>) – The deconvolution method to use for the RF creation.
Possible options are:
‘it’: iterative time domain deconvolution (Ligorria &amp; Ammon, 1999)
‘dampedf’: damped frequency deconvolution
‘fqd’: frequency dependent damping - not a good choice for SRF
‘waterlevel’: Langston (1977)
‘multit’: for multitaper (Helffrich, 2006)
False/None: don’t create RFs</p></li>
<li><p><strong>starttime</strong> (<em>UTCDateTime</em>) – Earliest event date to be considered.</p></li>
<li><p><strong>endtime</strong> (<em>UTCDateTime</em>) – Latest event date to be considered.</p></li>
<li><p><strong>wavdownload</strong> (<em>bool</em><em>, </em><em>optional</em>) – Do you want to start a new download (True),
update the current database (True) or only preprocess and create
RFs from an existing database (False). False is a lot faster as all
CPUs can be used and the preprocessing does not have to wait for
the download, defaults to True.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarisation to use as source wavelet. Either “v” for
vertically polarised or ‘h’ for horizontally polarised S-waves.
Will be ignored if phase=’S’, by default ‘v’.</p></li>
<li><p><strong>minmag</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum magnitude, by default 5.5</p></li>
<li><p><strong>event_coords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – In case you wish to constrain events to certain
origns. Given in the form (minlat, maxlat, minlon, maxlon),
by default None.</p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Limit the dowloand and preprocessing to a certain
network or several networks (if type==list).
Wildcards are allowed, by default None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Limit the download and preprocessing to a certain
station or several stations. Use only if network!=None.
Wildcards are allowed, by default None.</p></li>
<li><p><strong>waveform_client</strong> (<em>list</em><em>, </em><em>optional</em>) – List of FDSN compatible servers to download
waveforms from.
See obspy documentation for obspy.Client for allowed acronyms.
A list of servers by region can be found at
<a class="reference external" href="https://www.fdsn.org/webservices/datacenters/">https://www.fdsn.org/webservices/datacenters/</a>. None means
that all known servers are requested, defaults to None.</p></li>
<li><p><strong>re_client</strong> (<em>list</em><em>, </em><em>optional</em>) – Only relevant, when debug=True. List of servers that
will be used if data is missing and the script will attempt a
redownload, usually it’s easier to just run a request several
times. Same logic as for waveform_client applies,
defaults to [‘IRIS’]</p></li>
<li><p><strong>evtcat</strong> (<em>str</em><em>, </em><em>optional</em>) – In case you want to use an already existing event
catalogue
in evtloc. If None a new catalogue will be downloaded (with the
parameters defined before), by default None, defaults to None</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, all loggers will go to DEBUG mode and all
warnings
will be shown. That will result in a lot of information being
shown! Also joblib will fall back to using only few cores,
by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NameError</strong> – For invalid phases.</p>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.waveform.request.Request.download_waveforms">
<code class="sig-name descname">download_waveforms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.download_waveforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.download_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the download of waveforms and response files.</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.waveform.request.Request.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess an existing database.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-0">
<span id="pyglimer-waveform-download"></span><h3>pyglimer.waveform.download<a class="headerlink" href="#module-0" title="Permalink to this headline">¶</a></h3>
<p>Contains the request class that is used to initialise the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<p>Created on Mon Apr 27 10:55:10 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py class">
<dt id="id0">
<em class="property">class </em><code class="sig-prename descclassname">pyglimer.waveform.request.</code><code class="sig-name descname">Request</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">rot</span></em>, <em class="sig-param"><span class="n">evtloc</span></em>, <em class="sig-param"><span class="n">statloc</span></em>, <em class="sig-param"><span class="n">rawloc</span></em>, <em class="sig-param"><span class="n">preproloc</span></em>, <em class="sig-param"><span class="n">rfloc</span></em>, <em class="sig-param"><span class="n">deconmeth</span></em>, <em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">endtime</span></em>, <em class="sig-param"><span class="n">wavdownload</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">pol</span><span class="o">=</span><span class="default_value">'v'</span></em>, <em class="sig-param"><span class="n">minmag</span><span class="o">=</span><span class="default_value">5.5</span></em>, <em class="sig-param"><span class="n">event_coords</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">network</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">waveform_client</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">re_client</span><span class="o">=</span><span class="default_value">['IRIS']</span></em>, <em class="sig-param"><span class="n">evtcat</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>“Initialises the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<p>Create object that is used to start the receiver function
workflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>str</em>) – Primary arrival that is to be used as source phase.
“S” to create S-Sp receiver functions and “P” for P-Ps receiver
functions.</p></li>
<li><p><strong>rot</strong> (<em>str</em>) – The coordinate system in that the seismogram should be rotated
prior to deconvolution. Options are “RTZ” for radial, transverse,
vertical; “LQT” for an orthogonal coordinate system computed using
singular value decomposition, “LQT_min” for an orthogonal
coordinate system computed by minimising primary energy on the
converted component, or “PSS” for a rotation along the polarisation
directions using the Litho1.0 surface wave tomography model.</p></li>
<li><p><strong>evtloc</strong> (<em>str</em>) – Directory, in which to store the event catalogue (xml).</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Directory, in which to store the station inventories (xml).</p></li>
<li><p><strong>rawloc</strong> (<em>str</em>) – Directory, in which to store the raw waveform data (mseed).</p></li>
<li><p><strong>preproloc</strong> (<em>str</em>) – Directory, in which to store
the preprocessed waveform data (mseed).</p></li>
<li><p><strong>rfloc</strong> (<em>str</em>) – Directory, in which to store the receiver functions in
time domain (sac).</p></li>
<li><p><strong>deconmeth</strong> (<em>str</em>) – The deconvolution method to use for the RF creation.
Possible options are:
‘it’: iterative time domain deconvolution (Ligorria &amp; Ammon, 1999)
‘dampedf’: damped frequency deconvolution
‘fqd’: frequency dependent damping - not a good choice for SRF
‘waterlevel’: Langston (1977)
‘multit’: for multitaper (Helffrich, 2006)
False/None: don’t create RFs</p></li>
<li><p><strong>starttime</strong> (<em>UTCDateTime</em>) – Earliest event date to be considered.</p></li>
<li><p><strong>endtime</strong> (<em>UTCDateTime</em>) – Latest event date to be considered.</p></li>
<li><p><strong>wavdownload</strong> (<em>bool</em><em>, </em><em>optional</em>) – Do you want to start a new download (True),
update the current database (True) or only preprocess and create
RFs from an existing database (False). False is a lot faster as all
CPUs can be used and the preprocessing does not have to wait for
the download, defaults to True.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarisation to use as source wavelet. Either “v” for
vertically polarised or ‘h’ for horizontally polarised S-waves.
Will be ignored if phase=’S’, by default ‘v’.</p></li>
<li><p><strong>minmag</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum magnitude, by default 5.5</p></li>
<li><p><strong>event_coords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – In case you wish to constrain events to certain
origns. Given in the form (minlat, maxlat, minlon, maxlon),
by default None.</p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Limit the dowloand and preprocessing to a certain
network or several networks (if type==list).
Wildcards are allowed, by default None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Limit the download and preprocessing to a certain
station or several stations. Use only if network!=None.
Wildcards are allowed, by default None.</p></li>
<li><p><strong>waveform_client</strong> (<em>list</em><em>, </em><em>optional</em>) – <p>List of FDSN compatible servers to download
waveforms from.
See obspy documentation for obspy.Client for allowed acronyms.
A list of servers by region can be found at
<a class="reference external" href="https://www.fdsn.org/webservices/datacenters/">https://www.fdsn.org/webservices/datacenters/</a>. None means
that all known servers are requested, defaults to None.</p>
</p></li>
<li><p><strong>re_client</strong> (<em>list</em><em>, </em><em>optional</em>) – Only relevant, when debug=True. List of servers that
will be used if data is missing and the script will attempt a
redownload, usually it’s easier to just run a request several
times. Same logic as for waveform_client applies,
defaults to [‘IRIS’]</p></li>
<li><p><strong>evtcat</strong> (<em>str</em><em>, </em><em>optional</em>) – In case you want to use an already existing event
catalogue
in evtloc. If None a new catalogue will be downloaded (with the
parameters defined before), by default None, defaults to None</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, all loggers will go to DEBUG mode and all
warnings
will be shown. That will result in a lot of information being
shown! Also joblib will fall back to using only few cores,
by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NameError</strong> – For invalid phases.</p>
</dd>
</dl>
<dl class="py method">
<dt id="id2">
<code class="sig-name descname">download_waveforms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.download_waveforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the download of waveforms and response files.</p>
</dd></dl>

<dl class="py method">
<dt id="id3">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess an existing database.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.preprocess">
<span id="pyglimer-waveform-preprocess"></span><h3>pyglimer.waveform.preprocess<a class="headerlink" href="#module-pyglimer.waveform.preprocess" title="Permalink to this headline">¶</a></h3>
<p>Author: Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
<p>Created: Tuesday, 19th May 2019 8:59:40 pm
Last Modified: Friday, 3rd July 2020 04:21:35 pm</p>
<dl class="py exception">
<dt id="pyglimer.waveform.preprocess.SNRError">
<em class="property">exception </em><code class="sig-prename descclassname">pyglimer.waveform.preprocess.</code><code class="sig-name descname">SNRError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#SNRError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.SNRError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when the SNR is too high</p>
</dd></dl>

<dl class="py exception">
<dt id="pyglimer.waveform.preprocess.StreamLengthError">
<em class="property">exception </em><code class="sig-prename descclassname">pyglimer.waveform.preprocess.</code><code class="sig-name descname">StreamLengthError</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#StreamLengthError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.StreamLengthError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when stream has fewer than 3 components</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.preprocess.preprocess">
<code class="sig-prename descclassname">pyglimer.waveform.preprocess.</code><code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">rot</span></em>, <em class="sig-param"><span class="n">pol</span></em>, <em class="sig-param"><span class="n">taper_perc</span></em>, <em class="sig-param"><span class="n">event_cat</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">taper_type</span></em>, <em class="sig-param"><span class="n">tz</span></em>, <em class="sig-param"><span class="n">ta</span></em>, <em class="sig-param"><span class="n">statloc</span></em>, <em class="sig-param"><span class="n">rawloc</span></em>, <em class="sig-param"><span class="n">preproloc</span></em>, <em class="sig-param"><span class="n">rfloc</span></em>, <em class="sig-param"><span class="n">deconmeth</span></em>, <em class="sig-param"><span class="n">wavdownload</span></em>, <em class="sig-param"><span class="n">netrestr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">statrestr</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Preprocesses waveforms to create receiver functions</p>
<blockquote>
<div><p>1. Clips waveform to the right length
(tz before and ta after theorethical arrival.)
2. Demean &amp; Detrend
3. Tapering
4. Remove Instrument response, convert to velocity &amp;
simulate havard station.
5. Rotation to NEZ and, subsequently, to RTZ.
6. Compute SNR for highpass filtered waveforms
(highpass f defined in qc.lowco).
If SNR lower than in qc.SNR_criteria for all filters,
rejects waveform.
7. Write finished and filtered waveforms to folder
specified in qc.outputloc.
8. Write info file with shelf containing station,
event and waveform information.</p>
<p>Only starts after all waveforms of the event have been
downloaded by download.py.
(checked over the dynamic variables prepro_folder and tmp.folder)</p>
<p>Saves preprocessed waveform files.
Creates info file to save parameters.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>string</em>) – “P” or “S”</p></li>
<li><p><strong>rot</strong> (<em>string</em>) – Coordinate system to cast seismogram in before deconvolution.
Options are “RTZ”, “LQT”, “LQT_min”, or “PSS”.</p></li>
<li><p><strong>pol</strong> (<em>string</em>) – “h” for Sh or “v” for Sv, only for PRFs.</p></li>
<li><p><strong>taper_perc</strong> (<em>FLOAT</em>) – Percentage to be tapered in beginning and at the end of waveforms.</p></li>
<li><p><strong>taper_type</strong> (<em>STRING</em>) – Taper type (see obspy documentation stream.taper).</p></li>
<li><p><strong>event_cat</strong> (<em>event catalogue</em>) – catalogue containing all events of waveforms.</p></li>
<li><p><strong>model</strong> (<em>obspy.taup.TauPyModel</em>) – 1D velocity model to calculate arrival.</p></li>
<li><p><strong>tz</strong> (<em>int</em>) – time window before first arrival in seconds</p></li>
<li><p><strong>ta</strong> (<em>int</em>) – time window after first arrival in seconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.preprocess.write_info">
<code class="sig-prename descclassname">pyglimer.waveform.preprocess.</code><code class="sig-name descname">write_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">station</span></em>, <em class="sig-param"><span class="n">dictionary</span></em>, <em class="sig-param"><span class="n">preproloc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#write_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.write_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes information dictionary in shelve format in each of the station
folders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>str</em>) – Network Code.</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Station code.</p></li>
<li><p><strong>dictionary</strong> (<em>dict</em>) – Dictionary containing the information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.qc">
<span id="pyglimer-waveform-qc"></span><h3>pyglimer.waveform.qc<a class="headerlink" href="#module-pyglimer.waveform.qc" title="Permalink to this headline">¶</a></h3>
<p>Contains quality control for waveforms used for receiver function creation.</p>
<p>Created on Fri Apr 10 11:38:21 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py function">
<dt id="pyglimer.waveform.qc.qcp">
<code class="sig-prename descclassname">pyglimer.waveform.qc.</code><code class="sig-name descname">qcp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">sampling_f</span></em>, <em class="sig-param"><span class="n">onset</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/qc.html#qcp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.qc.qcp" title="Permalink to this definition">¶</a></dt>
<dd><p>Quality control for the downloaded waveforms that are used to create
PRFS. Works with various filters and SNR criteria</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>'~obspy.Stream'</em>) – Input stream.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>sampling_f</strong> (<em>FLOAT</em>) – Sampling frequency (Hz).</p></li>
<li><p><strong>onset</strong> (<em>float</em>) – Onset in seconds after trace’s start.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>st</strong> (<em>‘~obspy.Stream’</em>) – Output stream. If stream was accepted, then this will contain the
filtered stream, filtered with the broadest accepted filter.</p></li>
<li><p><strong>crit</strong> (<em>BOOL</em>) – True if stream was accepted, false if it wasn’t.</p></li>
<li><p><strong>f</strong> (<em>FLOAT</em>) – Last used low-cut frequency. If crit=True, this will be the frequency
for which the stream was accepted.</p></li>
<li><p><strong>noisemat</strong> (<em>np.array</em>) – SNR values in form of a matrix. Rows represent the different filters
and columns the different criteria.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.qc.qcs">
<code class="sig-prename descclassname">pyglimer.waveform.qc.</code><code class="sig-name descname">qcs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">sampling_f</span></em>, <em class="sig-param"><span class="n">onset</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/qc.html#qcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.qc.qcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Quality control for waveforms that are used to produce SRF. In contrast
to the ones used for PRF this is a very rigid criterion and will reject
&gt;95% of the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>'~obspy.Stream'</em>) – Input stream.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>sampling_f</strong> (<em>FLOAT</em>) – Sampling frequency (Hz).</p></li>
<li><p><strong>onset</strong> (<em>float</em>) – Onset in seconds after trace’s start.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>st</strong> (<em>‘~obspy.Stream’</em>) – Output stream. If stream was accepted, then this will contain the
filtered stream, filtered with the broadest accepted filter.</p></li>
<li><p><strong>crit</strong> (<em>BOOL</em>) – True if stream was accepted, false if it wasn’t.</p></li>
<li><p><strong>f</strong> (<em>FLOAT</em>) – Last used high-cut frequency. If crit=True, this will be the frequency
for which the stream was accepted.</p></li>
<li><p><strong>noisemat</strong> (<em>np.array</em>) – SNR values in form of a matrix. Rows represent the different filters
and columns the different criteria.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.rotate">
<span id="pyglimer-waveform-rotate"></span><h3>pyglimer.waveform.rotate<a class="headerlink" href="#module-pyglimer.waveform.rotate" title="Permalink to this headline">¶</a></h3>
<p>Created on Sat Mar 21 19:26:57 2020</p>
<p>&#64;author: pm
Contains functions to rotate a stream into different domains</p>
<dl class="py function">
<dt id="pyglimer.waveform.rotate.rotate_LQT">
<code class="sig-prename descclassname">pyglimer.waveform.rotate.</code><code class="sig-name descname">rotate_LQT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">phase</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_LQT"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_LQT" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a stream given in RTZ to LQT using Singular Value Decomposition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input Stream in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “S” for Sp or “P” for Ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>LQT</strong> (<em>obspy.Stream</em>) – Output Stream in LQT.</p></li>
<li><p><strong>QC</strong> (<em>FLOAT</em>) – Quality control criterion. Energy balance at first arrival for L and Q.
Should deviate from 1 as far as possible.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.rotate.rotate_LQT_min">
<code class="sig-prename descclassname">pyglimer.waveform.rotate.</code><code class="sig-name descname">rotate_LQT_min</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">phase</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_LQT_min"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_LQT_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates stream to LQT by minimising the energy of the S-wave primary
arrival on the L component (SRF) or maximising the primary arrival
energy on L (PRF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input stream in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>LQT</strong> (<em>obspy.Stream</em>) – Output stream in LQT.</p></li>
<li><p><strong>ia</strong> (<em>float</em>) – Computed incidence angle in degree. Can serve as QC criterion.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.rotate.rotate_PSV">
<code class="sig-prename descclassname">pyglimer.waveform.rotate.</code><code class="sig-name descname">rotate_PSV</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">statlat</span></em>, <em class="sig-param"><span class="n">statlon</span></em>, <em class="sig-param"><span class="n">rayp</span></em>, <em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">phase</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_PSV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_PSV" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the incidence angle of an incoming ray with the weighted average
of the lithosphere’s P velocity with a velocity model compiled from
Litho1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statlat</strong> (<em>FLOAT</em>) – station latitude.</p></li>
<li><p><strong>statlon</strong> (<em>FLOAT</em>) – station longitude.</p></li>
<li><p><strong>rayp</strong> (<em>FLOAT</em>) – ray parameter / slownesss in s/m.</p></li>
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input stream given in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Primary phase, either P or S.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>avp</strong> (<em>FLOAT</em>) – Average P-wave velocity.</p></li>
<li><p><strong>avs</strong> (<em>FLOAT</em>) – Average S-wave velocity.</p></li>
<li><p><strong>PSvSh</strong> (<em>obspy.Stream</em>) – Stream in P-Sv-Sh.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.errorhandler">
<span id="pyglimer-waveform-errorhandler"></span><h3>pyglimer.waveform.errorhandler<a class="headerlink" href="#module-pyglimer.waveform.errorhandler" title="Permalink to this headline">¶</a></h3>
<p>Files contains all Errorhandler for the Glimer to obspy project</p>
<p>Author: Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
<p>Created: Saturday, 21th March 2020 19:16:41
Last Modified: Wednesday, 17th June 2020 02:33:01 pm</p>
<dl class="py function">
<dt id="pyglimer.waveform.errorhandler.NoMatchingResponseHandler">
<code class="sig-prename descclassname">pyglimer.waveform.errorhandler.</code><code class="sig-name descname">NoMatchingResponseHandler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">station</span></em>, <em class="sig-param"><span class="n">statloc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#NoMatchingResponseHandler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.NoMatchingResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Error handler for when the No matching response found error occurs.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.errorhandler.redownload">
<code class="sig-prename descclassname">pyglimer.waveform.errorhandler.</code><code class="sig-name descname">redownload</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">station</span></em>, <em class="sig-param"><span class="n">starttime</span></em>, <em class="sig-param"><span class="n">endtime</span></em>, <em class="sig-param"><span class="n">st</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#redownload"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.redownload" title="Permalink to this definition">¶</a></dt>
<dd><p>Errorhandler that Redownloads the stream for the given input.
Used when the stream has less than three channels.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.waveform.errorhandler.redownload_statxml">
<code class="sig-prename descclassname">pyglimer.waveform.errorhandler.</code><code class="sig-name descname">redownload_statxml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">station</span></em>, <em class="sig-param"><span class="n">statfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#redownload_statxml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.redownload_statxml" title="Permalink to this definition">¶</a></dt>
<dd><p>Errorhandler: Redownload station xml in case that it is not found.</p>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-rf">
<h2>pyglimer.rf<a class="headerlink" href="#pyglimer-rf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.rf.create">
<span id="pyglimer-rf-create"></span><h3>pyglimer.rf.create<a class="headerlink" href="#module-pyglimer.rf.create" title="Permalink to this headline">¶</a></h3>
<p>A toolset to create RFs and RF classes</p>
<p>Created on Wed Feb 19 13:41:10 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Some parts of this code are modified versions of the rf module by
Tom Eulenfeld.</p>
<p>Last updated:</p>
<dl class="py class">
<dt id="pyglimer.rf.create.RFStream">
<em class="property">class </em><code class="sig-prename descclassname">pyglimer.rf.create.</code><code class="sig-name descname">RFStream</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">traces</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.stream.Stream</span></code></p>
<p>Class providing the necessary functions for receiver function calculation.
:param traces: list of traces, single trace or stream object
To initialize a RFStream from a Stream object use
&gt;&gt;&gt; rfstream = RFStream(stream)
To initialize a RFStream from a file use
&gt;&gt;&gt; rfstream = read_rf(‘test.SAC’)
Format specific headers are loaded into the stats object of all traces.</p>
<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.method">
<em class="property">property </em><code class="sig-name descname">method</code><a class="headerlink" href="#pyglimer.rf.create.RFStream.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Property for used rf method, ‘P’ or ‘S’</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.moveout">
<code class="sig-name descname">moveout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vmodel</span></em>, <em class="sig-param"><span class="n">latb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lonb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">taper</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.moveout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration of all receiver functions given Stream.
Also calculates piercing points and adds them to RFTrace.stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel</strong> (<em>str</em>) – Velocity model located in /data/vmodel.
Standard options are iasp91.dat and 3D (GYPSuM).</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
<li><p><strong>taper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the last 10km of the RF will be tapered, which
avoids jumps in station stacks. Should be False for CCP stacks,
defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1D np.ndarray containing depths and an
object of type depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.ndarray, <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot receiver functions depending on epicentral distance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scale</strong> (<em>int</em><em>, </em><em>optional</em>) – Y-scaling, defaults to 2</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure and axis object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.ppoint">
<code class="sig-name descname">ppoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vmodel_file</span><span class="o">=</span><span class="default_value">'iasp91.dat'</span></em>, <em class="sig-param"><span class="n">latb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lonb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.ppoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates piercing points for all receiver functions in given
RFStream and adds them to self.stats in form of lat, lon and depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – velocity model located in /data/vmodel.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.slice2">
<code class="sig-name descname">slice2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">starttime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">endtime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reftime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">keep_empty_traces</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.slice2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.slice2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative slice method accepting relative times.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">slice()</span></code> and <cite>trim2()</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.station_stack">
<code class="sig-name descname">station_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vmodel_file</span><span class="o">=</span><span class="default_value">'iasp91.dat'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.station_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.station_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a moveout correction and stacks all receiver functions
in Stream. Make sure that Stream only contains RF from one station!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – 1D velocity model in data/vmodels.
The default is ‘iasp91.dat’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>z : Depth Vector.
stack : Object containing station stack.
RF_mo : Object containing depth migrated traces.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>z : 1D np.ndarray
stack : <a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a>
RF_mo : <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.trim2">
<code class="sig-name descname">trim2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">starttime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">endtime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reftime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.trim2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.trim2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative trim method accepting relative times.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">trim()</span></code>.
:param starttime,endtime: accept UTCDateTime or seconds relative to</p>
<blockquote>
<div><p>reftime</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>reftime</strong> – reference time, can be an UTCDateTime object or a
string. The string will be looked up in the stats dictionary
(e.g. ‘starttime’, ‘endtime’, ‘onset’).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.type">
<em class="property">property </em><code class="sig-name descname">type</code><a class="headerlink" href="#pyglimer.rf.create.RFStream.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Property for the type of stream, ‘rf’, ‘profile’ or None</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFStream.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">format</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Save stream to file including format specific headers.
See <cite>Stream.write() &lt;obspy.core.stream.Stream.write&gt;</cite> in ObsPy.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyglimer.rf.create.RFTrace">
<em class="property">class </em><code class="sig-prename descclassname">pyglimer.rf.create.</code><code class="sig-name descname">RFTrace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">header</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">trace</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.trace.Trace</span></code></p>
<p>Class providing the Trace object for receiver function calculation.</p>
<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.moveout">
<code class="sig-name descname">moveout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vmodel</span></em>, <em class="sig-param"><span class="n">latb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lonb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">taper</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.moveout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration of the receiver function.
Also calculates piercing points and adds them to RFTrace.stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel</strong> (<em>str</em>) – Velocity model located in /data/vmodel.
Standard options are iasp91.dat and 3D (GYPSuM).</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
<li><p><strong>taper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the last 10km of the RF will be tapered, which
avoids jumps in station stacks. Should be False for CCP stacks,
defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1D np.ndarray containing depths and an
RFTrace object of type depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.ndarray, <a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">grid</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the Receiver function against either depth or time, depending on
information given in self.stats.type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>grid</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show a grid. The default is False.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure parameter if one wishes to edit figure and ax
If one wishes to edit axes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.figure.Figure
matplotlib.axes._subplots.AxesSubplot</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.ppoint">
<code class="sig-name descname">ppoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vmodel</span></em>, <em class="sig-param"><span class="n">latb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lonb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.ppoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates piercing points for receiver function in and adds them
to self.stats in form of lat, lon and depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – velocity model located in /data/vmodel.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.rf.create.RFTrace.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">format</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Save current trace into a file  including format specific headers.
See <cite>Trace.write() &lt;obspy.core.trace.Trace.write&gt;</cite> in ObsPy.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.createRF">
<code class="sig-prename descclassname">pyglimer.rf.create.</code><code class="sig-name descname">createRF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">st_in</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">pol</span><span class="o">=</span><span class="default_value">'v'</span></em>, <em class="sig-param"><span class="n">onset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'it'</span></em>, <em class="sig-param"><span class="n">trim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">event</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#createRF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.createRF" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a receiver function with the defined method from an obspy
stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st_in</strong> (<em>Stream</em>) – Stream of which components are to be deconvolved.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S”.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarisation to be deconvolved from. Only for phase = P,
defaults to ‘v’</p></li>
<li><p><strong>onset</strong> (<em>UTCDateTime</em><em>, </em><em>optional</em>) – Is used to shift function rather than shift if provided.
If info is provided, it will be extracted from info file,
defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Deconvolution method, “waterlevel”, ‘dampedf’ for constant
damping level, ‘it’ for iterative time domain deconvoltuion, ‘multit’
for multitaper or ‘fqd’ for frequency dependently damped spectral
division. The default is iterative time domain (‘it’).</p></li>
<li><p><strong>trim</strong> (<em>tuple</em><em>, </em><em>optional</em>) – taper/truncate. Given as tuple (a, b) in s - left,right.
The default is None.</p></li>
<li><p><strong>event</strong> (<em>event</em><em>, </em><em>optional</em>) – Event File used to extract additional information about
arrival. Provide either event and station or info dict. The default is
None.</p></li>
<li><p><strong>station</strong> (<em>'~obspy.core.station'</em><em>, </em><em>optional</em>) – Dictionary containing station information,
defaults to None</p></li>
<li><p><strong>info</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing information about the waveform, used to
extract additional information for header. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – If deconvolution method is unknown.</p></li>
<li><p><strong>Exception</strong> – For wrong trim input.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>RFTrace object containing receiver function.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.obj2stats">
<code class="sig-prename descclassname">pyglimer.rf.create.</code><code class="sig-name descname">obj2stats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">event</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#obj2stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.obj2stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Map event and station object to stats with attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code>, optional) – Event File. The default is None.</p></li>
<li><p><strong>station</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Station</span></code>, optional) – Station file with attributes lat, lon, and elevation.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stats object with station and event attributes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AttribDict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.read_rf">
<code class="sig-prename descclassname">pyglimer.rf.create.</code><code class="sig-name descname">read_rf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pathname_or_url</span></em>, <em class="sig-param"><span class="n">format</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#read_rf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.read_rf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read waveform files into RFStream object.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code> in ObsPy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pathname_or_url</strong> (<em>str</em>) – Path to file.</p></li>
<li><p><strong>format</strong> (<em>e.g. &quot;MSEED&quot;</em><em> or </em><em>&quot;SAC&quot;. Will attempt to determine from ending
if = None. The default is None.</em>) – str, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RFStream object from file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.create.rfstats">
<code class="sig-prename descclassname">pyglimer.rf.create.</code><code class="sig-name descname">rfstats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">info</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">starttime</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">event</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tt_model</span><span class="o">=</span><span class="default_value">'IASP91'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#rfstats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.create.rfstats" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a stats object for a RFTrace object. Provide an info dic and
starttime or event and station object. Latter will take longer since
computations are redone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S” for main phase.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Dictionary containing information about waveform. Can be None
if event and station are provided. Has to be given in combination with
starttime, defaults to None.</p></li>
<li><p><strong>starttime</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>, optional) – Starttime of first trace in stream, used as identifier in
info dict. The default is None.</p></li>
<li><p><strong>event</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code>, optional) – Event file, provide together with station file if info=None.
The default is None.</p></li>
<li><p><strong>station</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Station</span></code>, optional) – Station inventory with attributes lat, lon, and elevation,
defaults to None</p></li>
<li><p><strong>tt_model</strong> (<em>str</em><em>, </em><em>optional</em>) – TauPy model to calculate arrival, only used if no info
file is given. The default is “IASP91”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For unavailable phases</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Stats file for a RFTrace object with event and station
attributes, distance, back_azimuth, onset and
ray parameter.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AttribDict</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.rf.deconvolve">
<span id="pyglimer-rf-deconvolve"></span><h3>pyglimer.rf.deconvolve<a class="headerlink" href="#module-pyglimer.rf.deconvolve" title="Permalink to this headline">¶</a></h3>
<p>Created on Wed Oct 16 14:23:30 2019</p>
<p>Various Deconvolution approaches used for the RF technique.
&#64;author: pm</p>
<dl class="py function">
<dt id="pyglimer.rf.deconvolve.damped">
<code class="sig-prename descclassname">pyglimer.rf.deconvolve.</code><code class="sig-name descname">damped</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">H</span></em>, <em class="sig-param"><span class="n">mu</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#damped"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.damped" title="Permalink to this definition">¶</a></dt>
<dd><p>Outdated use function spectraldivision instead!
A simple damped deconvolution. I just used it to benchmark
INPUT:</p>
<blockquote>
<div><p>P: denominator (t-domain)
H: enumerator (t-domain)
mu: damping factor</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.gen_it">
<code class="sig-prename descclassname">pyglimer.rf.deconvolve.</code><code class="sig-name descname">gen_it</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">H</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">mu</span></em>, <em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">2.5</span></em>, <em class="sig-param"><span class="n">e_min</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">omega_min</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">it_max</span><span class="o">=</span><span class="default_value">400</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#gen_it"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.gen_it" title="Permalink to this definition">¶</a></dt>
<dd><p>Has a bug in the normalisation!
This function provides a generalised iterative deconvolution as given
by Wang &amp; Pavlis (2016)
Essentially, P will be deconvolved from H.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>np.ndarray</em>) – The source wavelet estimation (denominator).</p></li>
<li><p><strong>H</strong> (<em>np.ndarray</em>) – Impulse response convolved with source wavelet (enumerator).</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s]</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – Damping factor for least-square damping.</p></li>
<li><p><strong>shift</strong> (<em>float</em><em>, </em><em>optional</em>) – Time shift of theoretical arrival [s]. The default is 0.</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – Width parameter for Gaussian. The default is 2.5.</p></li>
<li><p><strong>e_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Is the energy ratio of residual and original data
after the nth iteration; given in per cent. The default is 5.</p></li>
<li><p><strong>omega_min</strong> (<em>float</em><em>, </em><em>optional</em>) – secondary control parameter (percentage improvement per
iteration), given in per cent - used as criterion to test significance.
The default is 0.5.</p></li>
<li><p><strong>it_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations. defaults to 400</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rf : The receiver function.
IR : The estimation of the medium’s impulse response.
it : Number of iterations
rej : Number of peaks that did not meet the criterion of significance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rf : 1D np.ndarray
IR : 1D np.ndarray
it : int
rej : int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.it">
<code class="sig-prename descclassname">pyglimer.rf.deconvolve.</code><code class="sig-name descname">it</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">H</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">shift</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">2.5</span></em>, <em class="sig-param"><span class="n">omega_min</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">it_max</span><span class="o">=</span><span class="default_value">200</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#it"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.it" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterative deconvolution after Ligorria &amp; Ammon (1999)
Essentially, P will be deconvolved from H.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>1D np.ndarray</em>) – The source wavelet estimation / denominator.</p></li>
<li><p><strong>H</strong> (<em>1D np.ndarray</em>) – The enumerator (impulse response * source wavelet estimation).</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>shift</strong> (<em>float</em><em>, </em><em>optional</em>) – Time shift of main arrival [s]. The default is 0.</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width parameter. The default is 2.5.</p></li>
<li><p><strong>omega_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence control parameter (percentage improvement
per iteration). The default is 0.5.</p></li>
<li><p><strong>it_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximal number of iterations before the algorithm
interrupts, defaults to 400</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rf : The receiver function.
it : Number of iterations until algorithm converged.
IR : Estimation of the medium’s impulse response.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rf : np.ndarray
it : int
IR : np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.multitaper">
<code class="sig-prename descclassname">pyglimer.rf.deconvolve.</code><code class="sig-name descname">multitaper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">D</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">tshift</span></em>, <em class="sig-param"><span class="n">regul</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#multitaper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.multitaper" title="Permalink to this definition">¶</a></dt>
<dd><p>Output has to be filtered (Noise appears in high-frequency)!
multitaper: takes Ved-Kathrins code and changes inputs to
make it run like Helffrich algorithm, minus normalization and with
questionable calculation of pre-event noise (have to double check this
and compare it to the regular FFT based estimate without any tapers).</p>
<p>Findings: when P arrival is not in the center of the window, the
amplitudes are not unity at the beginning and decreasing from there on.
Instead they peak at the time shift which corresponds to the middle index
in the P time window.</p>
<p>TB  = time bandwidth product (usually between 2 and 4)
NT  = number of tapers to use, has to be &lt;= 2*TB-1
TB = 4; NT = 7; #choice of TB = 4, NT = 3 is supposed to be optimal
t0 = -5; t1 = max(time); # This defines the beginning and end of the lag
times for the receiver function</p>
<p>changed by KS June 2016, added coherence and variance estimate; output
RF in time domain (rf), RF in freq. domain (tmpp), and variance of RF
(var_rf); can be used as input for multitaper_weighting.m
the input “regul” defines which type of regularization is used,
regul=’fqd’ defines frequency dependent regularisation from pre-event
noise, regul=’con’ defines adding a constant value (here maximum of
pre-event noise) as regularisation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>np.array</em>) – Source time function estimation.</p></li>
<li><p><strong>D</strong> (<em>np.array</em>) – Component containing the converted wave.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, either ‘fqd’ for frequency dependentor ‘con’ for
constant.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For unknown input.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>rf</strong> (<em>np.array</em>) – The receiver function.</p></li>
<li><p><strong>lrf</strong> (<em>np.array</em>) – The source-time wavelet convolved by itself.</p></li>
<li><p><strong>var_rf</strong> (<em>np.array</em>) – The receiver function’s variance.</p></li>
<li><p><strong>tmpp</strong> (<em>np.array</em>) – Receiver function without variance weighting.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.spectraldivision">
<code class="sig-prename descclassname">pyglimer.rf.deconvolve.</code><code class="sig-name descname">spectraldivision</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">ndt</span></em>, <em class="sig-param"><span class="n">tshift</span></em>, <em class="sig-param"><span class="n">regul</span></em>, <em class="sig-param"><span class="n">phase</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#spectraldivision"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.spectraldivision" title="Permalink to this definition">¶</a></dt>
<dd><p>Function spectraldivision(v,u,ndt,tshift,regul) is a standard spectral
division frequency domain deconvolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>1D np.ndarray</em>) – Source wavelet estimation (denominator).</p></li>
<li><p><strong>u</strong> (<em>1D np.ndarray</em>) – Impulse response convolved by v (enumerator).</p></li>
<li><p><strong>ndt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, can be chosen by the variable “regul”, this
can be ‘con’, ‘wat’, or ‘fqd’ for constant damping factor, waterlevel,
or frequency-dependent damping, respectively</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Phase either “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – for uknown regulisations</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>qrf : Receiver function.
lrf : Output of deoncolution of source wavelet estimation from
longitudinal component.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>1D np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.rf.moveout">
<span id="pyglimer-rf-moveout"></span><h3>pyglimer.rf.moveout<a class="headerlink" href="#module-pyglimer.rf.moveout" title="Permalink to this headline">¶</a></h3>
<p>Created on Tue Apr  7 10:08:42 2020</p>
<p>Contains functions for moveout correction and station stacking</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py class">
<dt id="pyglimer.rf.moveout.SimpleModel">
<em class="property">class </em><code class="sig-prename descclassname">pyglimer.rf.moveout.</code><code class="sig-name descname">SimpleModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">vp</span></em>, <em class="sig-param"><span class="n">vs</span></em>, <em class="sig-param"><span class="n">n</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#SimpleModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.moveout.SimpleModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple 1D velocity model for move out and piercing point calculation.
Calculated with Earth flattening algorithm as described by P. M. Shearer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> – depths in km</p></li>
<li><p><strong>vp</strong> – P wave velocities at provided depths in km/s</p></li>
<li><p><strong>vs</strong> – S wave velocities at provided depths in km/s</p></li>
<li><p><strong>n</strong> – number of support points between provided depths</p></li>
</ul>
</dd>
</dl>
<p>All arguments can be of type numpy.ndarray or list.
taken from the RF module based on obspy by Tom Eulenfeld</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.dt_table">
<code class="sig-prename descclassname">pyglimer.rf.moveout.</code><code class="sig-name descname">dt_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rayp</span></em>, <em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">el</span></em>, <em class="sig-param"><span class="n">debug</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#dt_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.moveout.dt_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a phase delay table and calculates piercing points
for a specific ray parameter,
using the equation as in Rondenay 2009.
For SRF: The length of the output vectors is determined by the depth, at
which Sp conversion is supercritical (vertical slowness = complex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>float</em>) – ray-parameter given in s/deg.</p></li>
<li><p><strong>fname</strong> (<em>string</em>) – 1D velocity model, located in data/vmodels.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” for Sp or “P” for Ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>htab</strong> (<em>np.array</em>) – Vector containing conversion depths.</p></li>
<li><p><strong>dt</strong> (<em>np.array</em>) – Vector containing delay times between primary arrival and converted
wave.</p></li>
<li><p><strong>delta</strong> (<em>np.array</em>) – Vector containing angular distance of piercing point from the
station at depth z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.dt_table_3D">
<code class="sig-prename descclassname">pyglimer.rf.moveout.</code><code class="sig-name descname">dt_table_3D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rayp</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">lat</span></em>, <em class="sig-param"><span class="n">lon</span></em>, <em class="sig-param"><span class="n">baz</span></em>, <em class="sig-param"><span class="n">el</span></em>, <em class="sig-param"><span class="n">latb</span></em>, <em class="sig-param"><span class="n">lonb</span></em>, <em class="sig-param"><span class="n">test</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#dt_table_3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.moveout.dt_table_3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a phase delay table and calculates piercing points
for a specific ray parameter,
using the equation as in Rondenay 2009.
For SRF: The length of the output vectors is determined by the depth, at
which Sp conversion is supercritical (vertical slowness = complex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>float</em>) – ray-parameter given in s/deg.</p></li>
<li><p><strong>fname</strong> (<em>string</em>) – 1D velocity model, located in data/vmodels.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” for Sp or “P” for Ps.</p></li>
<li><p><strong>el</strong> (<em>float</em>) – station elevation in m.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D raytraycing.
Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em>) – Tuple in Form (minlon, maxlon)</p></li>
<li><p><strong>test</strong> (<em>Bool</em>) – If True, the raysum 3D model is loaded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>htab</strong> (<em>np.array</em>) – Vector containing conversion depths.</p></li>
<li><p><strong>dt</strong> (<em>np.array</em>) – Vector containing delay times between primary arrival and converted
wave.</p></li>
<li><p><strong>delta</strong> (<em>np.array</em>) – Vector containing Euclidian distance of piercing point from the
station at depth z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.earth_flattening">
<code class="sig-prename descclassname">pyglimer.rf.moveout.</code><code class="sig-name descname">earth_flattening</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxz</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">dz</span></em>, <em class="sig-param"><span class="n">vp</span></em>, <em class="sig-param"><span class="n">vs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#earth_flattening"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.moveout.earth_flattening" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a flat-earth approximated velocity model down to maxz as in
Peter M. Shearer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxz</strong> (<em>int</em>) – Maximal intepolation depth [km]. Given at beginning of file.</p></li>
<li><p><strong>z</strong> (<em>np.array</em>) – Depth vector [km].</p></li>
<li><p><strong>dz</strong> (<em>np.array</em>) – Layer thicknesses in km.</p></li>
<li><p><strong>vp</strong> (<em>np.array</em>) – P wave velocities [km/s].</p></li>
<li><p><strong>vs</strong> (<em>np.array</em>) – S wave velocities [km/s].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em>) – Same as input, but shortened to maxz.</p></li>
<li><p><strong>dz</strong> (<em>np.array</em>) – Same as input, but shortened to maxz.</p></li>
<li><p><strong>zf</strong> (<em>np.array</em>) – Depths in a Cartesian coordinate system.</p></li>
<li><p><strong>dzf</strong> (<em>np.array</em>) – Layer thicknesse in a Cartesian coordinate system.</p></li>
<li><p><strong>vpf</strong> (<em>np.array</em>) – P wave velocities in a Cartesian coordinate system.</p></li>
<li><p><strong>vsf</strong> (<em>np.array</em>) – S wave velocities in a Cartesian coordinate system.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.load_model">
<code class="sig-prename descclassname">pyglimer.rf.moveout.</code><code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fname</span><span class="o">=</span><span class="default_value">'iasp91.dat'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.moveout.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 1D velocity model from file.
The model file should have 4 columns with depth, vp, vs, n.
The model file for iasp91 starts like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#IASP91 velocity model</span>
<span class="c1">#depth  vp    vs   n</span>
  <span class="mf">0.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">0</span>
  <span class="mf">0.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">0</span>
<span class="mf">10.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>string</em><em>, </em><em>optional</em>) – filename of model in data or ‘iasp91’.
The default is ‘iasp91.dat’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns SimpleModel instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.rf.moveout.SimpleModel" title="pyglimer.rf.moveout.SimpleModel">SimpleModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.moveout">
<code class="sig-prename descclassname">pyglimer.rf.moveout.</code><code class="sig-name descname">moveout</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">st</span></em>, <em class="sig-param"><span class="n">fname</span></em>, <em class="sig-param"><span class="n">latb</span></em>, <em class="sig-param"><span class="n">lonb</span></em>, <em class="sig-param"><span class="n">taper</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#moveout"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.moveout.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration for RF.
Corrects the for the moveout of a converted phase. Flips time axis
and polarity of SRF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>1D np.ndarray</em>) – Receiver Function.</p></li>
<li><p><strong>st</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeDict</span></code>) – Stats from stream object.</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – 1D velocity model for moveout correction.
Use ‘3D’ for a 3D raytracing.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D raytraycing.
Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em>) – Tuple in Form (minlon, maxlon)</p></li>
<li><p><strong>taper</strong> (<em>bool</em>) – If True, the last 10km of the RF will be tapered, which avoids
jumps in station stacks. If False,
the upper 5 km will be tapered.
Should be False for CCP stacks.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>z2 : Depth vector in km.
RF2 : Vector containing the depth migrated RF.
delta : Vector containing Euclidian distance of piercing point from the</p>
<blockquote>
<div><p>station at depth z.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>3 times 1D np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.moveout.ppoint">
<code class="sig-prename descclassname">pyglimer.rf.moveout.</code><code class="sig-name descname">ppoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_a</span></em>, <em class="sig-param"><span class="n">q_b</span></em>, <em class="sig-param"><span class="n">dz</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">phase</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#ppoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.rf.moveout.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spherical distance between piercing point and station.
INPUT has to be in Cartesian/ flat Earth:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_a</strong> (<em>float</em>) – Vertical P-wave slowness in s/km.</p></li>
<li><p><strong>q_b</strong> (<em>float</em>) – Vertical S-wave slowness in s/km.</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – Vertical distance between two consecutive piercing points [km].</p></li>
<li><p><strong>p</strong> (<em>float</em>) – slowness in s/km.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” or “P”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x_delta</strong> – Euclidean distance between station and piercing point.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-database">
<h2>pyglimer.database<a class="headerlink" href="#pyglimer-database" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.database.stations">
<span id="pyglimer-database-stations"></span><h3>pyglimer.database.stations<a class="headerlink" href="#module-pyglimer.database.stations" title="Permalink to this headline">¶</a></h3>
<p>Database management and overview for the GLImER database.</p>
<p>Created on Mon May 11 11:09:05 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py function">
<dt id="pyglimer.database.stations.redownload_missing_statxmls">
<code class="sig-prename descclassname">pyglimer.database.stations.</code><code class="sig-name descname">redownload_missing_statxmls</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">clients</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">statloc</span></em>, <em class="sig-param"><span class="n">rawdir</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/stations.html#redownload_missing_statxmls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.database.stations.redownload_missing_statxmls" title="Permalink to this definition">¶</a></dt>
<dd><p>Fairly primitive program that walks through existing raw waveforms in
rawdir and looks for missing station xmls in statloc and, afterwards,
attemps a redownload</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clients</strong> (<em>list</em>) – List of clients (see obspy documentation for
<cite>~obspy.Client</cite>).</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S”, defines in which folder to look for mseeds.</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Folder, in which the station xmls are saved</p></li>
<li><p><strong>rawdir</strong> (<em>str</em>) – Uppermost directory, in which the raw mseeds are saved
(i.e. the directory above the phase division).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show some extra information, by default True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-test">
<h2>pyglimer.test<a class="headerlink" href="#pyglimer-test" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.test.rate">
<span id="pyglimer-test-rate"></span><h3>pyglimer.test.rate<a class="headerlink" href="#module-pyglimer.test.rate" title="Permalink to this headline">¶</a></h3>
<p>Created on Tue Feb 25 19:28:38 2020
Contains various functions used to evaluate the quality of RF and waveforms
&#64;author: pm</p>
<dl class="py function">
<dt id="pyglimer.test.rate.automatic_rate">
<code class="sig-prename descclassname">pyglimer.test.rate.</code><code class="sig-name descname">automatic_rate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">station</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">preproloc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#automatic_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.rate.automatic_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the automatic QC criteria for SRF waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (2 letters).</p></li>
<li><p><strong>station</strong> (<em>STRING</em>) – Station code (3 letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” or “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>diff</strong> (<em>INTEGER</em>) – Number of waveforms that were not rated 3 or 4.</p></li>
<li><p><strong>ret</strong> (<em>INTEGER</em>) – Number of automatically retained waveforms.</p></li>
<li><p><strong>sts</strong> (<em>LIST</em>) – List containing all retained + filtered streams.</p></li>
<li><p><strong>crits</strong> (<em>LIST</em>) – List containing bools (retained or not) corresponding to streams in
sts.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.rate.rate">
<code class="sig-prename descclassname">pyglimer.test.rate.</code><code class="sig-name descname">rate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">preproloc</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">review</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">retained</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">decon_meth</span><span class="o">=</span><span class="default_value">'it'</span></em>, <em class="sig-param"><span class="n">test_tt_calculation</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.rate.rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Module to rate and review the quality of Sp or Ps waveforms from the given
station. Shows the automatic rating from qc. Tapers can be controlled with
the mouse. Rating is done with the keyboard. Makes only sense if the
files in preproloc have not been quality controlled (the script is a
reminant from an earlier alpha version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (two letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em>) – Either “P” for Ps or “S” Sp. The default is “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Station code (three letters).</p></li>
<li><p><strong>review</strong> (<em>INTEGER</em><em>, </em><em>optional</em>) – If true, already rated waveforms are shown.
Can also be an integer between 1 and 4. Then, only waveforms rated
with the respected rating are shown. The default is False.</p></li>
<li><p><strong>retained</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Show only waveforms retained by qcp or qcs. The default is False.</p></li>
<li><p><strong>decon_meth</strong> (<em>STRING</em><em>, </em><em>optional</em>) – Deconvolution method, “waterlevel”, ‘dampedf’ for constant
damping level, ‘it’ for iterative time domain deconvoltuion, ‘multit’
for multitaper or ‘fqd’ for frequency dependently damped spectral
division. The default is ‘it’</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For Typing mistakes.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.rate.sort_rated">
<code class="sig-prename descclassname">pyglimer.test.rate.</code><code class="sig-name descname">sort_rated</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">station</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">preproloc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#sort_rated"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.rate.sort_rated" title="Permalink to this definition">¶</a></dt>
<dd><p>Functions that sorts waveforms in 4 folders,
depending on their manual rating.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (2 letters).</p></li>
<li><p><strong>station</strong> (<em>STRING</em>) – Station code (3 letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” or “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.test.synthetic">
<span id="pyglimer-test-synthetic"></span><h3>pyglimer.test.synthetic<a class="headerlink" href="#module-pyglimer.test.synthetic" title="Permalink to this headline">¶</a></h3>
<p>Created on Wed Oct 23 09:37:49 2019
Create synthetic impulse resonses.
Used to test the deconvolve module.
&#64;author: pm</p>
<dl class="py function">
<dt id="pyglimer.test.synthetic.create_R">
<code class="sig-prename descclassname">pyglimer.test.synthetic.</code><code class="sig-name descname">create_R</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N2</span></em>, <em class="sig-param"><span class="n">M</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/synthetic.html#create_R"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.synthetic.create_R" title="Permalink to this definition">¶</a></dt>
<dd><p>Program to create random reflectivity series
INPUT
N2: half-length of the signal (N=2*N2+1)
M: number of seismic discontinuities</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.synthetic.synthetic">
<code class="sig-prename descclassname">pyglimer.test.synthetic.</code><code class="sig-name descname">synthetic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N2</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">SNR</span></em>, <em class="sig-param"><span class="n">stdv</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/synthetic.html#synthetic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.synthetic.synthetic" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create synthetic seismograms (given Impulse response convolved with a Ricker wavelet)
INPUT:</p>
<blockquote>
<div><p>N2: half-length of the Input traces, (full length N= N2*2+1)
dt: sampling rate
R: Impulse response / reflectivity series with length N
SNR: ratio of maximal amplitude of the source wavelet to max noise amplitude
stdv : standard deviation of the source pulse (controls width)</p>
</div></blockquote>
<dl>
<dt>Output:</dt><dd><dl class="simple">
<dt>v_noise: the theorethical source wavelet with noise independent from the noise on the horizontal compoennt</dt><dd><p>(equal to the hoizontal component of a seismogram in RF)</p>
</dd>
</dl>
<p>h_noise: The horizontal component of the seismogram with noise</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.test.tests">
<span id="pyglimer-test-tests"></span><h3>pyglimer.test.tests<a class="headerlink" href="#module-pyglimer.test.tests" title="Permalink to this headline">¶</a></h3>
<p>Created on Wed Apr  1 13:51:46 2020
Assorted functions that serve as a tests (mostly with synthetic data) of other
GLImER functions.
&#64;author: pm</p>
<dl class="py function">
<dt id="pyglimer.test.tests.decon_test">
<code class="sig-prename descclassname">pyglimer.test.tests.</code><code class="sig-name descname">decon_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">PSS_file</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">method</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#decon_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.tests.decon_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to test a given deconvolution method with synthetic data created
with raysum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PSS_file</strong> (<em>str</em>) – Filename of raysum file containing P-Sv-Sh traces.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – “S” or “P”.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Deconvolution method: use 1. “fqd”, “wat”, or “con for
frequency-dependent damped, waterlevel damped, constantly damped
spectraldivision. 2. “it” for iterative deconvolution, and 3.
“multit_con” or “multitap_fqd” for constantly or frequency-dependent
damped multitaper deconvolution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>RF</strong> (<em>np.array</em>) – Matrix containing all receiver functions.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.tests.moveout_test">
<code class="sig-prename descclassname">pyglimer.test.tests.</code><code class="sig-name descname">moveout_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">PSS_file</span></em>, <em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">phase</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#moveout_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.tests.moveout_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates synthetic PRFs and stacks them after depth migration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PSS_file</strong> (<em>str</em>) – Filename of raysum file containing P-Sv-Sh traces.</p></li>
<li><p><strong>q</strong> (<em>float</em>) – Slowness [s/m].</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em>) – Depth vector.</p></li>
<li><p><strong>stack</strong> (<em>np.array</em>) – Receiver function stack.</p></li>
<li><p><strong>RF_mo</strong> (<em>np.array</em>) – Matrix containing all depth migrated RFs.</p></li>
<li><p><strong>RF</strong> (<em>np.array</em>) – Matrix containing all RFs.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval.</p></li>
<li><p><strong>PSS</strong> (<em>np.array</em>) – Matrix containing all traces in P-Sv-Sh.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.tests.read_geom">
<code class="sig-prename descclassname">pyglimer.test.tests.</code><code class="sig-name descname">read_geom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">geom_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#read_geom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.tests.read_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in the geometry file of the raysum program to determine parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>geom_file</strong> (<em>str</em>) – Filename of the geometry file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>baz</strong> (<em>np.ndarray(1D)</em>) – Array containing the backazimuths of each trace [deg].</p></li>
<li><p><strong>q</strong> (<em>np.ndarray(1D)</em>) – Array containing the slownesses of each trace [s/m].</p></li>
<li><p><strong>dN</strong> (<em>np.ndarray(1D)</em>) – Array containing the north shift of each trace [m].</p></li>
<li><p><strong>dE</strong> (<em>np.ndarray(1D)</em>) – Array containing the east shift of each trace [m].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.tests.read_raysum">
<code class="sig-prename descclassname">pyglimer.test.tests.</code><code class="sig-name descname">read_raysum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">NEZ_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">RTZ_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">PSS_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#read_raysum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.tests.read_raysum" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the output of the raysum program (by Andrew Frederiksen).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>NEZ_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of file in NEZ coordinate system. The default is None.</p></li>
<li><p><strong>RTZ_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of file in RTZ coordinate system. The default is None.</p></li>
<li><p><strong>PSS_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of file in P-Sv-Sh coordinate system. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For wron inputs.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>stream</strong> (<em>np.array</em>) – One numpy array for each provided input file.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – The sampling interval [s].</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of traces per file.</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of samples per trace</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.tests.read_rfs_mat">
<code class="sig-prename descclassname">pyglimer.test.tests.</code><code class="sig-name descname">read_rfs_mat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'output/ccps'</span></em>, <em class="sig-param"><span class="n">outdir</span><span class="o">=</span><span class="default_value">'output/waveforms/RF/P/matlab'</span></em>, <em class="sig-param"><span class="n">outfile</span><span class="o">=</span><span class="default_value">'matlab'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#read_rfs_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.tests.read_rfs_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in Matlab files constructed by the old GLImER workflow.
It takes a long time to decode h5 files with that and they cannot
be pickled either, so no multicore :-/</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Input directory. The default is ‘output/ccps’.</p></li>
<li><p><strong>outdir</strong> (<em>str</em><em>, </em><em>optional</em>) – Output directory. The default is ‘output/waveform/RF/matlab’.</p></li>
<li><p><strong>outfile</strong> (<em>str</em><em>, </em><em>optional</em>) – Output file. The default is ‘matlab’.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rf</strong> (<em>RFTrace</em>) – RFTracec object, one per receiver function.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – position in .mat.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.tests.rf_test">
<code class="sig-prename descclassname">pyglimer.test.tests.</code><code class="sig-name descname">rf_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">dip</span></em>, <em class="sig-param"><span class="n">rfloc</span><span class="o">=</span><span class="default_value">'output/waveforms/RF'</span></em>, <em class="sig-param"><span class="n">geom_file</span><span class="o">=</span><span class="default_value">'3D.geom'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#rf_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.tests.rf_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates synthetic PRFs from Raysum data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>string</em>) – “P” or “S”.</p></li>
<li><p><strong>dip</strong> (<em>int</em>) – Dip of the LAB in deg, determines, which files to use</p></li>
<li><p><strong>rfloc</strong> (<em>The parental directory</em><em>, </em><em>in which the RFs are saved.</em>) – </p></li>
<li><p><strong>geom_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of the geometry file</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rfs</strong> – List of RFTrace objects. Will in addition be saved in SAC format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.test.tests.test_SNR">
<code class="sig-prename descclassname">pyglimer.test.tests.</code><code class="sig-name descname">test_SNR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">network</span></em>, <em class="sig-param"><span class="n">station</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">preproloc</span><span class="o">=</span><span class="default_value">'ouput/waveforms/preprocessed'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#test_SNR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.test.tests.test_SNR" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the automatic QC scripts for a certain station and writes ratings
in the rating file.</p>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-utils">
<h2>pyglimer.utils<a class="headerlink" href="#pyglimer-utils" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.utils.changedb">
<span id="pyglimer-utils-changedb"></span><h3>pyglimer.utils.changedb<a class="headerlink" href="#module-pyglimer.utils.changedb" title="Permalink to this headline">¶</a></h3>
<p>Author: Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
<p>Created: Monday, 25th May 2020 10:40:03
Last Modified: Tuesday, 16th June 2020 12:01:45 pm</p>
<dl class="py function">
<dt id="pyglimer.utils.changedb.shortennames">
<code class="sig-prename descclassname">pyglimer.utils.changedb.</code><code class="sig-name descname">shortennames</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">rawloc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/changedb.html#shortennames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.changedb.shortennames" title="Permalink to this definition">¶</a></dt>
<dd><p>That was kinda a one-time function to correct a bug.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>phase</strong> (<em>[</em><em>type</em><em>]</em>) – [description]</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.create_geom">
<span id="pyglimer-utils-create-geom"></span><h3>pyglimer.utils.create_geom<a class="headerlink" href="#module-pyglimer.utils.create_geom" title="Permalink to this headline">¶</a></h3>
<p>Automatic creation of raysum geom files</p>
<p>Created on Thu May 14 10:23:39 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py function">
<dt id="pyglimer.utils.create_geom.create_geom">
<code class="sig-prename descclassname">pyglimer.utils.create_geom.</code><code class="sig-name descname">create_geom</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">bazv</span></em>, <em class="sig-param"><span class="n">raypv</span></em>, <em class="sig-param"><span class="n">shift_max</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">shape</span><span class="o">=</span><span class="default_value">'cross'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/create_geom.html#create_geom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.create_geom.create_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates geometry files for Raysum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – Number of stations. Has to be uneven if shape=cross.
Else has to be N=M**2. Were M is a natural number</p></li>
<li><p><strong>bazv</strong> (<em>np.ndarray</em><em>(</em><em>1D</em><em>)</em>) – 1D array containing the backzimuths per station (deg).</p></li>
<li><p><strong>raypv</strong> (<em>np.ndarray</em><em>(</em><em>1D</em><em>)</em>) – 1D array containing the slownesses in s/m per backzimuth.</p></li>
<li><p><strong>shift_max</strong> (<em>int</em>) – Maximum horizontal shift in m.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the output file.</p></li>
<li><p><strong>shape</strong> (<em>str</em>) – shape of the array</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For Even Ns.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.createvmodel">
<span id="pyglimer-utils-createvmodel"></span><h3>pyglimer.utils.createvmodel<a class="headerlink" href="#module-pyglimer.utils.createvmodel" title="Permalink to this headline">¶</a></h3>
<p>Create a 3D velocity model using Litho1.0</p>
<p>Created on Fri May  1 12:11:03 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py function">
<dt id="pyglimer.utils.createvmodel.load_avvmodel">
<code class="sig-prename descclassname">pyglimer.utils.createvmodel.</code><code class="sig-name descname">load_avvmodel</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/createvmodel.html#load_avvmodel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.createvmodel.load_avvmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a model over the average P and S-wave velocities in the upper
crust. These are used by the P-SV-SH rotation algorithm. Model data
is extracted from the Litho1.0 model (location provided above).
The package is distributed with a readily compiled model.</p>
<p>Litho1.0 must be installed and location must be set correct for a
complete compilation! However, function will first look in RAM and then
in data for a pickle file.</p>
<p>Compiling takes up to one hour!</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Model containing average velocities for upper crust.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.createvmodel.load_gyps">
<code class="sig-prename descclassname">pyglimer.utils.createvmodel.</code><code class="sig-name descname">load_gyps</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">latb</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lonb</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/createvmodel.html#load_gyps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.createvmodel.load_gyps" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiles the GyPSuM 3D-velocity object from included GyPSuM text files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Pickle the 3D velocity model after compiling it for the first time.
This will allow for faster access to the model. Saving the model takes
about 800 MB disk space.
The default is False, as it lead to unstabilities with joblib.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Creates a submodel from the full model. In form (minlat, maxlat).</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – (minlon, maxlon)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Object that can be queried for velocities.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ComplexModel object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.geo_utils">
<span id="pyglimer-utils-geo-utils"></span><h3>pyglimer.utils.geo_utils<a class="headerlink" href="#module-pyglimer.utils.geo_utils" title="Permalink to this headline">¶</a></h3>
<p>Geographical utilities.</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: November 2019</p>
<dl class="py function">
<dt id="pyglimer.utils.geo_utils.cart2geo">
<code class="sig-prename descclassname">pyglimer.utils.geo_utils.</code><code class="sig-name descname">cart2geo</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">z</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#cart2geo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.cart2geo" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes geographical coordinates from cartesian coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>numpy.array corresponding to y/z arrays</strong><strong>)</strong> (<em>x</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> (<em>z</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>r, latitude, longitude tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.epi2euc">
<code class="sig-prename descclassname">pyglimer.utils.geo_utils.</code><code class="sig-name descname">epi2euc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">epi</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#epi2euc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.epi2euc" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts epicentral distance in to a euclidean distance along the
corresponding chord.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.euc2epi">
<code class="sig-prename descclassname">pyglimer.utils.geo_utils.</code><code class="sig-name descname">euc2epi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">euc</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#euc2epi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.euc2epi" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts euclidean distance to epicentral distance</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.geo2cart">
<code class="sig-prename descclassname">pyglimer.utils.geo_utils.</code><code class="sig-name descname">geo2cart</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">latitude</span></em>, <em class="sig-param"><span class="n">longitude</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#geo2cart"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.geo2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cartesian coordinates from geographical coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>float</strong><strong> or </strong><strong>numpy.array corresponding to lat/lon arrays</strong><strong>)</strong> (<em>r</em>) – </p></li>
<li><p><strong>location</strong> – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> (<em>longitude</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xyz coordinates coordinates of same size as latitude and longitude arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.geo_utils.reckon">
<code class="sig-prename descclassname">pyglimer.utils.geo_utils.</code><code class="sig-name descname">reckon</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lat</span></em>, <em class="sig-param"><span class="n">lon</span></em>, <em class="sig-param"><span class="n">distance</span></em>, <em class="sig-param"><span class="n">bearing</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#reckon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.reckon" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes new latitude and longitude from bearing and distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>lon</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>bearing</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>distance</strong> (<em>in degrees</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lat, lon</p>
</dd>
</dl>
<p>lat1 = math.radians(52.20472)  # Current lat point converted to radians
lon1 = math.radians(0.14056)  # Current long point converted to radians
bearing = np.pi/2 # 90 degrees
# lat2  52.20444 - the lat result I’m hoping for
# lon2  0.36056 - the long result I’m hoping for.</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.nextpowof2">
<span id="pyglimer-utils-nextpowof2"></span><h3>pyglimer.utils.nextpowof2<a class="headerlink" href="#module-pyglimer.utils.nextpowof2" title="Permalink to this headline">¶</a></h3>
<p>Created on Fri Oct 18 20:36:40 2019</p>
<p>&#64;author: pm</p>
<dl class="py function">
<dt id="pyglimer.utils.nextpowof2.nextPowerOf2">
<code class="sig-prename descclassname">pyglimer.utils.nextpowof2.</code><code class="sig-name descname">nextPowerOf2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/nextpowof2.html#nextPowerOf2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.nextpowof2.nextPowerOf2" title="Permalink to this definition">¶</a></dt>
<dd><p>just returns the next higher power of two from n</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.roundhalf">
<span id="pyglimer-utils-roundhalf"></span><h3>pyglimer.utils.roundhalf<a class="headerlink" href="#module-pyglimer.utils.roundhalf" title="Permalink to this headline">¶</a></h3>
<p>Rounds to next 0.5</p>
<p>Created on Sat May  2 13:48:00 2020</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
</dd>
</dl>
<p>Last updated:</p>
<dl class="py function">
<dt id="pyglimer.utils.roundhalf.roundhalf">
<code class="sig-prename descclassname">pyglimer.utils.roundhalf.</code><code class="sig-name descname">roundhalf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">number</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/roundhalf.html#roundhalf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.roundhalf.roundhalf" title="Permalink to this definition">¶</a></dt>
<dd><p>Rounds to next half of integer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number</strong> (<em>float/int</em>) – number to be rounded.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Closest half of integer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.signalproc">
<span id="pyglimer-utils-signalproc"></span><h3>pyglimer.utils.signalproc<a class="headerlink" href="#module-pyglimer.utils.signalproc" title="Permalink to this headline">¶</a></h3>
<p>Created on Sun Oct 20 10:31:02 2019</p>
<p>&#64;author: pm</p>
<dl class="py function">
<dt id="pyglimer.utils.signalproc.convf">
<code class="sig-prename descclassname">pyglimer.utils.signalproc.</code><code class="sig-name descname">convf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">nf</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#convf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.signalproc.convf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolution conducted in the frequency domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>np.array</em>) – Array 1.</p></li>
<li><p><strong>v</strong> (<em>np.array</em>) – Array 2.</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling Interval [s].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>c</strong> – Convolution of u with v.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.corrf">
<code class="sig-prename descclassname">pyglimer.utils.signalproc.</code><code class="sig-name descname">corrf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">nf</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#corrf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.signalproc.corrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Cross-correlation in frequency domain,
calculates the x=crosscorr(u,v). Hence, v is the flipped vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>np.array</em>) – flipped vector.</p></li>
<li><p><strong>v</strong> (<em>np.array</em>) – Vector that the correlation is measured to.</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – Correlation vector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.filter">
<code class="sig-prename descclassname">pyglimer.utils.signalproc.</code><code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">nf</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.signalproc.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolves a filter with a signal (given in time domain).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>np.array</em>) – Signal given in time domain.</p></li>
<li><p><strong>F</strong> (<em>np.array</em>) – Filter’s amplitude response.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s_f</strong> – Filtered signal.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.gaussian">
<code class="sig-prename descclassname">pyglimer.utils.signalproc.</code><code class="sig-name descname">gaussian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">width</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.signalproc.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a zero-phase Gaussian function. In particular meant to be
convolved with the impulse
response that is the output of an iterative deconvolution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>INTEGER</em>) – Length of the desired array.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>width</strong> (<em>FLOAT</em>) – Width parameter of the Gaussian function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>G</strong> – Gaussian window.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.noise">
<code class="sig-prename descclassname">pyglimer.utils.signalproc.</code><code class="sig-name descname">noise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">A</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.signalproc.noise" title="Permalink to this definition">¶</a></dt>
<dd><p>create random noise
INPUT:</p>
<blockquote>
<div><p>N: signal length
A: maximal amplitude</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.ricker">
<code class="sig-prename descclassname">pyglimer.utils.signalproc.</code><code class="sig-name descname">ricker</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">N2</span></em>, <em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#ricker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.signalproc.ricker" title="Permalink to this definition">¶</a></dt>
<dd><p>create a zero-phase Ricker / Mexican hat wavelet
INPUT:</p>
<blockquote>
<div><p>sigma - standard deviation
dt - sampling Interval
N2 - number of samples/2 (halflength). Full length = 2*N2+1</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.signalproc.sshift">
<code class="sig-prename descclassname">pyglimer.utils.signalproc.</code><code class="sig-name descname">sshift</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">N2</span></em>, <em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">shift</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#sshift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.signalproc.sshift" title="Permalink to this definition">¶</a></dt>
<dd><p>shift a signal by a given time-shift in the frequency domain
INPUT:</p>
<blockquote>
<div><p>s: signal
N2: length of the signal in f-domain (usually equals the next pof 2)
dt: sampling interval
shift: the time shift in seconds</p>
</div></blockquote>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.utils">
<span id="pyglimer-utils-utils"></span><h3>pyglimer.utils.utils<a class="headerlink" href="#module-pyglimer.utils.utils" title="Permalink to this headline">¶</a></h3>
<p>Module containing mini-utilities/convenience functions.</p>
<dl class="simple">
<dt>Author:</dt><dd><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: November 2019</p>
<dl class="py function">
<dt id="pyglimer.utils.utils.chunks">
<code class="sig-prename descclassname">pyglimer.utils.utils.</code><code class="sig-name descname">chunks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lst</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#chunks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.utils.chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield successive n-sized chunks from lst. Useful for multi-threading</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.utils.utils.dt_string">
<code class="sig-prename descclassname">pyglimer.utils.utils.</code><code class="sig-name descname">dt_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#dt_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.utils.utils.dt_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Time elapsed string depending on how much time has passed.
After a certain amount of seconds it returns minutes, and after a certain
amount of minutes it returns the elapsed time in hours.</p>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-ccp">
<h2>pyglimer.ccp<a class="headerlink" href="#pyglimer-ccp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.ccp.ccp">
<span id="pyglimer-ccp-ccp"></span><h3>pyglimer.ccp.ccp<a class="headerlink" href="#module-pyglimer.ccp.ccp" title="Permalink to this headline">¶</a></h3>
<p>Author: Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
<p>Created: Friday, 10th April 2020 05:30:18 pm
Last Modified: Friday, 3rd July 2020 05:36:27 pm</p>
<dl class="py class">
<dt id="pyglimer.ccp.ccp.CCPStack">
<em class="property">class </em><code class="sig-prename descclassname">pyglimer.ccp.ccp.</code><code class="sig-name descname">CCPStack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">latitude</span></em>, <em class="sig-param"><span class="n">longitude</span></em>, <em class="sig-param"><span class="n">edist</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Is a CCP Stack matrix. Its size depends upon stations that are used as
input.</p>
<p>Creates an empy object template for a CCP stack</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of all seismic stations.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of all seismic stations.</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Inter bin distance in angular distance.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true -&gt; console output. The default is True., defaults to True</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.compute_stack">
<code class="sig-name descname">compute_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vel_model</span></em>, <em class="sig-param"><span class="n">rfloc</span><span class="o">=</span><span class="default_value">'output/waveforms/RF'</span></em>, <em class="sig-param"><span class="n">statloc</span><span class="o">=</span><span class="default_value">'output/stations'</span></em>, <em class="sig-param"><span class="n">preproloc</span><span class="o">=</span><span class="default_value">'output/waveforms/preprocessed'</span></em>, <em class="sig-param"><span class="n">network</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">geocoords</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pattern</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">binrad</span><span class="o">=</span><span class="default_value">0.8660254037844387</span></em>, <em class="sig-param"><span class="n">append_pp</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.compute_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp, using the data from rfloc.
The stack can be limited to some networks and
stations. This will take a long while for big data sets!
Note that the grid should be big enough for the provided networks and
stations. Best to create the CCPStack object by using ccp.init_ccp().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either <cite>iasp91.dat</cite>
for 1D raytracing or <cite>3D</cite> for 3D raytracing with GYPSuM model.
Using 3D Raytracing will cause the code to take about 30% longer.</p></li>
<li><p><strong>rfloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder in which the receiver functions in
time domain are. The default is ‘output/waveforms/RF.</p></li>
<li><p><strong>statloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Folder containing the response information. Only needed
if option geocoords is used. The default is ‘output/stations’.</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder containing the preprocessed mseeds.
Only needed if option geocoords is used. The default is
‘output/waveforms/preprocessed’.</p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Network or networks that are to be included in the ccp stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Station or stations that are to be included in the ccp stack.
Standard unix wildcards are allowed.
Can only be list if type(network)=str.
If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Include all stations in the rectangle given by
(minlat, maxlat, minlon, maxlon). Will be ignored if pattern or
network is given, by default None.</p></li>
<li><p><strong>pattern</strong> (<em>list</em><em>, </em><em>optional</em>) – Search pattern for .sac files. Overwrites network,
station, and geocooords options. Usually only used by
<a class="reference internal" href="#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a>, defaults to None.</p></li>
<li><p><strong>save</strong> (<em>str</em><em> or </em><em>bool</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with
filename will be saved in config.ccp. Will be saved as pickle file.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – Defines the bin radius with
bin radius = binrad*distance_bins.
Full Overlap = cosd(30), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – appends piercing point coordinates if True, so they
can later be plotted. Not recommended for big data sets.
The default is false. <strong>Deprecated for multi-core</strong></p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For wrong inputs</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.conclude_ccp">
<code class="sig-name descname">conclude_ccp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">keep_empty</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">keep_water</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">r</span><span class="o">=</span><span class="default_value">3</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.conclude_ccp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.conclude_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Averages the CCP-bin and populates empty cells with average of
neighbouring cells. No matter which option is
chosen for the parameters, data is never lost entirely. One can always
execute a new conclude_ccp() command. However, decisions that are
taken here will affect the .mat output and plotting outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_empty</strong> (<em>bool</em><em>, </em><em>optional</em>) – Keep entirely empty bins. The default is False.</p></li>
<li><p><strong>keep_water</strong> (<em>bool</em><em>, </em><em>optional</em>) – For False all bins that are on water-covered areas
will be discarded, defaults to False</p></li>
<li><p><strong>r</strong> (<em>int</em><em>, </em><em>optional</em>) – Fields with less than r hits will be set equal 0.
r has to be &gt;= 1, defaults to 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.multicore_stack">
<code class="sig-name descname">multicore_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stream</span></em>, <em class="sig-param"><span class="n">append_pp</span></em>, <em class="sig-param"><span class="n">n_closest_points</span></em>, <em class="sig-param"><span class="n">vmodel</span></em>, <em class="sig-param"><span class="n">latb</span></em>, <em class="sig-param"><span class="n">lonb</span></em>, <em class="sig-param"><span class="n">filt</span></em>, <em class="sig-param"><span class="n">idx</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.multicore_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.multicore_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in chunks of data to be processed on one core.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<em>list</em>) – List of file locations.</p></li>
<li><p><strong>append_pp</strong> (<em>Bool</em>) – Should piercing points be appended?.</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of Closest points that the KDTree
should query.</p></li>
<li><p><strong>vmodel</strong> (<em>str</em>) – Name of the velocity model that should be used for the
raytraycing.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em>) – Tuple in Form (minlon, maxlon). To save RAM on 3D
raytraycing. Will remain unused for 1D RT</p></li>
<li><p><strong>filt</strong> (<em>bool</em><em> or </em><em>tuple</em><em>]</em>) – Should the RFs be filtered before the ccp stack?
If so, provide (lowcof, highcof).</p></li>
<li><p><strong>idx</strong> (<em>int</em>) – Index for progress bar</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Three lists containing indices and rf-data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.plot_bins">
<code class="sig-name descname">plot_bins</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple map view of the bins.</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.query_bin_tree">
<code class="sig-name descname">query_bin_tree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">latitude</span></em>, <em class="sig-param"><span class="n">longitude</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">n_closest_points</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.query_bin_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Find closest bins for provided latitude and longitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of piercing points.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of piercing points.</p></li>
<li><p><strong>data</strong> (<em>1-D numpy.ndarray</em>) – Depth migrated receiver function data</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of closest points to be found.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bin index k and depth index j</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">folder</span><span class="o">=</span><span class="default_value">'output/ccps'</span></em>, <em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">'pickle'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the CCPStream file as pickle or matlab file. Only save
as Matlab file for exporting, as not all information can be
preserved!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name as which to save, file extensions aren’t
necessary.</p></li>
<li><p><strong>folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Output folder, defaults to ‘output/ccps’</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – Either “pickle” or “matlab” for .mat, defaults to “pickle”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.ccp.init_ccp">
<code class="sig-prename descclassname">pyglimer.ccp.ccp.</code><code class="sig-name descname">init_ccp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spacing</span></em>, <em class="sig-param"><span class="n">vel_model</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">statloc</span><span class="o">=</span><span class="default_value">'output/stations'</span></em>, <em class="sig-param"><span class="n">preproloc</span><span class="o">=</span><span class="default_value">'output/waveforms/preprocessed'</span></em>, <em class="sig-param"><span class="n">rfloc</span><span class="o">=</span><span class="default_value">'output/waveforms/RF'</span></em>, <em class="sig-param"><span class="n">network</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">station</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">geocoords</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">compute_stack</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">binrad</span><span class="o">=</span><span class="default_value">0.8660254037844387</span></em>, <em class="sig-param"><span class="n">append_pp</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">save</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#init_ccp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.init_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp using data from statloc and rfloc.
The stack can be limited to some networks and
stations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spacing</strong> (<em>float</em>) – Angular distance between each bingrid point.</p></li>
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either iasp91 (1D
raytracing) or 3D for 3D raytracing using a model compiled from GyPSuM.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either ‘S’ or ‘P’. Use ‘S’ if dataset contains both SRFs and
PRFs.</p></li>
<li><p><strong>statloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory in that the station xmls are saved,
defaults to ‘output/stations’</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental directory in that the preprocessed miniseeds are
saved, defaults to ‘output/waveforms/preprocessed’</p></li>
<li><p><strong>rfloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental directory in that the RFs are saved,
defaults to ‘output/waveforms/RF’</p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Network or networks that are to be included in the ccp stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Station or stations that are to be included in the ccp
stack. Standard unix wildcards are allowed. Can only be list if
type(network)=str. If None, the whole database will be used.
The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – An alternative way of selecting networks and stations.
Given in the form (minlat, maxlat, minlon, maxlon), defaults to None</p></li>
<li><p><strong>compute_stack</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true it will compute the stack by calling
<a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="pyglimer.ccp.ccp.CCPStack.compute_stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_stack()</span></code></a>.
That can take a long time! The default is False.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – Only used if compute_stack=True
Defines the bin radius with bin radius = binrad*distance_bins.
Full Overlap = cosd(30), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – Only used if compute_stack=True.
Appends piercing point locations to object. Can be used to plot
pps on map. Not recommended for large datasets as it takes A LOT
longer and makes the file a lot larger.
The default is False., defaults to False</p></li>
<li><p><strong>save</strong> (<em>ool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with filename
will be saved. Will be saved as pickle file.
The default is False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display info in terminal., defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – For wrong inputs.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPstack</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.ccp.read_ccp">
<code class="sig-prename descclassname">pyglimer.ccp.ccp.</code><code class="sig-name descname">read_ccp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="o">=</span><span class="default_value">'ccp.pkl'</span></em>, <em class="sig-param"><span class="n">folder</span><span class="o">=</span><span class="default_value">'output/ccps'</span></em>, <em class="sig-param"><span class="n">fmt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#read_ccp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.ccp.read_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CCP-Stack class file from input folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of the input file with file ending.
The default is ‘ccp.pkl’.</p></li>
<li><p><strong>folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Input folder, defaults to ‘output/ccps’</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – File format, can be none if the filename has an ending,
possible options are “pickle. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPStack</span></code></a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.compute.bin">
<span id="pyglimer-ccp-compute-bin"></span><h3>pyglimer.ccp.compute.bin<a class="headerlink" href="#module-pyglimer.ccp.compute.bin" title="Permalink to this headline">¶</a></h3>
<p>Module that covers the binning part of the CCP computation.
Authors: Peter Makus (<a class="reference external" href="mailto:peter&#46;makus&#37;&#52;&#48;student&#46;uib&#46;no">peter<span>&#46;</span>makus<span>&#64;</span>student<span>&#46;</span>uib<span>&#46;</span>no</a>)</p>
<blockquote>
<div><p>and
Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</div></blockquote>
<p>Created: November 2019
Last Modified: Friday, 3rd July 2020 05:03:45 pm</p>
<dl class="py class">
<dt id="pyglimer.ccp.compute.bin.BinGrid">
<em class="property">class </em><code class="sig-prename descclassname">pyglimer.ccp.compute.bin.</code><code class="sig-name descname">BinGrid</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">latitude</span></em>, <em class="sig-param"><span class="n">longitude</span></em>, <em class="sig-param"><span class="n">edist</span></em>, <em class="sig-param"><span class="n">phase</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates Bingrid object from parameters</p>
<p>BinGrid object that can be used to find closest neighbours to
stations and CCP bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.array</cite>) – Latitudes</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.array</cite>) – Longitudes</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Distance (in degree) between bin centres.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – consoel output?, defaults to True</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.compute_bins">
<code class="sig-name descname">compute_bins</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.compute_bins"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.compute_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bins close to all stations</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.query_bin_tree">
<code class="sig-name descname">query_bin_tree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">latitude</span></em>, <em class="sig-param"><span class="n">longitude</span></em>, <em class="sig-param"><span class="n">binrad</span></em>, <em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_bin_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>binrad</strong> (<em>float</em>) – maximum  distance to be queried in euclidean distance
Equals the radius of the bin, higher = more averaging -&gt;
–&gt; less noise, lower resolution</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of neighbours to return. Note that this directly
depends on the ratio of deltabin/binrad.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.query_station_tree">
<code class="sig-name descname">query_station_tree</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">latitude</span></em>, <em class="sig-param"><span class="n">longitude</span></em>, <em class="sig-param"><span class="n">maxdist</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_station_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>maxdist</strong> (<em>float</em>) – maximum  distance to be queried in degree</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Euclidian distances to next point, indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple with 2 1D <cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.station_tree">
<code class="sig-name descname">station_tree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.station_tree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the input</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="ccp.html" class="btn btn-neutral float-left" title="Common Conversion Point Stacking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Peter Makus

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>