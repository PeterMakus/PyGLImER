
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyglimer.ccp</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/blank.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="pyglimer.utils" href="utils.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../introduction/introduction.html">
  Introduction
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../creation/index.html">
  Receiver Functions
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../receiver_functions/index.html">
  RF Handling
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../ccp/index.html">
  CCP
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../plotting/index.html">
  Plotting
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  API
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="http://www.stephanerondenay.com/glimer-web.html">GLImER<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PeterMakus/PyGLImER" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="waveform.html">
   pyglimer.waveform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rf.html">
   pyglimer.rf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="database.html">
   pyglimer.database
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test.html">
   pyglimer.test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="utils.html">
   pyglimer.utils
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   pyglimer.ccp
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-pyglimer.ccp.ccp">
   pyglimer.ccp.ccp
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-pyglimer.ccp.io">
   pyglimer.ccp.io
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-pyglimer.ccp.compute.bin">
   pyglimer.ccp.compute.bin
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-pyglimer.ccp.plot_utils.plot_cross_section">
   pyglimer.ccp.plot_utils.plot_cross_section
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-pyglimer.ccp.plot_utils.plot_line_buffer">
   pyglimer.ccp.plot_utils.plot_line_buffer
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-pyglimer.ccp.plot_utils.line_buffer">
   pyglimer.ccp.plot_utils.line_buffer
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/PeterMakus/PyGLImER/edit/master/docs/chapters/api/ccp.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="pyglimer-ccp">
<h1>pyglimer.ccp<a class="headerlink" href="#pyglimer-ccp" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyglimer.ccp.ccp">
<span id="pyglimer-ccp-ccp"></span><h2>pyglimer.ccp.ccp<a class="headerlink" href="#module-pyglimer.ccp.ccp" title="Permalink to this headline">¶</a></h2>
<p>Module for the Common Conversion Stack Computation and handling of the
objects resulting from such.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 10th April 2020 05:30:18 pm
Last Modified: Monday, 4th October 2021 05:08:14 pm</p>
<dl class="py class">
<dt id="pyglimer.ccp.ccp.CCPStack">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">CCPStack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_load</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Is a CCP Stack matrix. Its size depends upon stations that are used as
input.</p>
<p>Creates an empy object template for a CCP stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of all seismic stations.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of all seismic stations.</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Inter bin distance in angular distance.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true -&gt; console output. The default is True.</p></li>
<li><p><strong>logdir</strong> – Directory for log file</p></li>
<li><p><strong>_load</strong> (<em>str</em>) – Parameter is only used internally when loading from a
binary numpy file. Then, this passes a filename.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.compute_kdtree_volume">
<code class="sig-name descname"><span class="pre">compute_kdtree_volume</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.compute_kdtree_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.compute_kdtree_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the CCP kdtree, we get the closest few points and compute
the weighting using a distance metric. if points are too far away,
they aren’t weighted</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qlon</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – grid defining array for longitude</p></li>
<li><p><strong>qlat</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – grid defining array for latitude</p></li>
<li><p><strong>gz</strong> (<em>np.array</em><em> or </em><em>list</em>) – grid defining array for z</p></li>
<li><p><strong>r</strong> (<em>float</em><em> or </em><em>None</em>) – outside r everything is nan</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.compute_stack">
<code class="sig-name descname"><span class="pre">compute_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vel_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'hdf5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocoords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.57735026918962573</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'joblib'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.compute_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp, using the data from rfloc.
The stack can be limited to some networks and stations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either <cite>iasp91.dat</cite>
for 1D raytracing or <cite>3D</cite> for 3D raytracing with GYPSuM model.
Using 3D Raytracing will cause the code to take about 30% longer.</p></li>
<li><p><strong>rfloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder in which the receiver functions in
time domain are. The default is ‘output/waveforms/RF.</p></li>
<li><p><strong>in_format</strong> (<em>str</em><em>, </em><em>optional</em>) – <strong>INPUT FORMAT</strong> of receiver functions. Either
<cite>‘sac’</cite> or <cite>‘hdf5’</cite>. Defaults to ‘hdf5’.</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder containing the preprocessed mseeds.
Only needed if option geocoords is used. The default is
None. <strong>Should be None if hdf5 is used!</strong></p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Network or networks that are to be included in the ccp stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Station or stations that are to be included in the ccp stack.
Standard unix wildcards are allowed.
Can only be list if type(network)=str.
If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Include all stations in the rectangle given by
(minlat, maxlat, minlon, maxlon). Will be ignored if pattern or
network is given, by default None.</p></li>
<li><p><strong>pattern</strong> (<em>list</em><em>, </em><em>optional</em>) – Search pattern for files. Overwrites network,
station, and geocooords options. Usually only used by
<a class="reference internal" href="#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a>, defaults to None.</p></li>
<li><p><strong>save</strong> (<em>str</em><em> or </em><em>bool</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with
filename will be saved in config.ccp. Will be saved as pickle file.</p></li>
<li><p><strong>filt</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Decides whether to filter the receiver function prior to
depth migration. Either a Tuple of form <cite>(lowpassf, highpassf)</cite> or
<cite>None</cite> / <cite>False</cite>.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – Defines the bin radius with
bin radius = binrad*distance_bins.
Full Overlap = 1/(2*cosd(30)), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – appends piercing point coordinates if True, so they
can later be plotted. Not recommended for big data sets.
The default is false. <strong>Deprecated for multi-core</strong></p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Append receiver functions for first order multiples.
It can be decided later, whether they should be used in the final
ccp stack. Will result in a longer computation time.</p></li>
<li><p><strong>mc_backend</strong> – Multi-core backend to use for the computations.
Can be either <cite>“joblib”</cite> (multiprocessing) or <cite>“MPI”</cite>. Not that
MPI compatibility is only implemented with hdf5 files.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For wrong inputs</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This will take a long while for big data sets!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using, <cite>mc_backend=’MPI’</cite>. This has to be started from a
terminal via mpirun.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MPI is only compatible with receiver functions saved in hdf5
format.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the grid should be big enough for the provided networks
and stations. Best to create the CCPStack object by using
<code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.conclude_ccp">
<code class="sig-name descname"><span class="pre">conclude_ccp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_empty</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_water</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.conclude_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.conclude_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Averages the CCP-bin and populates empty cells with average of
neighbouring cells. No matter which option is
chosen for the parameters, data is never lost entirely. One can always
execute a new conclude_ccp() command. However, decisions that are
taken here will affect the .mat output and plotting outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_empty</strong> (<em>bool</em><em>, </em><em>optional</em>) – Keep entirely empty bins. The default is False.</p></li>
<li><p><strong>keep_water</strong> (<em>bool</em><em>, </em><em>optional</em>) – For False all bins that are on water-covered areas
will be discarded, defaults to False</p></li>
<li><p><strong>r</strong> (<em>int</em><em>, </em><em>optional</em>) – Fields with less than r hits will be set equal 0.
r has to be &gt;= 1, defaults to 3.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> or </em><em>str</em>) – Use multiples in stack. Either False or weigthing;
i.e. ‘linear’ for linearly weighted stack between the three phases,
‘zk’ for a Zhu &amp; Kanamori approach, or ‘pws’ for a phase weighted
stack. Use ‘m1’ to use only first multiple mode (no stack),
‘m2’ for
RFs created only with 2nd multiple phase (PSS), and m for an
equal-weight stack of m1 and m2. By default False.</p></li>
<li><p><strong>z_multiple</strong> (<em>int</em><em>, </em><em>optional</em>) – Until which depth [km] should multiples be
considered,
maximal value is 200 [km]. Will only be used if multiple=True.
By default 200 km.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.create_vtk_mesh">
<code class="sig-name descname"><span class="pre">create_vtk_mesh</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.create_vtk_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.create_vtk_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a mesh with given bounding box s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo</strong> (<em>bool</em><em>, </em><em>optional</em>) – flag whether the output mesh is in geographical coordinates or
meters, by default True</p></li>
<li><p><strong>bbox</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – bounding box [minlon, maxlon, minlat, maxlat]. If None
No boundaries are taken, by default None</p></li>
<li><p><strong>filename</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set, the computed grid will be output as VTK file under the
given filename. This file can then later be opened using either the
plotting tool or, e.g., Paraview. If None, no file is written.
By default, None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs a vtk mesh that can be opened in, e.g., Paraview.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VTK.UnstructuredGrid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.explore">
<code class="sig-name descname"><span class="pre">explore</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.explore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.explore" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a volume exploration window set. One window is for all
plots, and the other window is generated with sliders such that one
can explore how future plots should be generated. It technically does
not require any inputs, as simply the binning size will be used to
create a meshgrid fitting to the bin distance distribution.
One can however set a factor by which to divide the bin distance for a
finer grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>) – Bingrid epicentral distance multiplier to refine grid.
Defaults to 0.5.</p></li>
<li><p><strong>maxz</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Maximum Depth if None, the max ccp bin depth is used.
Defaults to None.</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
<li><p><strong>extent</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>Non</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VolumeExploration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.map_plot">
<code class="sig-name descname"><span class="pre">map_plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_stations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_illum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_direct</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.map_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.map_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a map plot of the CCP Stack containing user-defined information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_stations</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot the station locations, by default False</p></li>
<li><p><strong>plot_bins</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot bin location, by default False</p></li>
<li><p><strong>plot_illum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot bin location with colour depending on the depth-cumulative
illumination at bin b, by default False</p></li>
<li><p><strong>profile</strong> (<em>list</em><em> or </em><em>tupleor None</em><em>, </em><em>optional</em>) – Plot locations of cross sections into the plot. Information about
each cross section is given as a tuple (lon1, lon2, lat1, lat2),
several cross sections are given as a list of tuples in said
format, by default None.</p></li>
<li><p><strong>p_direct</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true the list in profile decribes areas with coordinates of the
lower left and upper right corner, by default True</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Save plot to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format for the file to be saved as, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI for none vector format plots, by default 300</p></li>
<li><p><strong>geology</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot a geological map. Requires internet connection</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Set title for plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.multicore_stack">
<code class="sig-name descname"><span class="pre">multicore_stack</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_closest_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.multicore_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.multicore_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in chunks of data to be processed on one core.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<em>list</em>) – List of file locations.</p></li>
<li><p><strong>append_pp</strong> (<em>Bool</em>) – Should piercing points be appended?.</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of Closest points that the KDTree
should query.</p></li>
<li><p><strong>vmodel</strong> (<em>str</em>) – Name of the velocity model that should be used for the
raytraycing.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em>) – Tuple in Form (minlon, maxlon). To save RAM on 3D
raytraycing. Will remain unused for 1D RT</p></li>
<li><p><strong>filt</strong> (<em>bool</em><em> or </em><em>tuple</em><em>]</em>) – Should the RFs be filtered before the ccp stack?
If so, provide (lowcof, highcof).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Three lists containing indices and rf-data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.pick_phase">
<code class="sig-name descname"><span class="pre">pick_phase</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'+'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyglimer.ccp.ccp.PhasePick" title="pyglimer.ccp.ccp.PhasePick"><span class="pre">pyglimer.ccp.ccp.PhasePick</span></a><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.pick_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.pick_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick the strongest negative or strongest positive gradient from a
predefined depth-range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Either ‘+’ for positive velocity gradient or ‘-‘ for negative
gradient, by default ‘+’</p></li>
<li><p><strong>depth</strong> (<em>list</em><em>, </em><em>optional</em>) – List with two elements [minz, maxz], defines in which depth window
the phase picker is gonna look for maxima and minima,
by default [None, None]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A phasepick object, which subsequently can be plotted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.ccp.ccp.PhasePick" title="pyglimer.ccp.ccp.PhasePick">PhasePick</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For errandeous inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.plot_bins">
<code class="sig-name descname"><span class="pre">plot_bins</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple map view of the bins.</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.plot_cross_section">
<code class="sig-name descname"><span class="pre">plot_cross_section</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_cross_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_cross_section" title="Permalink to this definition">¶</a></dt>
<dd><p>See documentation for
<a class="reference internal" href="#pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section" title="pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_cross_section()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.plot_volume_sections">
<code class="sig-name descname"><span class="pre">plot_volume_sections</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minillum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_volume_sections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_volume_sections" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the same plot as the <cite>explore</cite> tool, but(!) statically and
with more options left to the user.</p>
<p>!!! IT IS IMPORTANT for the plotting function that the input arrays
are monotonically increasing!!!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qlon</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>qlat</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>lonsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of lon is used,
by default None</p></li>
<li><p><strong>latsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of lat is used,
by default None</p></li>
<li><p><strong>zsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of depth is used,
by default None</p></li>
<li><p><strong>r</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Max radius for interpolation values taken into account [km],
if None bingrid.edist * DEG2KM * 2.0, by default None</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to make figure window visible, default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VolumePlot</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.query_bin_tree">
<code class="sig-name descname"><span class="pre">query_bin_tree</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_closest_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.query_bin_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Find closest bins for provided latitude and longitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of piercing points.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of piercing points.</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of closest points to be found.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bin index k and depth index j</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.ccp.CCPStack.write">
<code class="sig-name descname"><span class="pre">write</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pickle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#CCPStack.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the CCPStream file as pickle or matlab file. Only save
as Matlab file for exporting, as not all information can be
preserved!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name as which to save, file extensions aren’t
necessary.</p></li>
<li><p><strong>folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Output folder, defaults to ‘output/ccps’</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – Either <cite>“pickle”</cite>, <cite>‘npz’</cite> or <cite>“matlab”</cite> for .mat,
defaults to “pickle”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Saving in numpy (npz) format is the most robust option. However,
loading those files will take the longest time as some attributes
have to be recomputed. <strong>NUMPY FORMAT IS RECOMMENDED FOR
ARCHIVES!</strong></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Pickling files is the fastest option, but might lead to
incompatibilities between different PyGLImER versions.
<strong>USE PICKLE IF YOU WOULD LIKE TO SAVE FILES FOR SHORTER AMOUNTS
OF TIME.</strong></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Saving as Matlab files is only meant if one wishes to plot with
the old Matlab Receiver function exploration toolset (not
recommended anymore).</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyglimer.ccp.ccp.PhasePick">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">PhasePick</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitudes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarity</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depthrange</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#PhasePick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.PhasePick" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A phasepick object, just created for more convenient plotting.</p>
<p>Initialise object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em>) – 2-d array containing latitudes and longitudes.</p></li>
<li><p><strong>amplitudes</strong> (<em>np.ndarray</em>) – 1-D array containg amplitude values of each bin</p></li>
<li><p><strong>polarity</strong> (<em>str</em>) – Either ‘+’ for positive velocity gradients or ‘-‘ for negative</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – 1D array containing depth of maxima/minima per bin</p></li>
<li><p><strong>depthrange</strong> (<em>list</em><em>, </em><em>optional</em>) – list containing depth restrictions in form of [zmin, zmax],
by default [None, None]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.ccp.PhasePick.plot">
<code class="sig-name descname"><span class="pre">plot</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_amplitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'gist_rainbow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#PhasePick.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.PhasePick.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot heatmap containing depth or amplitude of picked phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_amplitude</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True amplitude instead of depths is plotted, by default False</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Write Figure to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – File format, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – Resolution for non-vector graphics, by default 300</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap</p></li>
<li><p><strong>geology</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot geological map.</p></li>
<li><p><strong>title</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.ccp.init_ccp">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">init_ccp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocoords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_stack</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.86602540378443871</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'hdf5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'joblib'</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><span class="pre">pyglimer.ccp.ccp.CCPStack</span></a><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#init_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.init_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp using data from statloc and rfloc.
The stack can be limited to some networks and
stations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rfloc</strong> (<em>str</em>) – Parental directory in that the RFs are saved.</p></li>
<li><p><strong>spacing</strong> (<em>float</em>) – Angular distance between each bingrid point.</p></li>
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either iasp91 (1D
raytracing) or 3D for 3D raytracing using a model compiled from GyPSuM.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – The teleseismic phase to be used.</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental directory in that the preprocessed miniseeds are
saved, defaults to None. <strong>Should be None when working with h5 files!</strong></p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Network or networks that are to be included in the ccp
stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Station or stations that are to be included in the ccp
stack. Standard unix wildcards are allowed. Can only be list if
type(network)==str. If None, the whole database will be used.
The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – An alternative way of selecting networks and stations.
Given in the form (minlat, maxlat, minlon, maxlon), defaults to None</p></li>
<li><p><strong>compute_stack</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true it will compute the stack by calling
<a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="pyglimer.ccp.ccp.CCPStack.compute_stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute_stack()</span></code></a>.
That can take a long time! The default is False.</p></li>
<li><p><strong>filt</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Decides whether to filter the receiver function prior to
depth migration. Either a Tuple of form <cite>(lowpassf, highpassf)</cite> or
<cite>None</cite> / <cite>False</cite>.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – <em>Only used if compute_stack=True</em>
Defines the bin radius with bin radius = binrad*distance_bins.
Full Overlap = cosd(30), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – <em>Only used if compute_stack=True.</em>
Appends piercing point locations to object. Can be used to plot
pps on map. Not recommended for large datasets as it takes A LOT
longer and makes the file a lot larger.
The default is False., defaults to False</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the CCP Stack be prepared to work with multiples?
It can be chosen later, whether the RFs from multiples are to be
incorporated into the CCP Stack. By default False.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with
filename will be saved. Will be saved as pickle file.
The default is False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display info in terminal., defaults to True</p></li>
<li><p><strong>format</strong> (<em>str</em>) – The <strong>INPUT FORMAT</strong> from which receiver functions are read.
If you saved your receiver function as hdf5 files, set ==hdf5.
Defaults to hdf5.</p></li>
<li><p><strong>mc_backend</strong> – Multi-core backend to use for the computations.
Can be either <cite>“joblib”</cite> (multiprocessing) or <cite>“MPI”</cite>. Not that MPI
compatibility is only implemented with hdf5 files.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – For wrong inputs.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPstack</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using, <cite>mc_backend=’MPI’</cite>. This has to be started from a terminal
via mpirun.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MPI is only compatible with receiver functions saved in hdf5 format.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.ccp.read_ccp">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></code><code class="sig-name descname"><span class="pre">read_ccp</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><span class="pre">pyglimer.ccp.ccp.CCPStack</span></a><a class="reference internal" href="../../_modules/pyglimer/ccp/ccp.html#read_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.read_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CCP-Stack class file from input folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of the input file with file ending.
The default is ‘ccp.pkl’.</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – File format, can be none if the filename has an ending,
possible options are <cite>“pickle”</cite> or <cite>“npz”</cite>. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPStack</span></code></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Loading Files from numpy format will take a while as some
recomputations are necessary.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.io">
<span id="pyglimer-ccp-io"></span><h2>pyglimer.ccp.io<a class="headerlink" href="#module-pyglimer.ccp.io" title="Permalink to this headline">¶</a></h2>
<p>This module will handle file IO. The problematic functions here are the
incoming <cite>.mat</cite> files that are produced by the GLImER database.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<dl class="py function">
<dt id="pyglimer.ccp.io.load_rawrf">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></code><code class="sig-name descname"><span class="pre">load_rawrf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/io.html#load_rawrf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_rawrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a matlab raw RF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename of the receiver function <code class="docutils literal notranslate"><span class="pre">.mat</span></code>-file to be loaded. The
<code class="docutils literal notranslate"><span class="pre">.mat</span></code>-file is expected to contain following parameters. See Notes
below for required content of matlab rawRf file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Set of RF variables</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rfs, baz, rayp, lat, lon, elev, dt</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>File content</p>
<dl class="field-list simple">
<dt class="field-odd">Crfs</dt>
<dd class="field-odd"><p>MxN matrix of M Receiver Functions and N elements</p>
</dd>
<dt class="field-even">Cbaz</dt>
<dd class="field-even"><p>M elements long vector with back azimuth values corresponding to
Receiver functions</p>
</dd>
<dt class="field-odd">Crayp</dt>
<dd class="field-odd"><p>M elements long vector with ray parameter values corresponding to
Receiver functions</p>
</dd>
<dt class="field-even">Cslat</dt>
<dd class="field-even"><p>M elements long vector with station latitude corresponding to
Receiver functions</p>
</dd>
<dt class="field-odd">Cslon</dt>
<dd class="field-odd"><p>M elements long vector with station longitude corresponding to
Receiver functions</p>
</dd>
<dt class="field-even">Celev</dt>
<dd class="field-even"><p>M elements long vector with station elevation</p>
</dd>
<dt class="field-odd">Dt</dt>
<dd class="field-odd"><p>sampling interval</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.io.load_tracefile">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></code><code class="sig-name descname"><span class="pre">load_tracefile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/io.html#load_tracefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_tracefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loading an RF file that has been raytraced.</p>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.io.load_velocity_model">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></code><code class="sig-name descname"><span class="pre">load_velocity_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/io.html#load_velocity_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_velocity_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads velocity model and outputs velocities and corresponding
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vlat, vlon, vdep, vp, vs</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.compute.bin">
<span id="pyglimer-ccp-compute-bin"></span><h2>pyglimer.ccp.compute.bin<a class="headerlink" href="#module-pyglimer.ccp.compute.bin" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)
Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Created: November 2019
Last Modified: Thursday, 19th August 2021 09:39:42 am</p>
<dl class="py class">
<dt id="pyglimer.ccp.compute.bin.BinGrid">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.compute.bin.</span></code><code class="sig-name descname"><span class="pre">BinGrid</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/compute/bin.html#BinGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates Bingrid object from parameters</p>
<p>BinGrid object that can be used to find closest neighbours to
stations and CCP bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.array</cite>) – Latitudes</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.array</cite>) – Longitudes</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Distance (in degree) between bin centres.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – consoel output?, defaults to True</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.compute_bins">
<code class="sig-name descname"><span class="pre">compute_bins</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/compute/bin.html#BinGrid.compute_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.compute_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bins close to all stations</p>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.query_bin_tree">
<code class="sig-name descname"><span class="pre">query_bin_tree</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_bin_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>binrad</strong> (<em>float</em>) – maximum  distance to be queried in euclidean distance
Equals the radius of the bin, higher = more averaging -&gt;
–&gt; less noise, lower resolution</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of neighbours to return. Note that this directly
depends on the ratio of deltabin/binrad.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.query_station_tree">
<code class="sig-name descname"><span class="pre">query_station_tree</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_station_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>maxdist</strong> (<em>float</em>) – maximum  distance to be queried in degree</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Euclidian distances to next point, indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple with 2 1D <cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyglimer.ccp.compute.bin.BinGrid.station_tree">
<code class="sig-name descname"><span class="pre">station_tree</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/compute/bin.html#BinGrid.station_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the input</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.plot_utils.plot_cross_section">
<span id="pyglimer-ccp-plot-utils-plot-cross-section"></span><h2>pyglimer.ccp.plot_utils.plot_cross_section<a class="headerlink" href="#module-pyglimer.ccp.plot_utils.plot_cross_section" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyglimer.ccp.plot_utils.plot_cross_section.get_ax_coor">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.plot_cross_section.</span></code><code class="sig-name descname"><span class="pre">get_ax_coor</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/plot_utils/plot_cross_section.html#get_ax_coor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.plot_cross_section.get_ax_coor" title="Permalink to this definition">¶</a></dt>
<dd><p>Just a way to get axes coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>axes</em>) – Givenn axes</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – Latitude</p></li>
<li><p><strong>lon</strong> (<em>float</em>) – Longitude</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Axes coordinates for a given set of lat, lon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.08.20 11.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.plot_cross_section.</span></code><code class="sig-name descname"><span class="pre">plot_cross_section</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ccp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geoax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">cartopy.mpl.geoaxes.GeoAxes</span><span class="p"><span class="pre">,</span> </span><span class="pre">cartopy.mpl.geoaxes.GeoAxesSubplot</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapplot</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minillum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfcmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'seismic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depthextent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapextent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/plot_utils/plot_cross_section.html#plot_cross_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a cross section for given waypoints. If no axes are given, the
function will also create figures for the map and the cross section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ccp</strong> (<a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><em>CCPStack</em></a>) – CCPStack as computed using the cpp module</p></li>
<li><p><strong>lat</strong> (<em>Arraylike</em>) – Latitudes of the waypoints defining the cross section</p></li>
<li><p><strong>lon</strong> (<em>Arraylike</em>) – Longitudes of the waypoints defining the cross section</p></li>
<li><p><strong>z0</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – if given the map will be plotted with an illumination map at the given
depth, by default None</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>Axes</em><em>]</em><em>, </em><em>optional</em>) – Axes to plot the cross section in, by default None</p></li>
<li><p><strong>geoax</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>GeoAxes</em><em>, </em><em>GeoAxesSubplot</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Axes to plot the waypoins in, by default None</p></li>
<li><p><strong>mapplot</strong> (<em>bool</em><em>, </em><em>optional</em>) – plot the map or not, by default True</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em>, </em><em>optional</em>) – minimum illumination count to not be grayed out, by default 50</p></li>
<li><p><strong>vmin</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – minimum value of the cross section, by default None</p></li>
<li><p><strong>vmax</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – maximum value of the cross section, by default None</p></li>
<li><p><strong>label</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – label to put in the corner of the cross section plot and the
cross section waypoints on the map, by default None</p></li>
<li><p><strong>rfcmap</strong> (<em>str</em><em>, </em><em>optional</em>) – cmap name for the plotting of the cross section, by default “seismic”</p></li>
<li><p><strong>depthextent</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>]</em><em>, </em><em>optional</em>) – List containing two entries defining min and max depth, by default None</p></li>
<li><p><strong>mapextent</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>]</em><em>, </em><em>optional</em>) – List of 4 entries defining [minlon,maxlon, minlat, maxlat],
by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ax, geoax</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.04.21 20.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.plot_utils.plot_line_buffer">
<span id="pyglimer-ccp-plot-utils-plot-line-buffer"></span><h2>pyglimer.ccp.plot_utils.plot_line_buffer<a class="headerlink" href="#module-pyglimer.ccp.plot_utils.plot_line_buffer" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyglimer.ccp.plot_utils.plot_line_buffer.plot_line_buffer">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.plot_line_buffer.</span></code><code class="sig-name descname"><span class="pre">plot_line_buffer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/plot_utils/plot_line_buffer.html#plot_line_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.plot_line_buffer.plot_line_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in lat, lon points and creates circular polygons around it. Merges
the polygons of possible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>np.ndarray</em>) – latitudes of a line</p></li>
<li><p><strong>lon</strong> (<em>np.ndarray</em>) – longitudes of a line</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – epicentral distance of the buffer, by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(patch, artist)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.04.21 20.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.plot_utils.line_buffer">
<span id="pyglimer-ccp-plot-utils-line-buffer"></span><h2>pyglimer.ccp.plot_utils.line_buffer<a class="headerlink" href="#module-pyglimer.ccp.plot_utils.line_buffer" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyglimer.ccp.plot_utils.line_buffer.line_buffer">
<code class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.line_buffer.</span></code><code class="sig-name descname"><span class="pre">line_buffer</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/ccp/plot_utils/line_buffer.html#line_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.line_buffer.line_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates buffer around geographical line using from pole rotated cap
outlines. This is far from perfect, but it does “a” job. There isn’t much
more that one can and be spherically accurate. As long as the amount of
points in the line is fair this should have no problem to immitate a true
buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>np.ndarray</em>) – latitudes</p></li>
<li><p><strong>lon</strong> (<em>np.ndarray</em>) – longitudes</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – epicentral distance to line, by default 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nx2 matrix with coordinates of a polygon that forms a buffer around
the line</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.04.21 20.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="utils.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">pyglimer.utils</p>
        </div>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, the PyGLImER development team.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>