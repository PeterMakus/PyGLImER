
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyglimer.rf</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/blank.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="pyglimer.database" href="database.html" />
    <link rel="prev" title="pyglimer.waveform" href="waveform.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../introduction/introduction.html">
  Introduction
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../introduction/installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../creation/index.html">
  Receiver Functions
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../receiver_functions/index.html">
  RF Handling
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../ccp/index.html">
  CCP
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../plotting/index.html">
  Plotting
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  API
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="http://www.stephanerondenay.com/glimer-web.html">GLImER<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PeterMakus/PyGLImER" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="waveform.html">
   pyglimer.waveform
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   pyglimer.rf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="database.html">
   pyglimer.database
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test.html">
   pyglimer.test
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="utils.html">
   pyglimer.utils
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ccp.html">
   pyglimer.ccp
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-rf-create">
   pyglimer.rf.create
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-pyglimer.rf.deconvolve">
   pyglimer.rf.deconvolve
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-rf-moveout">
   pyglimer.rf.moveout
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/PeterMakus/PyGLImER/edit/master/docs/chapters/api/rf.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="pyglimer-rf">
<h1>pyglimer.rf<a class="headerlink" href="#pyglimer-rf" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pyglimer-rf-create">
<h2>pyglimer.rf.create<a class="headerlink" href="#pyglimer-rf-create" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyglimer.rf.deconvolve">
<span id="pyglimer-rf-deconvolve"></span><h2>pyglimer.rf.deconvolve<a class="headerlink" href="#module-pyglimer.rf.deconvolve" title="Permalink to this headline">¶</a></h2>
<p>Various Deconvolution approaches used for the RF technique.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Wednesday, 16th October 2019 02:24:30 pm
Last Modified: Thursday, 21st October 2021 03:59:20 pm</p>
<dl class="py function">
<dt id="pyglimer.rf.deconvolve.damped">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">damped</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/rf/deconvolve.html#damped"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.damped" title="Permalink to this definition">¶</a></dt>
<dd><p>Outdated use function spectraldivision instead!
A simple damped deconvolution. I just used it to benchmark</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>Arraylike</em>) – denominator (t-domain)</p></li>
<li><p><strong>H</strong> (<em>Arraylike</em>) – enumerator (t-domain)</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – damping factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Inverted signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.it">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">it</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/rf/deconvolve.html#it"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.it" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterative deconvolution after Ligorria &amp; Ammon (1999)
Essentially, P will be deconvolved from H.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>1D np.ndarray</em>) – The source wavelet estimation / denominator.</p></li>
<li><p><strong>H</strong> (<em>1D np.ndarray</em>) – The enumerator (impulse response * source wavelet estimation).</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>shift</strong> (<em>float</em><em>, </em><em>optional</em>) – Time shift of main arrival [s]. The default is 0.</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width parameter. The default is 2.5.</p></li>
<li><p><strong>omega_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence control parameter (percentage improvement
per iteration). The default is 0.5.</p></li>
<li><p><strong>it_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximal number of iterations before the algorithm
interrupts, defaults to 400</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rf : The receiver function.
it : Number of iterations until algorithm converged.
IR : Estimation of the medium’s impulse response.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rf : np.ndarray
it : int
IR : np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.multitaper">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">multitaper</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regul</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/rf/deconvolve.html#multitaper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.multitaper" title="Permalink to this definition">¶</a></dt>
<dd><p>Output has to be filtered (Noise appears in high-frequency)!
multitaper: takes Ved-Kathrins code and changes inputs to
make it run like Helffrich algorithm, minus normalization and with
questionable calculation of pre-event noise (have to double check this
and compare it to the regular FFT based estimate without any tapers).</p>
<p>Findings: when P arrival is not in the center of the window, the
amplitudes are not unity at the beginning and decreasing from there on.
Instead they peak at the time shift which corresponds to the middle index
in the P time window.</p>
<p>TB  = time bandwidth product (usually between 2 and 4)
NT  = number of tapers to use, has to be &lt;= 2*TB-1
TB = 4; NT = 7; #choice of TB = 4, NT = 3 is supposed to be optimal
t0 = -5; t1 = max(time); # This defines the beginning and end of the lag
times for the receiver function</p>
<p>changed by KS June 2016, added coherence and variance estimate; output
RF in time domain (rf), RF in freq. domain (tmpp), and variance of RF
(var_rf); can be used as input for multitaper_weighting.m
the input “regul” defines which type of regularization is used,
regul=’fqd’ defines frequency dependent regularisation from pre-event
noise, regul=’con’ defines adding a constant value (here maximum of
pre-event noise) as regularisation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>np.ndarray</em>) – Source time function estimation.</p></li>
<li><p><strong>D</strong> (<em>np.ndarray</em>) – Component containing the converted wave.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, either ‘fqd’ for frequency dependentor ‘con’ for
constant.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For unknown input.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>rf</strong> (<em>np.ndarray</em>) – The receiver function.</p></li>
<li><p><strong>lrf</strong> (<em>np.ndarray</em>) – The source-time wavelet convolved by itself.</p></li>
<li><p><strong>var_rf</strong> (<em>np.ndarray</em>) – The receiver function’s variance.</p></li>
<li><p><strong>tmpp</strong> (<em>np.ndarray</em>) – Receiver function without variance weighting.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyglimer.rf.deconvolve.spectraldivision">
<code class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></code><code class="sig-name descname"><span class="pre">spectraldivision</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/pyglimer/rf/deconvolve.html#spectraldivision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.spectraldivision" title="Permalink to this definition">¶</a></dt>
<dd><p>Function spectraldivision(v,u,ndt,tshift,regul) is a standard spectral
division frequency domain deconvolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>1D np.ndarray</em>) – Source wavelet estimation (denominator).</p></li>
<li><p><strong>u</strong> (<em>1D np.ndarray</em>) – Impulse response convolved by v (enumerator).</p></li>
<li><p><strong>ndt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, can be chosen by the variable “regul”, this
can be ‘con’, ‘wat’, or ‘fqd’ for constant damping factor, waterlevel,
or frequency-dependent damping, respectively</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Phase either “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – for uknown regulisations</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>qrf : Receiver function.
lrf : Output of deoncolution of source wavelet estimation from
longitudinal component.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>1D np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="pyglimer-rf-moveout">
<h2>pyglimer.rf.moveout<a class="headerlink" href="#pyglimer-rf-moveout" title="Permalink to this headline">¶</a></h2>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="waveform.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">pyglimer.waveform</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="database.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">pyglimer.database</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, the PyGLImER development team.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>