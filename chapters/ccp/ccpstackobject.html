
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CCPStack objects</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles/pydata-sphinx-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Plotting" href="../plotting/index.html" />
    <link rel="prev" title="Common Conversion Point Stacking" href="intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../index.html">
  <img src="../../_static/logo_horizontal_colour.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../introduction/introduction.html">
  Introduction
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../introduction/installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../creation/index.html">
  Receiver Functions
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../receiver_functions/index.html">
  RF Handling
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  CCP
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../plotting/index.html">
  Plotting
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/index.html">
  API
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="http://www.stephanerondenay.com/glimer-web.html">GLImER<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/PeterMakus/PyGLImER" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Common Conversion Point Stacking
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   CCPStack objects
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ccp-bins">
   CCP bins
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#creating-a-ccp-stack-in-pyglimer">
   Creating a CCP stack in PyGLImER
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/PeterMakus/PyGLImER/edit/master/docs/chapters/ccp/ccpstackobject.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="ccpstack-objects">
<h1>CCPStack objects<a class="headerlink" href="#ccpstack-objects" title="Permalink to this headline">#</a></h1>
<p>In <strong>PyGLImER</strong>, the base class enabling CCP stacking is the
<a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPStack</span></code></a> class. However, to understand how
CCP-Stacking is implemented, we will have to have a small intermezzo about
binning.</p>
<div class="section" id="ccp-bins">
<h2>CCP bins<a class="headerlink" href="#ccp-bins" title="Permalink to this headline">#</a></h2>
<p>In <strong>PyGLImER</strong>, CCP bins are round in mapview (cylindric in
3D). If a piercing point of a receiver function is inside of a bin, it will be
added to this bin (i.e. there is one “station” stack in each bin). As such the
shape of a bingrid is controlled by two parameters: The bin’s radius R and the
interbin distance d.</p>
<p>The bin radius decides, whether a piercing point is close enough (smaller than
R) to be added to the bin. High bin radii result in strong spatial averaging,
which mitigates noise and can be helpful if the illumination is low, whereas
small radii have the potential of revealing small scale details.</p>
<p>Concerning the bin distance, we face a tradeoff between resolution and
computational efficiency. Dense grids will take significantly longer to compute
and to plot than coarse grids. However, finely gridded bingrids have a higher
resolution (much like pixels in a digital image). It should be mentioned though
that the resolution that can be reached this way is limited and depending on the
bin radius. In a way, higher bin radii introduce a blur to our image, which we
cannot remove by decreasing the bin distance (much like we can upscale our
digital image, but the resolving power will not increase). Therefore, PyGLImER
has a threshold for the bin radius.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The maximal bin radius allowed by PyGLImER equals 4 times the bin distance
(to limit computational expense). The minimal bin radius one should use is
cos(30deg)*bin distance. For lower values the bingrid will not cover the
whole surface area.</p>
</div>
</div>
<div class="section" id="creating-a-ccp-stack-in-pyglimer">
<h2>Creating a CCP stack in PyGLImER<a class="headerlink" href="#creating-a-ccp-stack-in-pyglimer" title="Permalink to this headline">#</a></h2>
<p>CCP stacks in PyGLImER are usually not created by initialising the
<a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPStack</span></code></a> class but by calling the
<a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a> function, which, itself, initialises the
aforementioned object.</p>
<p>Using <a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a>, there are two ways to create a
<a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPStack</span></code></a> object:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>By Creating a bingrid tailored to be used with data from predefined
networks and stations (i.e. onehas to know network and station codes for
the desired stack.</p></li>
<li><p>More commonly, one would like to create a CCP stack containing all
available data for a given area. In order to that,
<a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a> can be called
with the <code class="docutils literal notranslate"><span class="pre">geocoords</span></code> parameter. Then, PyGLImER will automatically find
all stations available in the given area and create a bingrid around
those data.</p></li>
</ol>
</div></blockquote>
<p><strong>Populating the CCP object</strong> is done by <a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a>
if called using the <code class="docutils literal notranslate"><span class="pre">compute_stack=True</span></code> argument (recommended), else one will
have to call <a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.CCPStack.compute_stack" title="pyglimer.ccp.ccp.CCPStack.compute_stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute_stack()</span></code></a>.</p>
<p><strong>Finalising the CCP object.</strong> Up to now data was only saved in the object and
we have not created an actual CCP stack, yet. We can do just that by calling
<a class="reference internal" href="../api/ccp.html#pyglimer.ccp.ccp.CCPStack.conclude_ccp" title="pyglimer.ccp.ccp.CCPStack.conclude_ccp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">conclude_ccp()</span></code></a>. Here, we can decide <strong>1.</strong>
if we want to keep empty bins <strong>2.</strong> what should be the threshold for a minimum
amount of data per bin <strong>3.</strong> Whether we want to discards bins that are on water
surfaces or keep them.</p>
<p><strong>Saving our CCP object.</strong> The standard format to save these objects is pickle
<cite>.pkl</cite>, which provides the fastest reading speed. However, if you want to
archive your data we recommend using the <strong>numpy npz</strong> format as older pickle
files can sometimes lead to compatibility issues after updating PyGLImER. For
compatibility with older plotting programs in Matlab (a legacy from GLImER), we
can also save our CCP object as <cite>.mat</cite>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>A ccp object saved as <cite>.mat</cite> will not save all data - only the finalised
stack!</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you want to store your CCP Stack for a longer period of time, we
recommend using the <em>npz</em> format to do so.</p>
</div>
</div>
</div>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Common Conversion Point Stacking</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../plotting/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Plotting</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, the PyGLImER development team.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.5.4.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>