
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PyGLImER API</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Plotting" href="plotting.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="download.html">
   Waveform Download, preprocessing, and receiver function creation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="receiver_function.html">
   Handling Receiver Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ccp.html">
   Common Conversion Point Stacking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plotting.html">
   Plotting
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   <code class="docutils literal notranslate">
    <span class="pre">
     PyGLImER
    </span>
   </code>
   API
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/chapters/API.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/lwsspy/lwsspy"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/lwsspy/lwsspy/issues/new?title=Issue%20on%20page%20%2Fchapters/API.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/lwsspy/lwsspy/edit/master/chapters/API.rst"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-waveform">
   pyglimer.waveform
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.waveform.request">
     pyglimer.waveform.request
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.waveform.download">
     pyglimer.waveform.download
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.waveform.preprocess">
     pyglimer.waveform.preprocess
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.waveform.preprocessh5">
     pyglimer.waveform.preprocessh5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.waveform.qc">
     pyglimer.waveform.qc
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.waveform.rotate">
     pyglimer.waveform.rotate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.waveform.errorhandler">
     pyglimer.waveform.errorhandler
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-rf">
   pyglimer.rf
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.rf.create">
     pyglimer.rf.create
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.rf.deconvolve">
     pyglimer.rf.deconvolve
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.rf.moveout">
     pyglimer.rf.moveout
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-database">
   pyglimer.database
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.database.stations">
     pyglimer.database.stations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.database.asdf">
     pyglimer.database.asdf
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.database.rfh5">
     pyglimer.database.rfh5
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-test">
   pyglimer.test
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.test.rate">
     pyglimer.test.rate
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.test.synthetic">
     pyglimer.test.synthetic
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.test.tests">
     pyglimer.test.tests
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-utils">
   pyglimer.utils
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.utils.create_geom">
     pyglimer.utils.create_geom
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.utils.createvmodel">
     pyglimer.utils.createvmodel
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.utils.geo_utils">
     pyglimer.utils.geo_utils
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.utils.nextpowof2">
     pyglimer.utils.nextpowof2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.utils.roundhalf">
     pyglimer.utils.roundhalf
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.utils.signalproc">
     pyglimer.utils.signalproc
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.utils.utils">
     pyglimer.utils.utils
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-ccp">
   pyglimer.ccp
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.ccp.ccp">
     pyglimer.ccp.ccp
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.ccp.io">
     pyglimer.ccp.io
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.ccp.compute.bin">
     pyglimer.ccp.compute.bin
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.ccp.plot_utils.plot_cross_section">
     pyglimer.ccp.plot_utils.plot_cross_section
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.ccp.plot_utils.plot_line_buffer">
     pyglimer.ccp.plot_utils.plot_line_buffer
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.ccp.plot_utils.line_buffer">
     pyglimer.ccp.plot_utils.line_buffer
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pyglimer-plot">
   pyglimer.plot
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.plot.plot_map">
     pyglimer.plot.plot_map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.plot.plot_utils">
     pyglimer.plot.plot_utils
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.plot.plot_volume">
     pyglimer.plot.plot_volume
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#module-pyglimer.plot.ui_utils">
     pyglimer.plot.ui_utils
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pyglimer-api">
<span id="api-label"></span><h1><code class="docutils literal notranslate"><span class="pre">PyGLImER</span></code> API<a class="headerlink" href="#pyglimer-api" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pyglimer-waveform">
<h2>pyglimer.waveform<a class="headerlink" href="#pyglimer-waveform" title="Permalink to this headline">¶</a></h2>
<p>Waveform download and preprocess</p>
<div class="section" id="module-pyglimer.waveform.request">
<span id="pyglimer-waveform-request"></span><h3>pyglimer.waveform.request<a class="headerlink" href="#module-pyglimer.waveform.request" title="Permalink to this headline">¶</a></h3>
<p>Contains the request class that is used to initialise the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Monday, 27th April 2020 10:55:03 pm
Last Modified: Monday, 13th September 2021 10:43:12 am</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.waveform.request.Request">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.request.</span></span><span class="sig-name descname"><span class="pre">Request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proj_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw_subdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepro_subdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf_subdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc_subdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evt_subdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_subdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deconmeth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'v'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minmag</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_coords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">waveform_client</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evtcat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">obspy.core.event.catalog.Catalog</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglvl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'hdf5'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>“Initialises the FDSN request for
the waveforms, the preprocessing of the waveforms, and the creation of
time domain receiver functions.</p>
<p>Create object that is used to start the receiver function
workflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proj_dir</strong> (<em>str</em>) – parental directory that all project files
will be saved in (as subfolders).</p></li>
<li><p><strong>raw_subdir</strong> (<em>str</em>) – Directory, in which to store the raw waveform data.</p></li>
<li><p><strong>prepro_subdir</strong> (<em>str</em>) – Directory, in which to store the preprocessed
waveform data (mseed). <strong>Irrelevant if format is hdf5</strong>.</p></li>
<li><p><strong>rf_subdir</strong> (<em>str</em>) – Directory, in which to store the receiver functions
in time domain (sac).</p></li>
<li><p><strong>statloc_subdir</strong> – Directory, in which to store the station
inventories (xml).</p></li>
<li><p><strong>evt_subdir</strong> (<em>str</em>) – Directory, in which to store the event catalogue.</p></li>
<li><p><strong>log_subdir</strong> – Directory that logs are stored in.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Arrival phase that is to be used as source phase.
“S” to create S-Sp receiver functions and “P” for P-Ps receiver
functions, “SKS” or “ScS” are allowed as well.</p></li>
<li><p><strong>rot</strong> (<em>str</em>) – The coordinate system in that the seismogram should be
rotated
prior to deconvolution. Options are “RTZ” for radial, transverse,
vertical; “LQT” for an orthogonal coordinate system computed by
minimising primary energy on the
converted component, or “PSS” for a rotation along the polarisation
directions using the Litho1.0 surface wave tomography model.</p></li>
<li><p><strong>deconmeth</strong> (<em>str</em>) – The deconvolution method to use for the RF creation.
Possible options are:
‘it’: iterative time domain deconvolution (Ligorria &amp; Ammon, 1999)
‘dampedf’: damped frequency deconvolution
‘fqd’: frequency dependent damping - not a good choice for SRF
‘waterlevel’: Langston (1977)
‘multit’: for multitaper (Helffrich, 2006)
False/None: don’t create RFs</p></li>
<li><p><strong>starttime</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.UTCDateTime</span></code> or str) – Earliest event date to be considered.</p></li>
<li><p><strong>endtime</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.UTCDateTime</span></code> or str) – Latest event date to be considered.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarisation to use as source wavelet. Either “v” for
vertically polarised or ‘h’ for horizontally polarised S-waves.
Will be ignored if phase=’S’, by default ‘v’.</p></li>
<li><p><strong>minmag</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum magnitude, by default 5.5</p></li>
<li><p><strong>event_coords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – In case you wish to constrain events to certain
origns. Given in the form (minlat, maxlat, minlon, maxlon),
by default None.</p></li>
<li><p><strong>network</strong> (<em>str</em><em>, </em><em>optional</em>) – Limit the dowloand and preprocessing to a certain
network.
Wildcards are allowed, by default None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em>, </em><em>optional</em>) – Limit the download and preprocessing to a certain
station or several stations. Use only if network!=None.
Wildcards are allowed, by default None.</p></li>
<li><p><strong>waveform_client</strong> (<em>list</em><em>, </em><em>optional</em>) – List of FDSN compatible servers to download
waveforms from.
See obspy documentation for obspy.Client for allowed acronyms.
A list of servers by region can be found at
<a class="reference external" href="https://www.fdsn.org/webservices/datacenters/">https://www.fdsn.org/webservices/datacenters/</a>. None means
that all known servers are requested, defaults to None.</p></li>
<li><p><strong>evtcat</strong> (<em>str</em><em>, </em><em>optional</em>) – In case you want to use an already existing event
catalogue
in evtloc. If None a new catalogue will be downloaded (with the
parameters defined before), by default None, defaults to None</p></li>
<li><p><strong>loglvl</strong> (<em>str</em><em>, </em><em>optional</em>) – Level for the loggers. One of the following:
CRITICAL, ERROR, WARNING, INFO,or DEBUG
If the level is DEBUG, joblib will fall back to using only
few cores and downloads will be retried,
by default WARNING.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NameError</strong> – For invalid phases.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.waveform.request.Request.download_eventcat">
<span class="sig-name descname"><span class="pre">download_eventcat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.download_eventcat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.download_eventcat" title="Permalink to this definition">¶</a></dt>
<dd><p>Download the event catalogue from IRIS DMC.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.waveform.request.Request.download_waveforms">
<span class="sig-name descname"><span class="pre">download_waveforms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.download_waveforms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.download_waveforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the download of waveforms and response files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Set True if you wish to log the output of the obspy MassDownloader.</p></li>
<li><p><strong>seealso::</strong> (<em>.</em>) – You should check whether the method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">download_waveforms_small</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">_db()</span></code> might be better suited for your needs.
Both methods offer unique advantages.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.waveform.request.Request.download_waveforms_small_db">
<span class="sig-name descname"><span class="pre">download_waveforms_small_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.download_waveforms_small_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.download_waveforms_small_db" title="Permalink to this definition">¶</a></dt>
<dd><p>A different method to download raw waveform data. This method will
be faster than
<a class="reference internal" href="#pyglimer.waveform.request.Request.download_waveforms" title="pyglimer.waveform.request.Request.download_waveforms"><code class="xref py py-meth docutils literal notranslate"><span class="pre">download_waveforms()</span></code></a> for
small databases (e.g., single networks or stations). Another
advantage of this method is that the attributes network and station
in <code class="xref py py-class docutils literal notranslate"><span class="pre">Request</span></code> can be lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>channel</strong> (<em>str</em>) – The channel you will want to download, accepts
unix style wildcards.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>You should check whether the method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">download_Waveforms()</span></code>
might be better suited for your needs. Both methods offer unique
advantages.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.waveform.request.Request.preprocess">
<span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'joblib'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc_filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/request.html#Request.preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.request.Request.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess an existing database. With parameters defined in self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hc_filt</strong> (<em>float</em><em> or </em><em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Highcut frequency to filter with right before deconvolution.
Recommended if time domain deconvolution is used. For spectral
division, filtering can still be done after deconvolution (i.e.
set in <a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="pyglimer.ccp.ccp.CCPStack.compute_stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_stack()</span></code></a>).
Value for PRFs should usually be lower than 2 Hz and for SRFs lower
than .4 Hz, by default None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.download">
<span id="pyglimer-waveform-download"></span><h3>pyglimer.waveform.download<a class="headerlink" href="#module-pyglimer.waveform.download" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tue May 26 2019 13:31:30
Last Modified: Monday, 13th September 2021 11:58:53 am</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.download.download_small_db">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></span><span class="sig-name descname"><span class="pre">download_small_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_epid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.taup.tau.TauPyModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_cat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.event.catalog.Catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clients</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveasdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#download_small_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.download_small_db" title="Permalink to this definition">¶</a></dt>
<dd><p>see corresponding method <code class="xref py py-meth docutils literal notranslate">&#160;&#160;&#160; <span class="pre">download_waveforms_small_db()</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.download.downloadwav">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></span><span class="sig-name descname"><span class="pre">downloadwav</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_epid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epid</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.taup.tau.TauPyModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_cat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.event.catalog.Catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clients</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveasdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_fh</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">logging.FileHandler</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglvl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#downloadwav"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.downloadwav" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Downloads the waveforms for all events in the catalogue</dt><dd><p>for a circular domain around the epicentre with defined epicentral
distances from Clients defined in clients. Also Station
xmls for corresponding stations are downloaded.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>string</em>) – Arrival phase to be used. P, S, SKS, or ScS.</p></li>
<li><p><strong>min_epid</strong> (<em>float</em>) – Minimal epicentral distance to be downloaded.</p></li>
<li><p><strong>max_epid</strong> (<em>float</em>) – Maxmimal epicentral distance to be downloaded.</p></li>
<li><p><strong>model</strong> (<em>obspy.taup.TauPyModel</em>) – 1D velocity model to calculate arrival.</p></li>
<li><p><strong>event_cat</strong> (<em>Obspy event catalog</em>) – Catalog containing all events, for which waveforms should be
downloaded.</p></li>
<li><p><strong>tz</strong> (<em>int</em>) – time window before first arrival to download (seconds)</p></li>
<li><p><strong>ta</strong> (<em>int</em>) – time window after first arrival to download (seconds)</p></li>
<li><p><strong>statloc</strong> (<em>string</em>) – Directory containing the station xmls.</p></li>
<li><p><strong>rawloc</strong> (<em>string</em>) – Directory containing the raw seismograms.</p></li>
<li><p><strong>clients</strong> (<em>list</em>) – List of FDSN servers. See obspy.Client documentation for acronyms.</p></li>
<li><p><strong>network</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Network restrictions. Only download from these networks, wildcards
allowed. The default is None.</p></li>
<li><p><strong>station</strong> (<em>string</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Only allowed if network != None. Station restrictions.
Only download from these stations, wildcards are allowed.
The default is None.</p></li>
<li><p><strong>saveasdf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save the dataset as Adaptable Seismic Data Format (asdf; recommended).
Else, one will be left with .mseeds.</p></li>
<li><p><strong>log_fh</strong> (<em>logging.FileHandler</em><em>, </em><em>optional</em>) – file handler to be used for the massdownloader logger.</p></li>
<li><p><strong>loglvl</strong> (<em>int</em><em>, </em><em>optional</em>) – Use this logging level.</p></li>
<li><p><strong>verbose</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Set True, when experiencing issues with download. Output of
obspy MassDownloader will be logged in download.log.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.download.get_mseed_storage">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></span><span class="sig-name descname"><span class="pre">get_mseed_storage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#get_mseed_storage"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.get_mseed_storage" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the files and checks if files are already downloaded</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.download.wav_in_asdf">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></span><span class="sig-name descname"><span class="pre">wav_in_asdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#wav_in_asdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.wav_in_asdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Is the waveform already in the asdf database?
Based on the assumption that the file is there if the event is there.
Has the advantage that files that are trimmed differently will not be down-
loaded again</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.download.wav_in_db">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.download.</span></span><span class="sig-name descname"><span class="pre">wav_in_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/download.html#wav_in_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.download.wav_in_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if waveform is already downloaded.</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.preprocess">
<span id="pyglimer-waveform-preprocess"></span><h3>pyglimer.waveform.preprocess<a class="headerlink" href="#module-pyglimer.waveform.preprocess" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 19th May 2019 8:59:40 pm
Last Modified: Monday, 13th September 2021 12:21:11 pm</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocess.SNRError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></span><span class="sig-name descname"><span class="pre">SNRError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#SNRError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.SNRError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when the SNR is too high</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocess.StreamLengthError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></span><span class="sig-name descname"><span class="pre">StreamLengthError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#StreamLengthError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.StreamLengthError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when stream has fewer than 3 components</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocess.preprocess">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></span><span class="sig-name descname"><span class="pre">preprocess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_perc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_cat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.event.catalog.Catalog</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.taup.tau.TauPyModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deconmeth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc_filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveasdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netrestr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statrestr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'joblib'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#preprocess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Preprocesses waveforms to create receiver functions</p>
<blockquote>
<div><p>1. Clips waveform to the right length
(tz before and ta after theorethical arrival.)
2. Demean &amp; Detrend
3. Tapering
4. Remove Instrument response, convert to velocity &amp;
simulate havard station.
5. Rotation to NEZ and, subsequently, to RTZ.
6. Compute SNR for highpass filtered waveforms
(highpass f defined in qc.lowco).
If SNR lower than in qc.SNR_criteria for all filters,
rejects waveform.
7. Write finished and filtered waveforms to folder
specified in qc.outputloc.
8. Write info file with shelf containing station,
event and waveform information.</p>
<p>Only starts after all waveforms of the event have been
downloaded by download.py.
(checked over the dynamic variables prepro_folder and tmp.folder)</p>
<p>Saves preprocessed waveform files.
Creates info file to save parameters.</p>
</div></blockquote>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>string</em>) – “P” or “S”</p></li>
<li><p><strong>rot</strong> (<em>string</em>) – Coordinate system to cast seismogram in before deconvolution.
Options are “RTZ”, “LQT”, or “PSS”.</p></li>
<li><p><strong>pol</strong> (<em>string</em>) – “h” for Sh or “v” for Sv, only for PRFs.</p></li>
<li><p><strong>taper_perc</strong> (<em>FLOAT</em>) – Percentage to be tapered in beginning and at the end of waveforms.</p></li>
<li><p><strong>taper_type</strong> (<em>STRING</em>) – Taper type (see obspy documentation stream.taper).</p></li>
<li><p><strong>event_cat</strong> (<em>event catalogue</em>) – catalogue containing all events of waveforms.</p></li>
<li><p><strong>model</strong> (<em>obspy.taup.TauPyModel</em>) – 1D velocity model to calculate arrival.</p></li>
<li><p><strong>tz</strong> (<em>int</em>) – time window before first arrival in seconds</p></li>
<li><p><strong>ta</strong> (<em>int</em>) – time window after first arrival in seconds</p></li>
<li><p><strong>logdir</strong> (<em>string</em><em>, </em><em>optional</em>) – Set the directory to where the download log is saved</p></li>
<li><p><strong>loglvl</strong> (<em>int</em><em>, </em><em>optional</em>) – Set logger to this level.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocess.write_info">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocess.</span></span><span class="sig-name descname"><span class="pre">write_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocess.html#write_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocess.write_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes information dictionary in shelve format in each of the station
folders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>str</em>) – Network Code.</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Station code.</p></li>
<li><p><strong>dictionary</strong> (<em>dict</em>) – Dictionary containing the information.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.preprocessh5">
<span id="pyglimer-waveform-preprocessh5"></span><h3>pyglimer.waveform.preprocessh5<a class="headerlink" href="#module-pyglimer.waveform.preprocessh5" title="Permalink to this headline">¶</a></h3>
<p>This is a newer version of preprocess.py meant to be used with pyasdf.
Now, we will have to work in a very different manner than for .mseed files
and process files station wise rather than event wise.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Thursday, 18th February 2021 02:26:03 pm
Last Modified: Monday, 4th October 2021 03:29:24 pm</p>
<dl class="py exception">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocessh5.SNRError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocessh5.</span></span><span class="sig-name descname"><span class="pre">SNRError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocessh5.html#SNRError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocessh5.SNRError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when the SNR is too high</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocessh5.StreamLengthError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocessh5.</span></span><span class="sig-name descname"><span class="pre">StreamLengthError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocessh5.html#StreamLengthError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocessh5.StreamLengthError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>raised when stream has fewer than 3 components</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocessh5.compute_toa">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocessh5.</span></span><span class="sig-name descname"><span class="pre">compute_toa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.event.event.Event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.taup.tau.TauPyModel</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">obspy.core.utcdatetime.UTCDateTime</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocessh5.html#compute_toa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocessh5.compute_toa" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute time of theoretical arrival for teleseismic events and a given
teleseismic phase at the provided station.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evt</strong> (<em>obspy.core.event.Event</em>) – Event to compute the arrival for.</p></li>
<li><p><strong>slat</strong> (<em>float</em>) – station latitude</p></li>
<li><p><strong>slon</strong> (<em>float</em>) – station longitude</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – The teleseismic phase to consider.</p></li>
<li><p><strong>model</strong> (<em>obspy.taup.TauPyModel</em>) – Taupymodel to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Tuple holding: [the time of theoretical arrival (UTC),
the apparent slowness in s/km, the ray parameter in s/deg,
the back azimuth, the distance between station and event in deg]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[UTCDateTime, float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.preprocessh5.preprocessh5">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.preprocessh5.</span></span><span class="sig-name descname"><span class="pre">preprocessh5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_perc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.taup.tau.TauPyModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deconmeth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hc_filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">netrestr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statrestr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">logging.Logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rflogger</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">logging.Logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/preprocessh5.html#preprocessh5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.preprocessh5.preprocessh5" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess files saved in hdf5 (pyasdf) format. Will save the computed
receiver functions in hdf5 format as well.</p>
<p>Processing is done via a multiprocessing backend (either joblb or mpi).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>str</em>) – The Teleseismic phase to consider</p></li>
<li><p><strong>rot</strong> (<em>str</em>) – The Coordinate system that the seismogram should be rotated to.</p></li>
<li><p><strong>pol</strong> (<em>str</em>) – Polarisationfor PRFs. Can be either ‘v’ or ‘h’ (vertical or
horizontal).</p></li>
<li><p><strong>taper_perc</strong> (<em>float</em>) – Percentage for the pre deconvolution taper.</p></li>
<li><p><strong>model</strong> (<em>obspy.taup.TauPyModel</em>) – TauPyModel to be used for travel time computations</p></li>
<li><p><strong>taper_type</strong> (<em>str</em>) – type of taper (see obspy)</p></li>
<li><p><strong>tz</strong> (<em>int</em>) – Length of time window before theoretical arrival (seconds)</p></li>
<li><p><strong>ta</strong> (<em>int</em>) – Length of time window after theoretical arrival (seconds)</p></li>
<li><p><strong>rawloc</strong> (<em>str</em>) – Directory, in which the raw data is saved.</p></li>
<li><p><strong>rfloc</strong> (<em>str</em>) – Directory to save the receiver functions in.</p></li>
<li><p><strong>deconmeth</strong> (<em>str</em>) – Deconvolution method to use.</p></li>
<li><p><strong>hc_filt</strong> (<em>float</em>) – Second High-Cut filter (optional, can be None or False)</p></li>
<li><p><strong>netrestr</strong> (<em>str</em>) – Network restrictions</p></li>
<li><p><strong>statrestr</strong> (<em>str</em>) – Station restrictions</p></li>
<li><p><strong>logger</strong> (<em>logging.Logger</em>) – Logger to use</p></li>
<li><p><strong>rflogger</strong> (<em>logging.Logger</em>) – [description]</p></li>
<li><p><strong>client</strong> (<em>str</em>) – Multiprocessing Backend to use</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – For uknowns multiprocessing backends.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.qc">
<span id="pyglimer-waveform-qc"></span><h3>pyglimer.waveform.qc<a class="headerlink" href="#module-pyglimer.waveform.qc" title="Permalink to this headline">¶</a></h3>
<p>Contains quality control for waveforms used for receiver function creation.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 10th April 2020 11:38:40 am
Last Modified: Friday, 20th August 2021 03:01:14 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.qc.qcp">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.qc.</span></span><span class="sig-name descname"><span class="pre">qcp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_f</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/qc.html#qcp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.qc.qcp" title="Permalink to this definition">¶</a></dt>
<dd><p>Quality control for the downloaded waveforms that are used to create
PRFS. Works with various filters and SNR criteria</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>'~obspy.Stream'</em>) – Input stream.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>sampling_f</strong> (<em>FLOAT</em>) – Sampling frequency (Hz).</p></li>
<li><p><strong>onset</strong> (<em>float</em>) – Onset in seconds after trace’s start.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>st</strong> (<em>‘~obspy.Stream’</em>) – Output stream. If stream was accepted, then this will contain the
filtered stream, filtered with the broadest accepted filter.</p></li>
<li><p><strong>crit</strong> (<em>BOOL</em>) – True if stream was accepted, false if it wasn’t.</p></li>
<li><p><strong>f</strong> (<em>FLOAT</em>) – Last used low-cut frequency. If crit=True, this will be the frequency
for which the stream was accepted.</p></li>
<li><p><strong>noisemat</strong> (<em>np.array</em>) – SNR values in form of a matrix. Rows represent the different filters
and columns the different criteria.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.qc.qcs">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.qc.</span></span><span class="sig-name descname"><span class="pre">qcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_f</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/qc.html#qcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.qc.qcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Quality control for waveforms that are used to produce SRF. In contrast
to the ones used for PRF this is a very rigid criterion and will reject
&gt;95% of the waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>'~obspy.Stream'</em>) – Input stream.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>sampling_f</strong> (<em>FLOAT</em>) – Sampling frequency (Hz).</p></li>
<li><p><strong>onset</strong> (<em>float</em>) – Onset in seconds after trace’s start.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>st</strong> (<em>‘~obspy.Stream’</em>) – Output stream. If stream was accepted, then this will contain the
filtered stream, filtered with the broadest accepted filter.</p></li>
<li><p><strong>crit</strong> (<em>BOOL</em>) – True if stream was accepted, false if it wasn’t.</p></li>
<li><p><strong>f</strong> (<em>FLOAT</em>) – Last used high-cut frequency. If crit=True, this will be the frequency
for which the stream was accepted.</p></li>
<li><p><strong>noisemat</strong> (<em>np.array</em>) – SNR values in form of a matrix. Rows represent the different filters
and columns the different criteria.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.rotate">
<span id="pyglimer-waveform-rotate"></span><h3>pyglimer.waveform.rotate<a class="headerlink" href="#module-pyglimer.waveform.rotate" title="Permalink to this headline">¶</a></h3>
<p>Contains functions to rotate a stream into different domains</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Saturday, 21st March 2020 07:26:03 pm
Last Modified: Tuesday, 25th May 2021 05:18:07 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.rotate.rotate_LQT">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.rotate.</span></span><span class="sig-name descname"><span class="pre">rotate_LQT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_LQT"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_LQT" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a stream given in RTZ to LQT using Singular Value Decomposition
Use rotate_LQT_min as it tends to deliver better results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input Stream in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “S” for Sp or “P” for Ps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>LQT</strong> (<em>obspy.Stream</em>) – Output Stream in LQT.</p></li>
<li><p><strong>QC</strong> (<em>FLOAT</em>) – Quality control criterion. Energy balance at first arrival for L and Q.
Should deviate from 1 as far as possible.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.rotate.rotate_LQT_min">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.rotate.</span></span><span class="sig-name descname"><span class="pre">rotate_LQT_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_LQT_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_LQT_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates stream to LQT by minimising the energy of the S-wave primary
arrival on the L component (SRF) or maximising the primary arrival
energy on L (PRF).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input stream in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>LQT</strong> (<em>obspy.Stream</em>) – Output stream in LQT.</p></li>
<li><p><strong>ia</strong> (<em>float</em>) – Computed incidence angle in degree. Can serve as QC criterion.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.rotate.rotate_PSV">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.rotate.</span></span><span class="sig-name descname"><span class="pre">rotate_PSV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statlat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rayp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/pyglimer/waveform/rotate.html#rotate_PSV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.rotate.rotate_PSV" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the incidence angle of an incoming ray with the weighted average
of the lithosphere’s P velocity with a velocity model compiled from
Litho1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statlat</strong> (<em>FLOAT</em>) – station latitude.</p></li>
<li><p><strong>statlon</strong> (<em>FLOAT</em>) – station longitude.</p></li>
<li><p><strong>rayp</strong> (<em>FLOAT</em>) – ray parameter / slownesss in s/m.</p></li>
<li><p><strong>st</strong> (<em>obspy.Stream</em>) – Input stream given in RTZ.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Primary phase, either P or S.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>avp</strong> (<em>FLOAT</em>) – Average P-wave velocity.</p></li>
<li><p><strong>avs</strong> (<em>FLOAT</em>) – Average S-wave velocity.</p></li>
<li><p><strong>PSvSh</strong> (<em>obspy.Stream</em>) – Stream in P-Sv-Sh.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.waveform.errorhandler">
<span id="pyglimer-waveform-errorhandler"></span><h3>pyglimer.waveform.errorhandler<a class="headerlink" href="#module-pyglimer.waveform.errorhandler" title="Permalink to this headline">¶</a></h3>
<p>Files contains all Errorhandler for the Glimer to obspy project</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Saturday, 21th March 2020 19:16:41
Last Modified: Thursday, 25th March 2021 04:02:16 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.errorhandler.NoMatchingResponseHandler">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.errorhandler.</span></span><span class="sig-name descname"><span class="pre">NoMatchingResponseHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#NoMatchingResponseHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.NoMatchingResponseHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Error handler for when the No matching response found error occurs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.errorhandler.redownload">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.errorhandler.</span></span><span class="sig-name descname"><span class="pre">redownload</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#redownload"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.redownload" title="Permalink to this definition">¶</a></dt>
<dd><p>Errorhandler that Redownloads the stream for the given input.
Used when the stream has less than three channels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.waveform.errorhandler.redownload_statxml">
<span class="sig-prename descclassname"><span class="pre">pyglimer.waveform.errorhandler.</span></span><span class="sig-name descname"><span class="pre">redownload_statxml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statfile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/waveform/errorhandler.html#redownload_statxml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.waveform.errorhandler.redownload_statxml" title="Permalink to this definition">¶</a></dt>
<dd><p>Errorhandler: Redownload station xml in case that it is not found.</p>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-rf">
<h2>pyglimer.rf<a class="headerlink" href="#pyglimer-rf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.rf.create">
<span id="pyglimer-rf-create"></span><h3>pyglimer.rf.create<a class="headerlink" href="#module-pyglimer.rf.create" title="Permalink to this headline">¶</a></h3>
<p>A toolset to create RFs and RF classes</p>
<p>Database management and overview for the PyGLImER database.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 12th February 2020 03:24:30 pm
Last Modified: Monday, 27th September 2021 03:42:20 pm</p>
<p>!The file is split and has a second copyright disclaimer!
Some parts of this code are modified versions of the rf module by
Tom Eulenfeld.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></span><span class="sig-name descname"><span class="pre">RFStream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.stream.Stream</span></code></p>
<p>Class providing the necessary functions for receiver function calculation.
:param traces: list of traces, single trace or stream object
To initialize a RFStream from a Stream object use
&gt;&gt;&gt; rfstream = RFStream(stream)
To initialize a RFStream from a file use
&gt;&gt;&gt; rfstream = read_rf(‘test.SAC’)
Format specific headers are loaded into the stats object of all traces.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.bootstrap">
<span class="sig-name descname"><span class="pre">bootstrap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmodel_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'iasp91.dat'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.bootstrap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Monte Carlo Case resampling algorithm that creates b numbers of
replacement resampled stacks of the moveout corrected receiver
function.</p>
<p>The returned list can be used to compute statistical measures like
standard deviation, standard error, median, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iterations that the algorithm is supposed to
perform, defaults to 1000.</p></li>
<li><p><strong>vmodel_file</strong> (<em>str</em>) – The velocity model to use for the depth migration.
Defaults to ‘iasp91.dat’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of the bootstraped stacks.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.dirty_ccp_stack">
<span class="sig-name descname"><span class="pre">dirty_ccp_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_res</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-</span> <span class="pre">180.0,</span> <span class="pre">180.0,</span> <span class="pre">-</span> <span class="pre">90.0,</span> <span class="pre">90.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">750</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmodel_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iasp91.dat'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.dirty_ccp_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.dirty_ccp_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the simplest way of creating quick not really accurate
CCP stacks.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are some things that the user should be aware of. The bins
right at the poles may or may not have very different areas
compared to the other bins, which is a side effect of the iterative
computation of bin area correction. I have an idea on how to fix
it, but it is not really necessary right now. If you are working
with stations at the pole, and you want to CCP stack, I’d strongly
advise against using this function anyways. The bins are just
too narrow. This really is just a ‘dirty’ CCP stack and should only
be used as a first order check if thing are ok.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dlon</strong> (<em>float</em><em>, </em><em>optional</em>) – stetp size in longitude, by default 1.0</p></li>
<li><p><strong>z_res</strong> (<em>float</em><em>, </em><em>optional</em>) – depth resolution, by default 1.0</p></li>
<li><p><strong>extent</strong> (<em>list</em><em>, </em><em>optional</em>) – list of bounds [minlon, maxlon, minlat, maxlat],
by default [-180.0, 180.0, -90.0, 90.0]</p></li>
<li><p><strong>maxz</strong> (<em>int</em><em>, </em><em>optional</em>) – maxz, by default 750</p></li>
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – velocity model file. IASP91 1-D model used as standard  since
the assumption of rectangular bins is already a bit rough,
by default ‘iasp91.dat’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>containing, vectors outlining the mesh illumination etc.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.method">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">method</span></span><a class="headerlink" href="#pyglimer.rf.create.RFStream.method" title="Permalink to this definition">¶</a></dt>
<dd><p>Property for used rf method, ‘P’ or ‘S’</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.moveout">
<span class="sig-name descname"><span class="pre">moveout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.moveout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration of all receiver functions given Stream.
Also calculates piercing points and adds them to RFTrace.stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel</strong> (<em>str</em>) – Velocity model located in /data/vmodel.
Standard options are iasp91.dat and 3D (GYPSuM).</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Appends two multiple mode RFs to the returned
RFStream.
False by default.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
<li><p><strong>taper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the last 10km of the RF will be tapered, which
avoids jumps in station stacks. Should be False for CCP stacks,
defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1D np.ndarray containing depths and an
object of type depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.ndarray, <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'PRF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epilimits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalingfactor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a receiver function section as a function
of epicentral distance or single plot if len(RFStream)==1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – y axis time limits in seconds (if self.stats.type==time)
or depth in km (if self.stats==depth) (len(list)==2).
If <cite>None</cite> full traces is plotted.
Default None.</p></li>
<li><p><strong>epilimits</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None = None</em><em>,</em>) – y axis time limits in seconds (len(list)==2).
If <cite>None</cite> from 30 to 90 degrees plotted.
Default None.</p></li>
<li><p><strong>scalingfactor</strong> (<em>float</em>) – sets the scale for the traces. Could be automated in
future functions(Something like mean distance between
traces)
Defaults to 2.0</p></li>
<li><p><strong>line</strong> (<em>bool</em>) – plots black line of the actual RF
Defaults to True</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – sets linewidth of individual traces</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>, optional) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – If True, clears out all axes and plots RF only.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>matplotlib.pyplot.Axes</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.plot_distribution">
<span class="sig-name descname"><span class="pre">plot_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.plot_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.plot_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot back azimuth and rayparameter distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nbins</strong> (<em>int</em>) – Number of bins. Default</p></li>
<li><p><strong>v</strong> (<em>float</em>) – assummed surface velocity for the computation of the
incidence angle. Default 5.8 km/s.</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to savefile. If None plot is not saved just shown.
Defaults to None.</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – outputfile format</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – only used if file format is none vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.ppoint">
<span class="sig-name descname"><span class="pre">ppoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iasp91.dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.ppoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates piercing points for all receiver functions in given
RFStream and adds them to self.stats in form of lat, lon and depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – velocity model located in /data/vmodel.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.slice2">
<span class="sig-name descname"><span class="pre">slice2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reftime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_empty_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.slice2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.slice2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative slice method accepting relative times.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">slice()</span></code> and <cite>trim2()</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.station_stack">
<span class="sig-name descname"><span class="pre">station_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iasp91.dat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.station_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.station_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a moveout correction and stacks all receiver functions
in Stream. Make sure that Stream only contains RF from one station!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – 1D velocity model in data/vmodels.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Should RFs for multiples be calculated? If yes,
the parameter has to be a string, providing the stacking mode;
i.e. ‘linear’, ‘zk’ for a Zhu &amp; Kanamori approach, or ‘pws’ for
a phase-weighted stacking.
False by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>z : Depth Vector.
stack : Object containing station stack.
RF_mo : Object containing depth migrated traces.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>z : 1D np.ndarray
stack : <a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a>
RF_mo : <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.trim2">
<span class="sig-name descname"><span class="pre">trim2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">endtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reftime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.trim2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.trim2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternative trim method accepting relative times.
See <code class="xref py py-meth docutils literal notranslate"><span class="pre">trim()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>starttime</strong> (<em>UTCDateTime</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – starttime as UTC or seconds relative to reftime</p></li>
<li><p><strong>endtime</strong> (<em>UTCDateTime</em><em> or </em><em>float</em><em>, </em><em>optional</em>) – endtime as UTC or seconds relative to reftime</p></li>
<li><p><strong>reftime</strong> (<em>UTCDateTime</em><em>, </em><em>optional</em>) – reference time, can be an UTCDateTime object or a
string. The string will be looked up in the stats dictionary
(e.g. ‘starttime’, ‘endtime’, ‘onset’).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.type">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">type</span></span><a class="headerlink" href="#pyglimer.rf.create.RFStream.type" title="Permalink to this definition">¶</a></dt>
<dd><p>Property for the type of stream, ‘rf’, ‘profile’ or None</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFStream.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFStream.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFStream.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Save stream to file including format specific headers.
See <cite>Stream.write() &lt;obspy.core.stream.Stream.write&gt;</cite> in ObsPy.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFTrace">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></span><span class="sig-name descname"><span class="pre">RFTrace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">obspy.core.trace.Trace</span></code></p>
<p>Class providing the Trace object for receiver function calculation.</p>
<p>This object is a modified version of Tom Eulenfeld’s rf project’s RFStream
class. License below.</p>
<p>The MIT License (MIT)</p>
<p>Copyright (c) 2013-2019 Tom Eulenfeld</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the “Software”),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFTrace.moveout">
<span class="sig-name descname"><span class="pre">moveout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.moveout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration of the receiver function.
Also calculates piercing points and adds them to RFTrace.stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel</strong> (<em>str</em>) – Velocity model located in /data/vmodel.
Standard options are iasp91.dat and 3D (GYPSuM).</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> , </em><em>optional</em>) – Should RFs from multiples be computed and returned?
False by default.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
<li><p><strong>taper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the last 10km of the RF will be tapered, which
avoids jumps in station stacks. Should be False for CCP stacks,
defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1D np.ndarray containing depths and an
RFTrace object of type depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.ndarray, <a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFTrace.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a single receiver function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lim</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – x axis time limits in seconds or km (depth) (len(list)==2).
If <cite>None</cite> full trace is plotted.
Default None.</p></li>
<li><p><strong>depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 1D array of depths</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>, optional) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – If True, clears out all axes and plots RF only.
Defaults to False.</p></li>
<li><p><strong>std</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – <strong>Only if self.type == stastack</strong>. Plots the upper and lower
limit of the standard deviation in the plot. Provide the std
as a numpy array (can be easily computed from the output of
<a class="reference internal" href="#pyglimer.rf.create.RFStream.bootstrap" title="pyglimer.rf.create.RFStream.bootstrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bootstrap()</span></code></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>matplotlib.pyplot.Axes</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFTrace.ppoint">
<span class="sig-name descname"><span class="pre">ppoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.ppoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates piercing points for receiver function in and adds them
to self.stats in form of lat, lon and depth.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vmodel_file</strong> (<em>str</em><em>, </em><em>optional</em>) – velocity model located in /data/vmodel.
The default is ‘iasp91.dat’.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT, defaults to None.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em><em>, </em><em>optional.</em>) – Tuple in Form (minlon, maxlon), defaults to None</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.rf.create.RFTrace.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#RFTrace.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.RFTrace.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Save current trace into a file  including format specific headers.
See <cite>Trace.write() &lt;obspy.core.trace.Trace.write&gt;</cite> in ObsPy.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.create.createRF">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></span><span class="sig-name descname"><span class="pre">createRF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st_in</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'v'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">obspy.core.utcdatetime.UTCDateTime</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'it'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#createRF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.createRF" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a receiver function with the defined method from an obspy
stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st_in</strong> (<em>Stream</em>) – Stream of which components are to be deconvolved.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S”.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Polarisation to be deconvolved from. Only for phase = P,
defaults to ‘v’</p></li>
<li><p><strong>onset</strong> (<em>UTCDateTime</em><em>, </em><em>optional</em>) – Is used to shift function rather than shift if provided.
If info is provided, it will be extracted from info file,
defaults to None</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Deconvolution method, “waterlevel”, ‘dampedf’ for constant
damping level, ‘it’ for iterative time domain deconvoltuion, ‘multit’
for multitaper or ‘fqd’ for frequency dependently damped spectral
division. The default is iterative time domain (‘it’).</p></li>
<li><p><strong>trim</strong> (<em>tuple</em><em>, </em><em>optional</em>) – taper/truncate. Given as tuple (a, b) in s - left,right.
The default is None.</p></li>
<li><p><strong>event</strong> (<em>event</em><em>, </em><em>optional</em>) – Event File used to extract additional information about
arrival. Provide either event and station or info dict. The default is
None.</p></li>
<li><p><strong>station</strong> (<em>'~obspy.core.station'</em><em>, </em><em>optional</em>) – Dictionary containing station information,
defaults to None</p></li>
<li><p><strong>info</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing information about the waveform, used to
extract additional information for header. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – If deconvolution method is unknown.</p></li>
<li><p><strong>Exception</strong> – For wrong trim input.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>RFTrace object containing receiver function.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.create.obj2stats">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></span><span class="sig-name descname"><span class="pre">obj2stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#obj2stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.obj2stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Map event and station object to stats with attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code>, optional) – Event File. The default is None.</p></li>
<li><p><strong>station</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Station</span></code>, optional) – Station file with attributes lat, lon, and elevation.
The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stats object with station and event attributes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AttribDict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.create.read_by_station">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></span><span class="sig-name descname"><span class="pre">read_by_station</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#read_by_station"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.read_by_station" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method to read all available receiver functions of one station
and a particular phase into one single stream. Subsequently, one could
for instance do a station stack by using
<a class="reference internal" href="#pyglimer.rf.create.RFStream.station_stack" title="pyglimer.rf.create.RFStream.station_stack"><code class="xref py py-func docutils literal notranslate"><span class="pre">station_stack()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>str</em>) – Network shortcut, two digits, e.g. “IU”.</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Station shortcut, three digits, e.g. “HRV”</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Primary phase (“S” or “P”)</p></li>
<li><p><strong>rfdir</strong> (<em>str</em>) – Parental directory, in that the RF database is located</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RFStream object containing all receiver function of station x.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.create.read_rf">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></span><span class="sig-name descname"><span class="pre">read_rf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pathname_or_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#read_rf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.read_rf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read waveform files into RFStream object.
See <code class="xref py py-func docutils literal notranslate"><span class="pre">read()</span></code> in ObsPy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pathname_or_url</strong> (<em>str</em>) – Path to file.</p></li>
<li><p><strong>format</strong> (<em>e.g. &quot;MSEED&quot;</em><em> or </em><em>&quot;SAC&quot;. Will attempt to determine from ending
if = None. The default is None.</em>) – str, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RFStream object from file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.create.rfstats">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.create.</span></span><span class="sig-name descname"><span class="pre">rfstats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starttime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tt_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'IASP91'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/create.html#rfstats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.create.rfstats" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a stats object for a RFTrace object. Provide an info dic and
starttime or event and station object. Latter will take longer since
computations are redone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S” for main phase.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Dictionary containing information about waveform. Can be None
if event and station are provided. Has to be given in combination with
starttime, defaults to None.</p></li>
<li><p><strong>starttime</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">UTCDateTime</span></code>, optional) – Starttime of first trace in stream, used as identifier in
info dict. The default is None.</p></li>
<li><p><strong>event</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Event</span></code>, optional) – Event file, provide together with station file if info=None.
The default is None.</p></li>
<li><p><strong>station</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Station</span></code>, optional) – Station inventory with attributes lat, lon, and elevation,
defaults to None</p></li>
<li><p><strong>tt_model</strong> (<em>str</em><em>, </em><em>optional</em>) – TauPy model to calculate arrival, only used if no info
file is given. The default is “IASP91”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For unavailable phases</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Stats file for a RFTrace object with event and station
attributes, distance, back_azimuth, onset and
ray parameter.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AttribDict</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.rf.deconvolve">
<span id="pyglimer-rf-deconvolve"></span><h3>pyglimer.rf.deconvolve<a class="headerlink" href="#module-pyglimer.rf.deconvolve" title="Permalink to this headline">¶</a></h3>
<p>Various Deconvolution approaches used for the RF technique.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Wednesday, 16th October 2019 02:24:30 pm
Last Modified: Monday, 13th September 2021 04:31:00 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.deconvolve.damped">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></span><span class="sig-name descname"><span class="pre">damped</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#damped"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.damped" title="Permalink to this definition">¶</a></dt>
<dd><p>Outdated use function spectraldivision instead!
A simple damped deconvolution. I just used it to benchmark</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>Arraylike</em>) – denominator (t-domain)</p></li>
<li><p><strong>H</strong> (<em>Arraylike</em>) – enumerator (t-domain)</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – damping factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Inverted signal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.deconvolve.it">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></span><span class="sig-name descname"><span class="pre">it</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#it"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.it" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterative deconvolution after Ligorria &amp; Ammon (1999)
Essentially, P will be deconvolved from H.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>1D np.ndarray</em>) – The source wavelet estimation / denominator.</p></li>
<li><p><strong>H</strong> (<em>1D np.ndarray</em>) – The enumerator (impulse response * source wavelet estimation).</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>shift</strong> (<em>float</em><em>, </em><em>optional</em>) – Time shift of main arrival [s]. The default is 0.</p></li>
<li><p><strong>width</strong> (<em>float</em><em>, </em><em>optional</em>) – Gaussian width parameter. The default is 2.5.</p></li>
<li><p><strong>omega_min</strong> (<em>float</em><em>, </em><em>optional</em>) – Convergence control parameter (percentage improvement
per iteration). The default is 0.5.</p></li>
<li><p><strong>it_max</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximal number of iterations before the algorithm
interrupts, defaults to 400</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rf : The receiver function.
it : Number of iterations until algorithm converged.
IR : Estimation of the medium’s impulse response.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rf : np.ndarray
it : int
IR : np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.deconvolve.multitaper">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></span><span class="sig-name descname"><span class="pre">multitaper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regul</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#multitaper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.multitaper" title="Permalink to this definition">¶</a></dt>
<dd><p>Output has to be filtered (Noise appears in high-frequency)!
multitaper: takes Ved-Kathrins code and changes inputs to
make it run like Helffrich algorithm, minus normalization and with
questionable calculation of pre-event noise (have to double check this
and compare it to the regular FFT based estimate without any tapers).</p>
<p>Findings: when P arrival is not in the center of the window, the
amplitudes are not unity at the beginning and decreasing from there on.
Instead they peak at the time shift which corresponds to the middle index
in the P time window.</p>
<p>TB  = time bandwidth product (usually between 2 and 4)
NT  = number of tapers to use, has to be &lt;= 2*TB-1
TB = 4; NT = 7; #choice of TB = 4, NT = 3 is supposed to be optimal
t0 = -5; t1 = max(time); # This defines the beginning and end of the lag
times for the receiver function</p>
<p>changed by KS June 2016, added coherence and variance estimate; output
RF in time domain (rf), RF in freq. domain (tmpp), and variance of RF
(var_rf); can be used as input for multitaper_weighting.m
the input “regul” defines which type of regularization is used,
regul=’fqd’ defines frequency dependent regularisation from pre-event
noise, regul=’con’ defines adding a constant value (here maximum of
pre-event noise) as regularisation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>np.ndarray</em>) – Source time function estimation.</p></li>
<li><p><strong>D</strong> (<em>np.ndarray</em>) – Component containing the converted wave.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, either ‘fqd’ for frequency dependentor ‘con’ for
constant.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For unknown input.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>rf</strong> (<em>np.ndarray</em>) – The receiver function.</p></li>
<li><p><strong>lrf</strong> (<em>np.ndarray</em>) – The source-time wavelet convolved by itself.</p></li>
<li><p><strong>var_rf</strong> (<em>np.ndarray</em>) – The receiver function’s variance.</p></li>
<li><p><strong>tmpp</strong> (<em>np.ndarray</em>) – Receiver function without variance weighting.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.deconvolve.spectraldivision">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.deconvolve.</span></span><span class="sig-name descname"><span class="pre">spectraldivision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/deconvolve.html#spectraldivision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.deconvolve.spectraldivision" title="Permalink to this definition">¶</a></dt>
<dd><p>Function spectraldivision(v,u,ndt,tshift,regul) is a standard spectral
division frequency domain deconvolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>1D np.ndarray</em>) – Source wavelet estimation (denominator).</p></li>
<li><p><strong>u</strong> (<em>1D np.ndarray</em>) – Impulse response convolved by v (enumerator).</p></li>
<li><p><strong>ndt</strong> (<em>float</em>) – Sampling interval [s].</p></li>
<li><p><strong>tshift</strong> (<em>float</em>) – Time shift of primary arrival [s].</p></li>
<li><p><strong>regul</strong> (<em>str</em>) – Regularization, can be chosen by the variable “regul”, this
can be ‘con’, ‘wat’, or ‘fqd’ for constant damping factor, waterlevel,
or frequency-dependent damping, respectively</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Phase either “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – for uknown regulisations</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>qrf : Receiver function.
lrf : Output of deoncolution of source wavelet estimation from
longitudinal component.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>1D np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.rf.moveout">
<span id="pyglimer-rf-moveout"></span><h3>pyglimer.rf.moveout<a class="headerlink" href="#module-pyglimer.rf.moveout" title="Permalink to this headline">¶</a></h3>
<p>Contains functions for moveout correction and station stacking.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>!The file is split and has a second copyright disclaimer!</p>
<p>Created: Tuesday, 7th April 2020 10:08:30 am
Last Modified: Thursday, 25th March 2021 03:51:18 pm</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.rf.moveout.SimpleModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></span><span class="sig-name descname"><span class="pre">SimpleModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#SimpleModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.SimpleModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple 1D velocity model for move out and piercing point calculation.
Calculated with Earth flattening algorithm as described by P. M. Shearer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> – depths in km</p></li>
<li><p><strong>vp</strong> – P wave velocities at provided depths in km/s</p></li>
<li><p><strong>vs</strong> – S wave velocities at provided depths in km/s</p></li>
<li><p><strong>n</strong> – number of support points between provided depths</p></li>
</ul>
</dd>
</dl>
<p>All arguments can be of type numpy.ndarray or list.
taken from the RF module based on obspy by Tom Eulenfeld</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.moveout.dt_table">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></span><span class="sig-name descname"><span class="pre">dt_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#dt_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.dt_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a phase delay table and calculates piercing points
for a specific ray parameter,
using the equation as in Rondenay 2009.
For SRF: The length of the output vectors is determined by the depth, at
which Sp conversion is supercritical (vertical slowness = complex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>float</em>) – ray-parameter given in s/deg.</p></li>
<li><p><strong>fname</strong> (<em>string</em>) – 1D velocity model, located in data/vmodels.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” for Sp or “P” for Ps.</p></li>
<li><p><strong>el</strong> (<em>float</em>) – station elevation in m.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em>) – Compute conversion time for PPS and PSS.</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, A Cartesioan rather than a spherical Earth is assumed. By
default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>htab</strong> (<em>np.array</em>) – Vector containing conversion depths.</p></li>
<li><p><strong>dt</strong> (<em>np.array</em>) – Vector containing delay times between primary arrival and converted
wave.</p></li>
<li><p><strong>delta</strong> (<em>np.array</em>) – Vector containing angular distance of piercing point from the
station at depth z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.moveout.dt_table_3D">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></span><span class="sig-name descname"><span class="pre">dt_table_3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#dt_table_3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.dt_table_3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a phase delay table and calculates piercing points
for a specific ray parameter,
using the equation as in Rondenay 2009.
For SRF: The length of the output vectors is determined by the depth, at
which Sp conversion is supercritical (vertical slowness = complex).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>float</em>) – ray-parameter given in s/deg.</p></li>
<li><p><strong>fname</strong> (<em>string</em>) – 1D velocity model, located in data/vmodels.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” for Sp or “P” for Ps.</p></li>
<li><p><strong>el</strong> (<em>float</em>) – station elevation in m.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D raytraycing.
Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em>) – Tuple in Form (minlon, maxlon)</p></li>
<li><p><strong>test</strong> (<em>Bool</em>) – If True, the raysum 3D model is loaded.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>htab</strong> (<em>np.array</em>) – Vector containing conversion depths.</p></li>
<li><p><strong>dt</strong> (<em>np.array</em>) – Vector containing delay times between primary arrival and converted
wave.</p></li>
<li><p><strong>delta</strong> (<em>np.array</em>) – Vector containing Euclidian distance of piercing point from the
station at depth z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.moveout.earth_flattening">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></span><span class="sig-name descname"><span class="pre">earth_flattening</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maxz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#earth_flattening"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.earth_flattening" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a flat-earth approximated velocity model down to maxz as in
Peter M. Shearer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maxz</strong> (<em>int</em>) – Maximal intepolation depth [km]. Given at beginning of file.</p></li>
<li><p><strong>z</strong> (<em>np.array</em>) – Depth vector [km].</p></li>
<li><p><strong>dz</strong> (<em>np.array</em>) – Layer thicknesses in km.</p></li>
<li><p><strong>vp</strong> (<em>np.array</em>) – P wave velocities [km/s].</p></li>
<li><p><strong>vs</strong> (<em>np.array</em>) – S wave velocities [km/s].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em>) – Same as input, but shortened to maxz.</p></li>
<li><p><strong>dz</strong> (<em>np.array</em>) – Same as input, but shortened to maxz.</p></li>
<li><p><strong>zf</strong> (<em>np.array</em>) – Depths in a Cartesian coordinate system.</p></li>
<li><p><strong>dzf</strong> (<em>np.array</em>) – Layer thicknesse in a Cartesian coordinate system.</p></li>
<li><p><strong>vpf</strong> (<em>np.array</em>) – P wave velocities in a Cartesian coordinate system.</p></li>
<li><p><strong>vsf</strong> (<em>np.array</em>) – S wave velocities in a Cartesian coordinate system.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.moveout.load_model">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'iasp91.dat'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load 1D velocity model from file.
The model file should have 4 columns with depth, vp, vs, n.
The model file for iasp91 starts like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#IASP91 velocity model</span>
<span class="c1">#depth  vp    vs   n</span>
  <span class="mf">0.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">0</span>
  <span class="mf">0.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">0</span>
<span class="mf">10.00</span>  <span class="mf">5.800</span> <span class="mf">3.360</span> <span class="mi">4</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<em>string</em><em>, </em><em>optional</em>) – filename of model in data or ‘iasp91’.
The default is ‘iasp91.dat’.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns SimpleModel instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.rf.moveout.SimpleModel" title="pyglimer.rf.moveout.SimpleModel">SimpleModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.moveout.moveout">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></span><span class="sig-name descname"><span class="pre">moveout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.trace.Stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#moveout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.moveout" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth migration for RF.
Corrects the for the moveout of a converted phase. Flips time axis
and polarity of SRF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em>) – Receiver Function.</p></li>
<li><p><strong>st</strong> (<em>obspy.core.trace.Stats</em>) – Stream stats</p></li>
<li><p><strong>fname</strong> (<em>str</em>) – 1D velocity model for moveout correction.
Use ‘3D’ for a 3D raytracing.</p></li>
<li><p><strong>latb</strong> (<em>tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D raytraycing.
Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>tuple</em>) – Tuple in Form (minlon, maxlon)</p></li>
<li><p><strong>taper</strong> (<em>bool</em>) – If True, the last 10km of the RF will be tapered,
which avoids jumps in station stacks. If False, the upper 5 km will be
tapered. Should be False for CCP stacks.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Either False (don’t include multiples), ‘linear’ for
linear stack, ‘PWS’ (phase weighted stack or “zk” for a zhu &amp;
kanamori approach). False by default., by default False</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>z2</strong> (<em>Arraylike</em>) – Depth vector in km.</p></li>
<li><p><strong>RF2</strong> (<em>Arraylike</em>) – Vector containing the depth migrated RF.</p></li>
<li><p><strong>delta</strong> (<em>Arraylike</em>) – Vector containing Euclidian distance of piercing point from the
station at depth z.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.rf.moveout.ppoint">
<span class="sig-prename descclassname"><span class="pre">pyglimer.rf.moveout.</span></span><span class="sig-name descname"><span class="pre">ppoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_a</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_b</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/rf/moveout.html#ppoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.rf.moveout.ppoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spherical distance between piercing point and station.
INPUT has to be in Cartesian/ flat Earth:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_a</strong> (<em>float</em>) – Vertical P-wave slowness in s/km.</p></li>
<li><p><strong>q_b</strong> (<em>float</em>) – Vertical S-wave slowness in s/km.</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – Vertical distance between two consecutive piercing points [km].</p></li>
<li><p><strong>p</strong> (<em>float</em>) – slowness in s/km.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – Either “S” or “P”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x_delta</strong> – Euclidean distance between station and piercing point.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-database">
<h2>pyglimer.database<a class="headerlink" href="#pyglimer-database" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.database.stations">
<span id="pyglimer-database-stations"></span><h3>pyglimer.database.stations<a class="headerlink" href="#module-pyglimer.database.stations" title="Permalink to this headline">¶</a></h3>
<p>Database management and overview for the PyGLImER database.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 12th February 2020 03:24:30 pm
Last Modified: Saturday, 21st August 2021 07:41:42 am</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.database.stations.redownload_missing_statxmls">
<span class="sig-prename descclassname"><span class="pre">pyglimer.database.stations.</span></span><span class="sig-name descname"><span class="pre">redownload_missing_statxmls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/stations.html#redownload_missing_statxmls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.stations.redownload_missing_statxmls" title="Permalink to this definition">¶</a></dt>
<dd><p>Fairly primitive program that walks through existing raw waveforms in
rawdir and looks for missing station xmls in statloc and, afterwards,
attemps a redownload</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clients</strong> (<em>list</em>) – List of clients (see obspy documentation for
<cite>~obspy.Client</cite>).</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” or “S”, defines in which folder to look for
mseeds.</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Folder, in which the station xmls are saved</p></li>
<li><p><strong>rawdir</strong> (<em>str</em>) – Uppermost directory, in which the raw mseeds are saved
(i.e. the directory above the phase division).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Show some extra information, by default True</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.database.asdf">
<span id="pyglimer-database-asdf"></span><h3>pyglimer.database.asdf<a class="headerlink" href="#module-pyglimer.database.asdf" title="Permalink to this headline">¶</a></h3>
<p>A module to handle and rewrite the PyGLiMER database to and in Adaptable
Seismic Format (asdf).</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 12th February 2021 03:24:30 pm</p>
<p>Last Modified: Wednesday, 22nd September 2021 03:18:12 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.database.asdf.rewrite_to_hdf5">
<span class="sig-prename descclassname"><span class="pre">pyglimer.database.asdf.</span></span><span class="sig-name descname"><span class="pre">rewrite_to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawfolder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/asdf.html#rewrite_to_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.asdf.rewrite_to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an existing miniseed waveform database to hierachal data format
(hdf5).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>catfile</strong> (<em>path to obspy.Catalog</em><em> (</em><em>str</em><em>)</em>) – The pat hto the event catalogue that was used to download
the raw data. Will be altered during the process (removes already used
ones).</p></li>
<li><p><strong>rawfolder</strong> (<em>str</em>) – The folder that the raw data is saved in - ending with
the phase code (i.e., waveforms/raw/P)</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Location that the station xmls are saved in.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.database.asdf.write_st">
<span class="sig-prename descclassname"><span class="pre">pyglimer.database.asdf.</span></span><span class="sig-name descname"><span class="pre">write_st</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">threading.Event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfolder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statxml</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.inventory.inventory.Inventory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/asdf.html#write_st"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.asdf.write_st" title="Permalink to this definition">¶</a></dt>
<dd><p>Write raw waveform data to an asdf file. This includes the corresponding
(teleseismic) event and the station inventory (i.e., response information).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>st</strong> (<em>Stream</em>) – The stream holding the raw waveform data.</p></li>
<li><p><strong>event</strong> (<em>Event</em>) – The seismic event associated to the recorded data.</p></li>
<li><p><strong>outfolder</strong> (<em>str</em>) – Output folder to write the asdf file to.</p></li>
<li><p><strong>statxml</strong> (<em>Inventory</em>) – The station inventory</p></li>
<li><p><strong>resample</strong> (<em>bool</em><em>, </em><em>optional</em>) – Resample the data to 10Hz sampling rate? Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.database.asdf.writeraw">
<span class="sig-prename descclassname"><span class="pre">pyglimer.database.asdf.</span></span><span class="sig-name descname"><span class="pre">writeraw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">event</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.event.event.Event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawfolder</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resample</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/asdf.html#writeraw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.asdf.writeraw" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the downloaded miniseed, event, and stationxmls to a single asdf
file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event</strong> (<em>obspy.core.event.event.Event</em>) – Event that all the waveforms are associated to.</p></li>
<li><p><strong>rawfolder</strong> (<em>str</em>) – Folder to save the .h5 file to.</p></li>
<li><p><strong>statloc</strong> (<em>str</em>) – Folder, in which the station xmls can be found</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – show warnings?</p></li>
<li><p><strong>resample</strong> (<em>bool</em>) – Resample/Decimate the waveforms to 10Hz before writing.
Includes an AA-filter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.database.rfh5">
<span id="pyglimer-database-rfh5"></span><h3>pyglimer.database.rfh5<a class="headerlink" href="#module-pyglimer.database.rfh5" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p><cite>GNU Lesser General Public License, Version 3
&lt;https://www.gnu.org/copyleft/lesser.html&gt;</cite></p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Wednesday, 11th August 2021 03:20:09 pm
Last Modified: Monday, 4th October 2021 03:28:36 pm</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.DBHandler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.database.rfh5.</span></span><span class="sig-name descname"><span class="pre">DBHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#DBHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.DBHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">h5py._hl.files.File</span></code></p>
<p>The actual file handler of the hdf5 receiver function files.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Should not be accessed directly. Access
:class:`~pyglimer.database.rfh5.RFDataBase` instead.</strong></p>
</div>
<p>Child object of <code class="xref py py-class docutils literal notranslate"><span class="pre">h5py.File</span></code> and inherets all its attributes and
functions in addition to functions that are particularly useful for noise
correlations.</p>
<p>Create a new file object.</p>
<p>See the h5py user guide for a detailed explanation of the options.</p>
<dl class="simple">
<dt>name</dt><dd><p>Name of the file on disk, or file-like object.  Note: for files
created with the ‘core’ driver, HDF5 still requires this be
non-empty.</p>
</dd>
<dt>mode</dt><dd><p>r        Readonly, file must exist (default)
r+       Read/write, file must exist
w        Create file, truncate if exists
w- or x  Create file, fail if exists
a        Read/write if exists, create otherwise</p>
</dd>
<dt>driver</dt><dd><p>Name of the driver to use.  Legal values are None (default,
recommended), ‘core’, ‘sec2’, ‘stdio’, ‘mpio’, ‘ros3’.</p>
</dd>
<dt>libver</dt><dd><p>Library version bounds.  Supported values: ‘earliest’, ‘v108’,
‘v110’, ‘v112’  and ‘latest’. The ‘v108’, ‘v110’ and ‘v112’
options can only be specified with the HDF5 1.10.2 library or later.</p>
</dd>
<dt>userblock_size</dt><dd><p>Desired size of user block.  Only allowed when creating a new
file (mode w, w- or x).</p>
</dd>
<dt>swmr</dt><dd><p>Open the file in SWMR read mode. Only used when mode = ‘r’.</p>
</dd>
<dt>rdcc_nbytes</dt><dd><p>Total size of the raw data chunk cache in bytes. The default size
is 1024**2 (1 MB) per dataset.</p>
</dd>
<dt>rdcc_w0</dt><dd><p>The chunk preemption policy for all datasets.  This must be
between 0 and 1 inclusive and indicates the weighting according to
which chunks which have been fully read or written are penalized
when determining which chunks to flush from cache.  A value of 0
means fully read or written chunks are treated no differently than
other chunks (the preemption is strictly LRU) while a value of 1
means fully read or written chunks are always preempted before
other chunks.  If your application only reads or writes data once,
this can be safely set to 1.  Otherwise, this should be set lower
depending on how often you re-read or re-write the same data.  The
default value is 0.75.</p>
</dd>
<dt>rdcc_nslots</dt><dd><p>The number of chunk slots in the raw data chunk cache for this
file. Increasing this value reduces the number of cache collisions,
but slightly increases the memory used. Due to the hashing
strategy, this value should ideally be a prime number. As a rule of
thumb, this value should be at least 10 times the number of chunks
that can fit in rdcc_nbytes bytes. For maximum performance, this
value should be set approximately 100 times that number of
chunks. The default value is 521.</p>
</dd>
<dt>track_order</dt><dd><p>Track dataset/group/attribute creation order under root group
if True. If None use global default h5.get_config().track_order.</p>
</dd>
<dt>fs_strategy</dt><dd><p>The file space handling strategy to be used.  Only allowed when
creating a new file (mode w, w- or x).  Defined as:
“fsm”        FSM, Aggregators, VFD
“page”       Paged FSM, VFD
“aggregate”  Aggregators, VFD
“none”       VFD
If None use HDF5 defaults.</p>
</dd>
<dt>fs_persist</dt><dd><p>A boolean value to indicate whether free space should be persistent
or not.  Only allowed when creating a new file.  The default value
is False.</p>
</dd>
<dt>fs_threshold</dt><dd><p>The smallest free-space section size that the free space manager
will track.  Only allowed when creating a new file.  The default
value is 1.</p>
</dd>
<dt>Additional keywords</dt><dd><p>Passed on to the selected file driver.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.DBHandler.add_rf">
<span class="sig-name descname"><span class="pre">add_rf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><span class="pre">pyglimer.rf.create.RFTrace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'rf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#DBHandler.add_rf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.DBHandler.add_rf" title="Permalink to this definition">¶</a></dt>
<dd><p>Add receiver function to the hdf5 file. The data can later be accessed
using the <a class="reference internal" href="#pyglimer.database.rfh5.DBHandler.get_data" title="pyglimer.database.rfh5.DBHandler.get_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_data()</span></code></a> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><em>RFTrace</em></a><em> or </em><a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><em>RFStream</em></a>) – Data to save. Either a
<a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a> object or a
<a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a> holding one or
several traces.</p></li>
<li><p><strong>tag</strong> – The tag that the data should be saved under. By convention,
unstacked correlations are saved with the tag <cite>‘rf’</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – for wrong data type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.DBHandler.get_coords">
<span class="sig-name descname"><span class="pre">get_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'rf'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#DBHandler.get_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.DBHandler.get_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinates of the station.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>str</em>) – Network Code.</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Station Code</p></li>
<li><p><strong>phase</strong> (<em>str</em><em>, </em><em>optional</em>) – Teleseismic Phase, defaults to None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Latitude (dec deg), Longitude (dec deg), Elevation (m)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[ float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.DBHandler.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evt_time</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'rf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'v'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><span class="pre">pyglimer.rf.create.RFStream</span></a></span></span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#DBHandler.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.DBHandler.get_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a> holding
all the requested data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Wildcards are allowed for all parameters.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>str</em>) – network code, e.g., IU</p></li>
<li><p><strong>station</strong> (<em>str</em>) – station code, e.g., HRV</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Teleseismic phase</p></li>
<li><p><strong>evt_time</strong> (<em>UTCDateTime</em><em>, </em><em>optional</em>) – Origin Time of the Event</p></li>
<li><p><strong>tag</strong> (<em>str</em><em>, </em><em>optional</em>) – Data tag (e.g., ‘rf’). Defaults to rf.</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – RF Polarisation. Defaults to v.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a <a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFStream</span></code></a> holding the requested
data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream">RFStream</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.DBHandler.walk">
<span class="sig-name descname"><span class="pre">walk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'v'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><span class="pre">pyglimer.rf.create.RFTrace</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#DBHandler.walk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.DBHandler.walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all receiver functions with the given properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag</strong> (<em>str</em>) – data tag</p></li>
<li><p><strong>network</strong> (<em>str</em>) – Network code</p></li>
<li><p><strong>station</strong> (<em>str</em>) – Statio ncode</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Teleseismic phase</p></li>
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – RF-Polarisation, defaults to ‘v’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Iterator</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Iterable[<a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace">RFTrace</a>]</p>
</dd>
<dt class="field-even">Yield</dt>
<dd class="field-even"><p>one <a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">RFTrace</span></code></a> per receiver function.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Iterator[Iterable[<a class="reference internal" href="#pyglimer.rf.create.RFTrace" title="pyglimer.rf.create.RFTrace">RFTrace</a>]]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Does not accept wildcards.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.RFDataBase">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.database.rfh5.</span></span><span class="sig-name descname"><span class="pre">RFDataBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compression</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'gzip3'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#RFDataBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.RFDataBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class to handle the hdf5 files that contain noise correlations.</p>
<p>Access an hdf5 file holding receiver functions. The resulting file can
be accessed using all functionalities of
<a class="reference external" href="https://www.h5py.org/">h5py</a> (for example as a dict).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – Full path to the file</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Mode to access the file. Options are: ‘a’ for all, ‘w’ for
write, ‘r+’ for writing in an already existing file, or ‘r’ for
read-only , defaults to ‘a’.</p></li>
<li><p><strong>compression</strong> (<em>str</em><em>, </em><em>optional</em>) – The compression algorithm and compression level
that the arrays should be saved with. ‘gzip3’ tends to perform
well, else you could choose ‘gzipx’ where x is a digit between
1 and 9 (i.e., 9 is the highest compression) or None for fastest
perfomance, defaults to ‘gzip3’.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>Access only through a context manager (see below):</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">RFDataBase</span><span class="p">(</span><span class="n">myfile</span><span class="o">.</span><span class="n">h5</span><span class="p">)</span> <span class="k">as</span> <span class="n">rfdb</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">type</span><span class="p">(</span><span class="n">rfdb</span><span class="p">)</span>  <span class="c1"># This is a DBHandler</span>
<span class="go">&lt;class &#39;pyglimer.database.rfh5.DBHandler&#39;&gt;</span>
</pre></div>
</div>
</div>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">RFDataBase</span><span class="p">(</span>
<span class="go">            &#39;/path/to/db/XN.NEP06.h5&#39;) as rfdb:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># find the available tags for existing db</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rfdb</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<span class="go">[&#39;rf&#39;, &#39;rfstack&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Get Data from all times and tag rf, phase P</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">st</span> <span class="o">=</span> <span class="n">rfdb</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="s1">&#39;XN&#39;</span><span class="p">,</span> <span class="s1">&#39;NEP06&#39;</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="s1">&#39;rf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="go">250</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.all_traces_recursive">
<span class="sig-prename descclassname"><span class="pre">pyglimer.database.rfh5.</span></span><span class="sig-name descname"><span class="pre">all_traces_recursive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">h5py._hl.group.Group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><span class="pre">pyglimer.rf.create.RFStream</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyglimer.rf.create.RFStream" title="pyglimer.rf.create.RFStream"><span class="pre">pyglimer.rf.create.RFStream</span></a></span></span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#all_traces_recursive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.all_traces_recursive" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively, appends all traces in a h5py group to the input stream.
In addition this will check whether the data matches a certain pattern.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group</strong> (class:<cite>h5py._hl.group.Group</cite>) – group to search through</p></li>
<li><p><strong>stream</strong> (<em>CorrStream</em>) – Stream to append the traces to</p></li>
<li><p><strong>pattern</strong> (<em>str</em>) – pattern for the path in the hdf5 file, see fnmatch for
details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Stream with appended traces</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>CorrStream</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.convert_header_to_hdf5">
<span class="sig-prename descclassname"><span class="pre">pyglimer.database.rfh5.</span></span><span class="sig-name descname"><span class="pre">convert_header_to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">h5py._hl.dataset.Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.trace.Stats</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#convert_header_to_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.convert_header_to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an <code class="xref py py-class docutils literal notranslate"><span class="pre">Stats</span></code> object and adds it to the provided
hdf5 dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>h5py.Dataset</em>) – the dataset that the header should be added to</p></li>
<li><p><strong>header</strong> (<em>Stats</em>) – The trace’s header</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.database.rfh5.read_hdf5_header">
<span class="sig-prename descclassname"><span class="pre">pyglimer.database.rfh5.</span></span><span class="sig-name descname"><span class="pre">read_hdf5_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">h5py._hl.dataset.Dataset</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">obspy.core.trace.Stats</span></span></span><a class="reference internal" href="../_modules/pyglimer/database/rfh5.html#read_hdf5_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.database.rfh5.read_hdf5_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an hdf5 dataset as input and returns the header of the CorrTrace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>h5py.Dataset</em>) – The dataset to be read from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The trace’s header</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Stats</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-test">
<h2>pyglimer.test<a class="headerlink" href="#pyglimer-test" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.test.rate">
<span id="pyglimer-test-rate"></span><h3>pyglimer.test.rate<a class="headerlink" href="#module-pyglimer.test.rate" title="Permalink to this headline">¶</a></h3>
<p>Contains various functions used to evaluate the quality of RF and waveforms</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 25th February 2020 07:28:30 pm
Last Modified: Thursday, 19th August 2021 03:13:09 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.rate.automatic_rate">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.rate.</span></span><span class="sig-name descname"><span class="pre">automatic_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#automatic_rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.rate.automatic_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the automatic QC criteria for SRF waveforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (2 letters).</p></li>
<li><p><strong>station</strong> (<em>STRING</em>) – Station code (3 letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” or “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>diff</strong> (<em>INTEGER</em>) – Number of waveforms that were not rated 3 or 4.</p></li>
<li><p><strong>ret</strong> (<em>INTEGER</em>) – Number of automatically retained waveforms.</p></li>
<li><p><strong>sts</strong> (<em>LIST</em>) – List containing all retained + filtered streams.</p></li>
<li><p><strong>crits</strong> (<em>LIST</em>) – List containing bools (retained or not) corresponding to streams in
sts.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.rate.rate">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.rate.</span></span><span class="sig-name descname"><span class="pre">rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">review</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decon_meth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'it'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_tt_calculation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#rate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.rate.rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Module to rate and review the quality of Sp or Ps waveforms from the given
station. Shows the automatic rating from qc. Tapers can be controlled with
the mouse. Rating is done with the keyboard. Makes only sense if the
files in preproloc have not been quality controlled (the script is a
reminant from an earlier alpha version).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (two letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em>) – Either “P” for Ps or “S” Sp. The default is “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Station code (three letters).</p></li>
<li><p><strong>review</strong> (<em>INTEGER</em><em>, </em><em>optional</em>) – If true, already rated waveforms are shown.
Can also be an integer between 1 and 4. Then, only waveforms rated
with the respected rating are shown. The default is False.</p></li>
<li><p><strong>retained</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Show only waveforms retained by qcp or qcs. The default is False.</p></li>
<li><p><strong>decon_meth</strong> (<em>STRING</em><em>, </em><em>optional</em>) – Deconvolution method, “waterlevel”, ‘dampedf’ for constant
damping level, ‘it’ for iterative time domain deconvoltuion, ‘multit’
for multitaper or ‘fqd’ for frequency dependently damped spectral
division. The default is ‘it’</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For Typing mistakes.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.rate.sort_rated">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.rate.</span></span><span class="sig-name descname"><span class="pre">sort_rated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/rate.html#sort_rated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.rate.sort_rated" title="Permalink to this definition">¶</a></dt>
<dd><p>Functions that sorts waveforms in 4 folders,
depending on their manual rating.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>STRING</em>) – Network code (2 letters).</p></li>
<li><p><strong>station</strong> (<em>STRING</em>) – Station code (3 letters).</p></li>
<li><p><strong>phase</strong> (<em>STRING</em><em>, </em><em>optional</em>) – “P” or “S”.</p></li>
<li><p><strong>preproloc</strong> (<em>string</em>) – Directory that contains the preprocessed files (not quality controlled)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.test.synthetic">
<span id="pyglimer-test-synthetic"></span><h3>pyglimer.test.synthetic<a class="headerlink" href="#module-pyglimer.test.synthetic" title="Permalink to this headline">¶</a></h3>
<p>Create synthetic impulse resonses.
Used to test the deconvolve module.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Wednesday, 23rd October 2019 09:37:30 am
Last Modified: Thursday, 19th August 2021 03:13:20 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.synthetic.create_R">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.synthetic.</span></span><span class="sig-name descname"><span class="pre">create_R</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/synthetic.html#create_R"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.synthetic.create_R" title="Permalink to this definition">¶</a></dt>
<dd><p>Program to create random reflectivity series
INPUT
N2: half-length of the signal (N=2*N2+1)
M: number of seismic discontinuities</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.synthetic.synthetic">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.synthetic.</span></span><span class="sig-name descname"><span class="pre">synthetic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SNR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdv</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/synthetic.html#synthetic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.synthetic.synthetic" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create synthetic seismograms (given Impulse response
convolved with a Ricker wavelet)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N2</strong> (<em>int</em>) – half-length of the Input traces, (full length N= N2*2+1)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling rate</p></li>
<li><p><strong>R</strong> (<em>Arraylike</em>) – Impulse response / reflectivity series with length N</p></li>
<li><p><strong>SNR</strong> (<em>float</em>) – ratio of maximal amplitude of the source wavelet to max noise amplitude</p></li>
<li><p><strong>stdv</strong> (<em>float</em>) – standard deviation of the source pulse (controls width)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>v_noise : the theorethical source wavelet with noise independent
from the noise on the horizontal component(equal to the hoizontal
component of a seismogram in RF)
h_noise : The horizontal component of the seismogram with noise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.test.tests">
<span id="pyglimer-test-tests"></span><h3>pyglimer.test.tests<a class="headerlink" href="#module-pyglimer.test.tests" title="Permalink to this headline">¶</a></h3>
<p>Created on Wed Apr  1 13:51:46 2020
Assorted functions that serve as a tests (mostly with synthetic data) of other
GLImER functions.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Wednesday, 1st April 2020 01:51:30 pm
Last Modified: Thursday, 19th August 2021 03:14:24 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.tests.decon_test">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.tests.</span></span><span class="sig-name descname"><span class="pre">decon_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PSS_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#decon_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.tests.decon_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to test a given deconvolution method with synthetic data created
with raysum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PSS_file</strong> (<em>str</em>) – Filename of raysum file containing P-Sv-Sh traces.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – “S” or “P”.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – Deconvolution method: use 1. “fqd”, “wat”, or “con for
frequency-dependent damped, waterlevel damped, constantly damped
spectraldivision. 2. “it” for iterative deconvolution, and 3.
“multit_con” or “multitap_fqd” for constantly or frequency-dependent
damped multitaper deconvolution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>RF</strong> (<em>np.array</em>) – Matrix containing all receiver functions.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.tests.moveout_test">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.tests.</span></span><span class="sig-name descname"><span class="pre">moveout_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PSS_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#moveout_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.tests.moveout_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates synthetic PRFs and stacks them after depth migration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PSS_file</strong> (<em>str</em>) – Filename of raysum file containing P-Sv-Sh traces.</p></li>
<li><p><strong>q</strong> (<em>float</em>) – Slowness [s/m].</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Either “P” for Ps or “S” for Sp.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>z</strong> (<em>np.array</em>) – Depth vector.</p></li>
<li><p><strong>stack</strong> (<em>np.array</em>) – Receiver function stack.</p></li>
<li><p><strong>RF_mo</strong> (<em>np.array</em>) – Matrix containing all depth migrated RFs.</p></li>
<li><p><strong>RF</strong> (<em>np.array</em>) – Matrix containing all RFs.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Sampling interval.</p></li>
<li><p><strong>PSS</strong> (<em>np.array</em>) – Matrix containing all traces in P-Sv-Sh.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.tests.read_geom">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.tests.</span></span><span class="sig-name descname"><span class="pre">read_geom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geom_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#read_geom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.tests.read_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in the geometry file of the raysum program to determine parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>geom_file</strong> (<em>str</em>) – Filename of the geometry file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>baz</strong> (<em>np.ndarray(1D)</em>) – Array containing the backazimuths of each trace [deg].</p></li>
<li><p><strong>q</strong> (<em>np.ndarray(1D)</em>) – Array containing the slownesses of each trace [s/m].</p></li>
<li><p><strong>dN</strong> (<em>np.ndarray(1D)</em>) – Array containing the north shift of each trace [m].</p></li>
<li><p><strong>dE</strong> (<em>np.ndarray(1D)</em>) – Array containing the east shift of each trace [m].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.tests.read_raysum">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.tests.</span></span><span class="sig-name descname"><span class="pre">read_raysum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NEZ_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RTZ_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PSS_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#read_raysum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.tests.read_raysum" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the output of the raysum program (by Andrew Frederiksen).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>NEZ_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of file in NEZ coordinate system. The default is None.</p></li>
<li><p><strong>RTZ_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of file in RTZ coordinate system. The default is None.</p></li>
<li><p><strong>PSS_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of file in P-Sv-Sh coordinate system. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – For wron inputs.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>stream</strong> (<em>np.array</em>) – One numpy array for each provided input file.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – The sampling interval [s].</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Number of traces per file.</p></li>
<li><p><strong>N</strong> (<em>int</em>) – Number of samples per trace</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.tests.read_rfs_mat">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.tests.</span></span><span class="sig-name descname"><span class="pre">read_rfs_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'output/ccps'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'output/waveforms/RF/P/matlab'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'matlab'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#read_rfs_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.tests.read_rfs_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads in Matlab files constructed by the old GLImER workflow.
It takes a long time to decode h5 files with that and they cannot
be pickled either, so no multicore :-/</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – filename.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Input directory. The default is ‘output/ccps’.</p></li>
<li><p><strong>outdir</strong> (<em>str</em><em>, </em><em>optional</em>) – Output directory. The default is ‘output/waveform/RF/matlab’.</p></li>
<li><p><strong>outfile</strong> (<em>str</em><em>, </em><em>optional</em>) – Output file. The default is ‘matlab’.</p></li>
</ul>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rf</strong> (<em>RFTrace</em>) – RFTrace object, one per receiver function.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – position in .mat.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.tests.rf_test">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.tests.</span></span><span class="sig-name descname"><span class="pre">rf_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'output/waveforms/RF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geom_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'3D.geom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decon_meth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'it'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#rf_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.tests.rf_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates synthetic PRFs from Raysum data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>string</em>) – “P” or “S”.</p></li>
<li><p><strong>dip</strong> (<em>int</em>) – Dip of the LAB in deg, determines, which files to use</p></li>
<li><p><strong>rfloc</strong> (<em>The parental directory</em><em>, </em><em>in which the RFs are saved.</em>) – </p></li>
<li><p><strong>geom_file</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of the geometry file</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rfs</strong> – List of RFTrace objects. Will in addition be saved in SAC format.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.test.tests.test_SNR">
<span class="sig-prename descclassname"><span class="pre">pyglimer.test.tests.</span></span><span class="sig-name descname"><span class="pre">test_SNR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ouput/waveforms/preprocessed'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/test/tests.html#test_SNR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.test.tests.test_SNR" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the automatic QC scripts for a certain station and writes ratings
in the rating file.</p>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-utils">
<h2>pyglimer.utils<a class="headerlink" href="#pyglimer-utils" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.utils.create_geom">
<span id="pyglimer-utils-create-geom"></span><h3>pyglimer.utils.create_geom<a class="headerlink" href="#module-pyglimer.utils.create_geom" title="Permalink to this headline">¶</a></h3>
<p>Automatic creation of raysum geom files</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Thursday, 14th May 2020 10:23:03
Last Modified: Thursday, 19th August 2021 03:15:31 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.create_geom.create_geom">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.create_geom.</span></span><span class="sig-name descname"><span class="pre">create_geom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bazv</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raypv</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift_max</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cross'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/create_geom.html#create_geom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.create_geom.create_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates geometry files for Raysum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>int</em>) – Number of stations. Has to be uneven if shape=cross.
Else has to be N=M**2. Were M is a natural number</p></li>
<li><p><strong>bazv</strong> (<em>np.ndarray</em><em>(</em><em>1D</em><em>)</em>) – 1D array containing the backzimuths per station (deg).</p></li>
<li><p><strong>raypv</strong> (<em>np.ndarray</em><em>(</em><em>1D</em><em>)</em>) – 1D array containing the slownesses in s/m per backzimuth.</p></li>
<li><p><strong>shift_max</strong> (<em>int</em>) – Maximum horizontal shift in m.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the output file.</p></li>
<li><p><strong>shape</strong> (<em>str</em>) – shape of the array</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For Even Ns.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.createvmodel">
<span id="pyglimer-utils-createvmodel"></span><h3>pyglimer.utils.createvmodel<a class="headerlink" href="#module-pyglimer.utils.createvmodel" title="Permalink to this headline">¶</a></h3>
<p>Create a 3D velocity model using Litho1.0</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 01st May 2020 12:11:03
Last Modified: Friday, 20th August 2021 11:15:35 am</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.createvmodel.load_avvmodel">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.createvmodel.</span></span><span class="sig-name descname"><span class="pre">load_avvmodel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyglimer.utils.createvmodel.AverageVelModel</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/createvmodel.html#load_avvmodel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.createvmodel.load_avvmodel" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a model over the average P and S-wave velocities in the upper
crust. These are used by the P-SV-SH rotation algorithm. Model data
is extracted from the Litho1.0 model (location provided above).
The package is distributed with a readily compiled model.</p>
<p>Litho1.0 must be installed and location must be set correct for a
complete compilation! However, function will first look in RAM and then
in data for a pickle file.</p>
<p>Compiling takes up to one hour!</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Model containing average velocities for upper crust.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.createvmodel.load_gyps">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.createvmodel.</span></span><span class="sig-name descname"><span class="pre">load_gyps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flatten</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pyglimer.utils.createvmodel.ComplexModel</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/createvmodel.html#load_gyps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.createvmodel.load_gyps" title="Permalink to this definition">¶</a></dt>
<dd><p>Compiles the GyPSuM 3D-velocity object from included GyPSuM text files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save</strong> (<em>Bool</em><em>, </em><em>optional</em>) – Pickle the 3D velocity model after compiling it for the first time.
This will allow for faster access to the model. Saving the model takes
about 800 MB disk space.
The default is False, as it lead to unstabilities with joblib.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Creates a submodel from the full model. In form (minlat, maxlat).</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – (minlon, maxlon)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Object that can be queried for velocities.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ComplexModel object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.geo_utils">
<span id="pyglimer-utils-geo-utils"></span><h3>pyglimer.utils.geo_utils<a class="headerlink" href="#module-pyglimer.utils.geo_utils" title="Permalink to this headline">¶</a></h3>
<p>Geographical utilities.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: November 2019</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.geo_utils.cart2geo">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></span><span class="sig-name descname"><span class="pre">cart2geo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#cart2geo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.cart2geo" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes geographical coordinates from cartesian coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong><strong>)</strong> (<em>x</em><em> (</em><em>numpy.array corresponding to y/z</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> (<em>z</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>r, latitude, longitude tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.geo_utils.epi2euc">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></span><span class="sig-name descname"><span class="pre">epi2euc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#epi2euc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.epi2euc" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts epicentral distance in to a euclidean distance along the
corresponding chord.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.geo_utils.euc2epi">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></span><span class="sig-name descname"><span class="pre">euc2epi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">euc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#euc2epi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.euc2epi" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts euclidean distance to epicentral distance</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.geo_utils.gctrack">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></span><span class="sig-name descname"><span class="pre">gctrack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#gctrack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.gctrack" title="Permalink to this definition">¶</a></dt>
<dd><p>Given waypoints and a point distance, this function computes evenly
spaced points along the great circle and the given waypoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>np.ndarray</em>) – waypoint latitudes</p></li>
<li><p><strong>lon</strong> (<em>np.ndarray</em>) – waypoint longitudes</p></li>
<li><p><strong>dist</strong> (<em>float</em>) – distance in degrees</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple(np.ndarray, np.ndarray)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2020.04.20 00.30</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.geo_utils.geo2cart">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></span><span class="sig-name descname"><span class="pre">geo2cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#geo2cart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.geo2cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes cartesian coordinates from geographical coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arrays</strong><strong>)</strong> (<em>r</em><em> (</em><em>float</em><em> or </em><em>numpy.array corresponding to lat/lon</em>) – </p></li>
<li><p><strong>location</strong> – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> (<em>longitude</em>) – </p></li>
<li><p><strong>(</strong><strong>numpy.array</strong><strong>)</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xyz coordinates coordinates of same size as latitude and longitude arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.geo_utils.reckon">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.geo_utils.</span></span><span class="sig-name descname"><span class="pre">reckon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bearing</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/geo_utils.html#reckon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.geo_utils.reckon" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes new latitude and longitude from bearing and distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>lon</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>bearing</strong> (<em>in degrees</em>) – </p></li>
<li><p><strong>distance</strong> (<em>in degrees</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>lat, lon</p>
</dd>
</dl>
<p>lat1 = math.radians(52.20472)  # Current lat point converted to radians
lon1 = math.radians(0.14056)  # Current long point converted to radians
bearing = np.pi/2 # 90 degrees
# lat2  52.20444 - the lat result I’m hoping for
# lon2  0.36056 - the long result I’m hoping for.</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.nextpowof2">
<span id="pyglimer-utils-nextpowof2"></span><h3>pyglimer.utils.nextpowof2<a class="headerlink" href="#module-pyglimer.utils.nextpowof2" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 18th October 2019 08:11:03 pm
Last Modified: Thursday, 25th March 2021 03:56:56 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.nextpowof2.nextPowerOf2">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.nextpowof2.</span></span><span class="sig-name descname"><span class="pre">nextPowerOf2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/nextpowof2.html#nextPowerOf2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.nextpowof2.nextPowerOf2" title="Permalink to this definition">¶</a></dt>
<dd><p>just returns the next higher power of two from n</p>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.roundhalf">
<span id="pyglimer-utils-roundhalf"></span><h3>pyglimer.utils.roundhalf<a class="headerlink" href="#module-pyglimer.utils.roundhalf" title="Permalink to this headline">¶</a></h3>
<p>Rounds to next 0.5</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Saturday, 02nd May 2020 01:48:03 pm
Last Modified: Thursday, 25th March 2021 04:00:02 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.roundhalf.roundhalf">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.roundhalf.</span></span><span class="sig-name descname"><span class="pre">roundhalf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/roundhalf.html#roundhalf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.roundhalf.roundhalf" title="Permalink to this definition">¶</a></dt>
<dd><p>Rounds to next half of integer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number</strong> (<em>float/int</em>) – number to be rounded.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Closest half of integer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.signalproc">
<span id="pyglimer-utils-signalproc"></span><h3>pyglimer.utils.signalproc<a class="headerlink" href="#module-pyglimer.utils.signalproc" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Sunday, 20th October 2019 10:31:03 am
Last Modified: Thursday, 26th August 2021 08:32:29 am</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.convf">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">convf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#convf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.convf" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolution conducted in the frequency domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>np.array</em>) – Array 1.</p></li>
<li><p><strong>v</strong> (<em>np.array</em>) – Array 2.</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling Interval [s].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>c</strong> – Convolution of u with v.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.corrf">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">corrf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#corrf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.corrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Cross-correlation in frequency domain,
calculates the x=crosscorr(u,v). Hence, v is the flipped vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> (<em>np.array</em>) – flipped vector.</p></li>
<li><p><strong>v</strong> (<em>np.array</em>) – Vector that the correlation is measured to.</p></li>
<li><p><strong>nf</strong> (<em>INTEGER</em>) – Array length in frequency domain (use next power of 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – Correlation vector.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.filter">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">F</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Convolves a filter with a signal (given in time domain).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>np.array</em>) – Signal given in time domain.</p></li>
<li><p><strong>F</strong> (<em>np.array</em>) – Filter’s amplitude response (i.e., frequency domain).</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s_f</strong> – Filtered signal.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.gaussian">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a zero-phase Gaussian function (i.e., a low-pass filter). In
particular meant to be convolved with the impulse
response that is the output of an iterative deconvolution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N</strong> (<em>INTEGER</em>) – Length of the desired array.</p></li>
<li><p><strong>dt</strong> (<em>FLOAT</em>) – Sampling interval [s].</p></li>
<li><p><strong>width</strong> (<em>FLOAT</em>) – Width parameter of the Gaussian function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>G</strong> – Gaussian window.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.noise">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.noise" title="Permalink to this definition">¶</a></dt>
<dd><p>create random noise
:param N: signal length
:type N: int
:param A: maximal amplitude
:type A: float</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.resample_or_decimate">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">resample_or_decimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling_rate_new</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">obspy.core.stream.Stream</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#resample_or_decimate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.resample_or_decimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Decimates the data if the desired new sampling rate allows to do so.
Else the signal will be interpolated (a lot slower).</p>
<dl class="field-list simple">
<dt class="field-odd">Note</dt>
<dd class="field-odd"><p>The stream has to be filtered a priori to avoid aliasing.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>data</strong> (<em>Stream</em>) – Stream to be resampled.</p></li>
<li><p><strong>sampling_rate_new</strong> (<em>int</em>) – The desired new sampling rate</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The resampled stream</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Stream</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.ricker">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">ricker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#ricker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.ricker" title="Permalink to this definition">¶</a></dt>
<dd><p>create a zero-phase Ricker / Mexican hat wavelet</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<em>float</em>) – standard deviation</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling Interval</p></li>
<li><p><strong>N2</strong> (<em>int</em>) – number of samples/2 (halflength). Full length = 2*N2+1</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.signalproc.sshift">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.signalproc.</span></span><span class="sig-name descname"><span class="pre">sshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N2</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/signalproc.html#sshift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.signalproc.sshift" title="Permalink to this definition">¶</a></dt>
<dd><p>shift a signal by a given time-shift in the frequency domain</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s</strong> (<em>Arraylike</em>) – signal</p></li>
<li><p><strong>N2</strong> (<em>int</em>) – length of the signal in f-domain (usually equals the next pof 2)</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – sampling interval</p></li>
<li><p><strong>shift</strong> (<em>float</em>) – the time shift in seconds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Timeshifted signal</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.utils.utils">
<span id="pyglimer-utils-utils"></span><h3>pyglimer.utils.utils<a class="headerlink" href="#module-pyglimer.utils.utils" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)
Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tue May 26 2019 13:31:30
Last Modified: Monday, 13th September 2021 03:46:30 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.utils.chunks">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></span><span class="sig-name descname"><span class="pre">chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lst</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#chunks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.chunks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield successive n-sized chunks from lst. Useful for multi-threading</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.utils.create_bulk_str">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></span><span class="sig-name descname"><span class="pre">create_bulk_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">networks</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t1</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.utcdatetime.UTCDateTime</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#create_bulk_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.create_bulk_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate the input for the obspy functions:
get_stations_bulk() and get_waveforms_bulk().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>networks</strong> (<em>str</em><em> or </em><em>List</em><em>[</em><em>str</em><em>]</em>) – The requested networks, can be str or List.</p></li>
<li><p><strong>stations</strong> (<em>str</em><em> or </em><em>List</em><em>[</em><em>str</em><em>]</em>) – The requested stations, can be str or List.</p></li>
<li><p><strong>location</strong> (<em>str</em>) – Location string</p></li>
<li><p><strong>channel</strong> (<em>str</em>) – Channel string</p></li>
<li><p><strong>t0</strong> (<em>UTCDateTime</em><em> or </em><em>str</em><em> or </em><em>List</em><em>[</em><em>UTCDateTime</em><em>]</em>) – starttimes</p></li>
<li><p><strong>t1</strong> (<em>UTCDateTime</em><em> or </em><em>str</em><em> or </em><em>List</em><em>[</em><em>UTCDateTime</em><em>]</em>) – endtimes</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For invalid input types or inputs</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The List to be used as input with the aforementioned functions.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[tuple]</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All parameters accept wildcards.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.utils.download_full_inventory">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></span><span class="sig-name descname"><span class="pre">download_full_inventory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdsn_client</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#download_full_inventory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.download_full_inventory" title="Permalink to this definition">¶</a></dt>
<dd><p>This utility loops through statloc and redownloads the whole response
(i.e., all channels and all times) for every station. Thus, overwriting
the old xml file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>statloc</strong> (<em>str</em>) – Folder in which the old stationxmls are saved</p></li>
<li><p><strong>fdsn_client</strong> (<em>list</em>) – List of FDSN providers that should be queried.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.utils.dt_string">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></span><span class="sig-name descname"><span class="pre">dt_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#dt_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.dt_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Time elapsed string depending on how much time has passed.
After a certain amount of seconds it returns minutes, and after a certain
amount of minutes it returns the elapsed time in hours.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.utils.get_multiple_fdsn_clients">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></span><span class="sig-name descname"><span class="pre">get_multiple_fdsn_clients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">clients</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">obspy.clients.fdsn.client.Client</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#get_multiple_fdsn_clients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.get_multiple_fdsn_clients" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple holding all the queried fdsn providers. Also finds
all available fdsn providers if input is None. Will also sort the clients
so the big providers (IRIS and ORFEUS) come last.</p>
<p>Just a modified version of a code in the obspy mass downloader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>clients</strong> (<em>List</em><em>[</em><em>str</em><em>] or </em><em>str</em><em> or </em><em>None</em>) – List of strings, each describing one client.
Put None if you want to use all available.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuple of the fdsn Client objects.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[Client]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.utils.save_raw">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></span><span class="sig-name descname"><span class="pre">save_raw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">saved</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">st</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inv</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.inventory.inventory.Inventory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveasdf</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#save_raw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.save_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the raw waveform data in the desired format.
The point of this function is mainly that the waveforms will be saved
with the correct associations and at the correct locations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>saved</strong> (<em>dict</em>) – Dictionary holding information about the original streams
to identify them afterwards.</p></li>
<li><p><strong>st</strong> (<em>Stream</em>) – obspy stream holding all data (from various stations)</p></li>
<li><p><strong>rawloc</strong> (<em>str</em>) – Parental directory (with phase) to save the files in.</p></li>
<li><p><strong>inv</strong> (<em>Inventory</em>) – The inventory holding all the station information</p></li>
<li><p><strong>saveasdf</strong> (<em>bool</em>) – If True the data will be saved in asdf format.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.utils.utils.save_raw_mseed">
<span class="sig-prename descclassname"><span class="pre">pyglimer.utils.utils.</span></span><span class="sig-name descname"><span class="pre">save_raw_mseed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">threading.Event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slst</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">obspy.core.stream.Stream</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rawloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">net</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/utils/utils.html#save_raw_mseed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.utils.utils.save_raw_mseed" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves input stream in the correct location in mini seed format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evt</strong> (<em>Event</em>) – event that is associated to the recording.</p></li>
<li><p><strong>slst</strong> (<em>Stream</em>) – The selected stream. Should contain all components of one
recording of a teleseismic event.</p></li>
<li><p><strong>rawloc</strong> (<em>str</em>) – Location (with phase) to save the miniseed files in (will
also create subfolders).</p></li>
<li><p><strong>net</strong> (<em>str</em>) – Network code</p></li>
<li><p><strong>stat</strong> (<em>str</em>) – Station Code</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-ccp">
<h2>pyglimer.ccp<a class="headerlink" href="#pyglimer-ccp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.ccp.ccp">
<span id="pyglimer-ccp-ccp"></span><h3>pyglimer.ccp.ccp<a class="headerlink" href="#module-pyglimer.ccp.ccp" title="Permalink to this headline">¶</a></h3>
<p>Module for the Common Conversion Stack Computation and handling of the
objects resulting from such.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Friday, 10th April 2020 05:30:18 pm
Last Modified: Monday, 4th October 2021 05:08:14 pm</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></span><span class="sig-name descname"><span class="pre">CCPStack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_load</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Is a CCP Stack matrix. Its size depends upon stations that are used as
input.</p>
<p>Creates an empy object template for a CCP stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of all seismic stations.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of all seismic stations.</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Inter bin distance in angular distance.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true -&gt; console output. The default is True.</p></li>
<li><p><strong>logdir</strong> – Directory for log file</p></li>
<li><p><strong>_load</strong> (<em>str</em>) – Parameter is only used internally when loading from a
binary numpy file. Then, this passes a filename.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.compute_kdtree_volume">
<span class="sig-name descname"><span class="pre">compute_kdtree_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.compute_kdtree_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.compute_kdtree_volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the CCP kdtree, we get the closest few points and compute
the weighting using a distance metric. if points are too far away,
they aren’t weighted</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qlon</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – grid defining array for longitude</p></li>
<li><p><strong>qlat</strong> (<em>np.ndarray</em><em> or </em><em>list</em>) – grid defining array for latitude</p></li>
<li><p><strong>gz</strong> (<em>np.array</em><em> or </em><em>list</em>) – grid defining array for z</p></li>
<li><p><strong>r</strong> (<em>float</em><em> or </em><em>None</em>) – outside r everything is nan</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>[type]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.compute_stack">
<span class="sig-name descname"><span class="pre">compute_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vel_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'hdf5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocoords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.57735026918962573</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'joblib'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.compute_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp, using the data from rfloc.
The stack can be limited to some networks and stations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either <cite>iasp91.dat</cite>
for 1D raytracing or <cite>3D</cite> for 3D raytracing with GYPSuM model.
Using 3D Raytracing will cause the code to take about 30% longer.</p></li>
<li><p><strong>rfloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder in which the receiver functions in
time domain are. The default is ‘output/waveforms/RF.</p></li>
<li><p><strong>in_format</strong> (<em>str</em><em>, </em><em>optional</em>) – <strong>INPUT FORMAT</strong> of receiver functions. Either
<cite>‘sac’</cite> or <cite>‘hdf5’</cite>. Defaults to ‘hdf5’.</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental folder containing the preprocessed mseeds.
Only needed if option geocoords is used. The default is
None. <strong>Should be None if hdf5 is used!</strong></p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Network or networks that are to be included in the ccp stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – This parameter is ignored if the pattern is given.
Station or stations that are to be included in the ccp stack.
Standard unix wildcards are allowed.
Can only be list if type(network)=str.
If None, the whole database
will be used. The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – Include all stations in the rectangle given by
(minlat, maxlat, minlon, maxlon). Will be ignored if pattern or
network is given, by default None.</p></li>
<li><p><strong>pattern</strong> (<em>list</em><em>, </em><em>optional</em>) – Search pattern for files. Overwrites network,
station, and geocooords options. Usually only used by
<a class="reference internal" href="#pyglimer.ccp.ccp.init_ccp" title="pyglimer.ccp.ccp.init_ccp"><code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code></a>, defaults to None.</p></li>
<li><p><strong>save</strong> (<em>str</em><em> or </em><em>bool</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with
filename will be saved in config.ccp. Will be saved as pickle file.</p></li>
<li><p><strong>filt</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Decides whether to filter the receiver function prior to
depth migration. Either a Tuple of form <cite>(lowpassf, highpassf)</cite> or
<cite>None</cite> / <cite>False</cite>.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – Defines the bin radius with
bin radius = binrad*distance_bins.
Full Overlap = 1/(2*cosd(30)), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – appends piercing point coordinates if True, so they
can later be plotted. Not recommended for big data sets.
The default is false. <strong>Deprecated for multi-core</strong></p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Append receiver functions for first order multiples.
It can be decided later, whether they should be used in the final
ccp stack. Will result in a longer computation time.</p></li>
<li><p><strong>mc_backend</strong> – Multi-core backend to use for the computations.
Can be either <cite>“joblib”</cite> (multiprocessing) or <cite>“MPI”</cite>. Not that
MPI compatibility is only implemented with hdf5 files.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For wrong inputs</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This will take a long while for big data sets!</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using, <cite>mc_backend=’MPI’</cite>. This has to be started from a
terminal via mpirun.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MPI is only compatible with receiver functions saved in hdf5
format.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the grid should be big enough for the provided networks
and stations. Best to create the CCPStack object by using
<code class="xref py py-func docutils literal notranslate"><span class="pre">init_ccp()</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.conclude_ccp">
<span class="sig-name descname"><span class="pre">conclude_ccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_empty</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_water</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.conclude_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.conclude_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Averages the CCP-bin and populates empty cells with average of
neighbouring cells. No matter which option is
chosen for the parameters, data is never lost entirely. One can always
execute a new conclude_ccp() command. However, decisions that are
taken here will affect the .mat output and plotting outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keep_empty</strong> (<em>bool</em><em>, </em><em>optional</em>) – Keep entirely empty bins. The default is False.</p></li>
<li><p><strong>keep_water</strong> (<em>bool</em><em>, </em><em>optional</em>) – For False all bins that are on water-covered areas
will be discarded, defaults to False</p></li>
<li><p><strong>r</strong> (<em>int</em><em>, </em><em>optional</em>) – Fields with less than r hits will be set equal 0.
r has to be &gt;= 1, defaults to 3.</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em> or </em><em>str</em>) – Use multiples in stack. Either False or weigthing;
i.e. ‘linear’ for linearly weighted stack between the three phases,
‘zk’ for a Zhu &amp; Kanamori approach, or ‘pws’ for a phase weighted
stack. Use ‘m1’ to use only first multiple mode (no stack),
‘m2’ for
RFs created only with 2nd multiple phase (PSS), and m for an
equal-weight stack of m1 and m2. By default False.</p></li>
<li><p><strong>z_multiple</strong> (<em>int</em><em>, </em><em>optional</em>) – Until which depth [km] should multiples be
considered,
maximal value is 200 [km]. Will only be used if multiple=True.
By default 200 km.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.create_vtk_mesh">
<span class="sig-name descname"><span class="pre">create_vtk_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.create_vtk_mesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.create_vtk_mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a mesh with given bounding box s</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo</strong> (<em>bool</em><em>, </em><em>optional</em>) – flag whether the output mesh is in geographical coordinates or
meters, by default True</p></li>
<li><p><strong>bbox</strong> (<em>list</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – bounding box [minlon, maxlon, minlat, maxlat]. If None
No boundaries are taken, by default None</p></li>
<li><p><strong>filename</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – If set, the computed grid will be output as VTK file under the
given filename. This file can then later be opened using either the
plotting tool or, e.g., Paraview. If None, no file is written.
By default, None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>outputs a vtk mesh that can be opened in, e.g., Paraview.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VTK.UnstructuredGrid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.explore">
<span class="sig-name descname"><span class="pre">explore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.explore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.explore" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a volume exploration window set. One window is for all
plots, and the other window is generated with sliders such that one
can explore how future plots should be generated. It technically does
not require any inputs, as simply the binning size will be used to
create a meshgrid fitting to the bin distance distribution.
One can however set a factor by which to divide the bin distance for a
finer grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>) – Bingrid epicentral distance multiplier to refine grid.
Defaults to 0.5.</p></li>
<li><p><strong>maxz</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Maximum Depth if None, the max ccp bin depth is used.
Defaults to None.</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
<li><p><strong>extent</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>Non</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VolumeExploration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.map_plot">
<span class="sig-name descname"><span class="pre">map_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_stations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_illum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_direct</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.map_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.map_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a map plot of the CCP Stack containing user-defined information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_stations</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot the station locations, by default False</p></li>
<li><p><strong>plot_bins</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot bin location, by default False</p></li>
<li><p><strong>plot_illum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot bin location with colour depending on the depth-cumulative
illumination at bin b, by default False</p></li>
<li><p><strong>profile</strong> (<em>list</em><em> or </em><em>tupleor None</em><em>, </em><em>optional</em>) – Plot locations of cross sections into the plot. Information about
each cross section is given as a tuple (lon1, lon2, lat1, lat2),
several cross sections are given as a list of tuples in said
format, by default None.</p></li>
<li><p><strong>p_direct</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true the list in profile decribes areas with coordinates of the
lower left and upper right corner, by default True</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Save plot to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format for the file to be saved as, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI for none vector format plots, by default 300</p></li>
<li><p><strong>geology</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot a geological map. Requires internet connection</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Set title for plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.multicore_stack">
<span class="sig-name descname"><span class="pre">multicore_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_closest_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmodel</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonb</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.multicore_stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.multicore_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in chunks of data to be processed on one core.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stream</strong> (<em>list</em>) – List of file locations.</p></li>
<li><p><strong>append_pp</strong> (<em>Bool</em>) – Should piercing points be appended?.</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of Closest points that the KDTree
should query.</p></li>
<li><p><strong>vmodel</strong> (<em>str</em>) – Name of the velocity model that should be used for the
raytraycing.</p></li>
<li><p><strong>latb</strong> (<em>Tuple</em>) – Tuple in Form (minlat, maxlat). To save RAM on 3D
raytraycing. Will remain unused for 1D RT.</p></li>
<li><p><strong>lonb</strong> (<em>Tuple</em>) – Tuple in Form (minlon, maxlon). To save RAM on 3D
raytraycing. Will remain unused for 1D RT</p></li>
<li><p><strong>filt</strong> (<em>bool</em><em> or </em><em>tuple</em><em>]</em>) – Should the RFs be filtered before the ccp stack?
If so, provide (lowcof, highcof).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Three lists containing indices and rf-data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list, list, list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.pick_phase">
<span class="sig-name descname"><span class="pre">pick_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pol</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'+'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyglimer.ccp.ccp.PhasePick" title="pyglimer.ccp.ccp.PhasePick"><span class="pre">pyglimer.ccp.ccp.PhasePick</span></a></span></span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.pick_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.pick_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick the strongest negative or strongest positive gradient from a
predefined depth-range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pol</strong> (<em>str</em><em>, </em><em>optional</em>) – Either ‘+’ for positive velocity gradient or ‘-‘ for negative
gradient, by default ‘+’</p></li>
<li><p><strong>depth</strong> (<em>list</em><em>, </em><em>optional</em>) – List with two elements [minz, maxz], defines in which depth window
the phase picker is gonna look for maxima and minima,
by default [None, None]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A phasepick object, which subsequently can be plotted.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyglimer.ccp.ccp.PhasePick" title="pyglimer.ccp.ccp.PhasePick">PhasePick</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For errandeous inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.plot_bins">
<span class="sig-name descname"><span class="pre">plot_bins</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple map view of the bins.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.plot_cross_section">
<span class="sig-name descname"><span class="pre">plot_cross_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_cross_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_cross_section" title="Permalink to this definition">¶</a></dt>
<dd><p>See documentation for
<a class="reference internal" href="#pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section" title="pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_cross_section()</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.plot_volume_sections">
<span class="sig-name descname"><span class="pre">plot_volume_sections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qlon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qlat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lonsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zsl</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minillum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.plot_volume_sections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.plot_volume_sections" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the same plot as the <cite>explore</cite> tool, but(!) statically and
with more options left to the user.</p>
<p>!!! IT IS IMPORTANT for the plotting function that the input arrays
are monotonically increasing!!!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qlon</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>qlat</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – Monotonically increasing ndarray. No failsafes implemented.</p></li>
<li><p><strong>lonsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of lon is used,
by default None</p></li>
<li><p><strong>latsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of lat is used,
by default None</p></li>
<li><p><strong>zsl</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Slice location, if None, the center of depth is used,
by default None</p></li>
<li><p><strong>r</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Max radius for interpolation values taken into account [km],
if None bingrid.edist * DEG2KM * 2.0, by default None</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Minimum number of illumation points use in the interpolation,
everything below is downweighted by the square reciprocal</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to make figure window visible, default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[description]</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>VolumePlot</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.query_bin_tree">
<span class="sig-name descname"><span class="pre">query_bin_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_closest_points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.query_bin_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Find closest bins for provided latitude and longitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (<em>1-D numpy.ndarray</em>) – Latitudes of piercing points.</p></li>
<li><p><strong>longitude</strong> (<em>1-D numpy.ndarray</em>) – Longitudes of piercing points.</p></li>
<li><p><strong>n_closest_points</strong> (<em>int</em>) – Number of closest points to be found.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bin index k and depth index j</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.CCPStack.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pickle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#CCPStack.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.CCPStack.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the CCPStream file as pickle or matlab file. Only save
as Matlab file for exporting, as not all information can be
preserved!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name as which to save, file extensions aren’t
necessary.</p></li>
<li><p><strong>folder</strong> (<em>str</em><em>, </em><em>optional</em>) – Output folder, defaults to ‘output/ccps’</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – Either <cite>“pickle”</cite>, <cite>‘npz’</cite> or <cite>“matlab”</cite> for .mat,
defaults to “pickle”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Saving in numpy (npz) format is the most robust option. However,
loading those files will take the longest time as some attributes
have to be recomputed. <strong>NUMPY FORMAT IS RECOMMENDED FOR
ARCHIVES!</strong></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Pickling files is the fastest option, but might lead to
incompatibilities between different PyGLImER versions.
<strong>USE PICKLE IF YOU WOULD LIKE TO SAVE FILES FOR SHORTER AMOUNTS
OF TIME.</strong></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Saving as Matlab files is only meant if one wishes to plot with
the old Matlab Receiver function exploration toolset (not
recommended anymore).</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.PhasePick">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></span><span class="sig-name descname"><span class="pre">PhasePick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitudes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polarity</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depthrange</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">[None,</span> <span class="pre">None]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#PhasePick"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.PhasePick" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A phasepick object, just created for more convenient plotting.</p>
<p>Initialise object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em>) – 2-d array containing latitudes and longitudes.</p></li>
<li><p><strong>amplitudes</strong> (<em>np.ndarray</em>) – 1-D array containg amplitude values of each bin</p></li>
<li><p><strong>polarity</strong> (<em>str</em>) – Either ‘+’ for positive velocity gradients or ‘-‘ for negative</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – 1D array containing depth of maxima/minima per bin</p></li>
<li><p><strong>depthrange</strong> (<em>list</em><em>, </em><em>optional</em>) – list containing depth restrictions in form of [zmin, zmax],
by default [None, None]</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.PhasePick.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_amplitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'gist_rainbow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#PhasePick.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.PhasePick.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot heatmap containing depth or amplitude of picked phase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_amplitude</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True amplitude instead of depths is plotted, by default False</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Write Figure to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – File format, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – Resolution for non-vector graphics, by default 300</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap</p></li>
<li><p><strong>geology</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot geological map.</p></li>
<li><p><strong>title</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.init_ccp">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></span><span class="sig-name descname"><span class="pre">init_ccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vel_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preproloc</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">station</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geocoords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_stack</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.86602540378443871</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">append_pp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiple</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'hdf5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc_backend</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'joblib'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><span class="pre">pyglimer.ccp.ccp.CCPStack</span></a></span></span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#init_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.init_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a ccp stack in self.ccp using data from statloc and rfloc.
The stack can be limited to some networks and
stations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rfloc</strong> (<em>str</em>) – Parental directory in that the RFs are saved.</p></li>
<li><p><strong>spacing</strong> (<em>float</em>) – Angular distance between each bingrid point.</p></li>
<li><p><strong>vel_model</strong> (<em>str</em>) – Velocity model located in data. Either iasp91 (1D
raytracing) or 3D for 3D raytracing using a model compiled from GyPSuM.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – The teleseismic phase to be used.</p></li>
<li><p><strong>preproloc</strong> (<em>str</em><em>, </em><em>optional</em>) – Parental directory in that the preprocessed miniseeds are
saved, defaults to None. <strong>Should be None when working with h5 files!</strong></p></li>
<li><p><strong>network</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Network or networks that are to be included in the ccp
stack.
Standard unix wildcards are allowed. If None, the whole database
will be used. The default is None., defaults to None</p></li>
<li><p><strong>station</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Station or stations that are to be included in the ccp
stack. Standard unix wildcards are allowed. Can only be list if
type(network)==str. If None, the whole database will be used.
The default is None.</p></li>
<li><p><strong>geocoords</strong> (<em>Tuple</em><em>, </em><em>optional</em>) – An alternative way of selecting networks and stations.
Given in the form (minlat, maxlat, minlon, maxlon), defaults to None</p></li>
<li><p><strong>compute_stack</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true it will compute the stack by calling
<a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack.compute_stack" title="pyglimer.ccp.ccp.CCPStack.compute_stack"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute_stack()</span></code></a>.
That can take a long time! The default is False.</p></li>
<li><p><strong>filt</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Decides whether to filter the receiver function prior to
depth migration. Either a Tuple of form <cite>(lowpassf, highpassf)</cite> or
<cite>None</cite> / <cite>False</cite>.</p></li>
<li><p><strong>binrad</strong> (<em>float</em><em>, </em><em>optional</em>) – <em>Only used if compute_stack=True</em>
Defines the bin radius with bin radius = binrad*distance_bins.
Full Overlap = cosd(30), Full coverage: 1.
The default is full overlap.</p></li>
<li><p><strong>append_pp</strong> (<em>bool</em><em>, </em><em>optional</em>) – <em>Only used if compute_stack=True.</em>
Appends piercing point locations to object. Can be used to plot
pps on map. Not recommended for large datasets as it takes A LOT
longer and makes the file a lot larger.
The default is False., defaults to False</p></li>
<li><p><strong>multiple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Should the CCP Stack be prepared to work with multiples?
It can be chosen later, whether the RFs from multiples are to be
incorporated into the CCP Stack. By default False.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Either False if the ccp should not be saved or string with
filename will be saved. Will be saved as pickle file.
The default is False.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display info in terminal., defaults to True</p></li>
<li><p><strong>format</strong> (<em>str</em>) – The <strong>INPUT FORMAT</strong> from which receiver functions are read.
If you saved your receiver function as hdf5 files, set ==hdf5.
Defaults to hdf5.</p></li>
<li><p><strong>mc_backend</strong> – Multi-core backend to use for the computations.
Can be either <cite>“joblib”</cite> (multiprocessing) or <cite>“MPI”</cite>. Not that MPI
compatibility is only implemented with hdf5 files.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – For wrong inputs.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPstack</span></code></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using, <cite>mc_backend=’MPI’</cite>. This has to be started from a terminal
via mpirun.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MPI is only compatible with receiver functions saved in hdf5 format.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.ccp.read_ccp">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.ccp.</span></span><span class="sig-name descname"><span class="pre">read_ccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><span class="pre">pyglimer.ccp.ccp.CCPStack</span></a></span></span><a class="reference internal" href="../_modules/pyglimer/ccp/ccp.html#read_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.ccp.read_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Read CCP-Stack class file from input folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Filename of the input file with file ending.
The default is ‘ccp.pkl’.</p></li>
<li><p><strong>fmt</strong> (<em>str</em><em>, </em><em>optional</em>) – File format, can be none if the filename has an ending,
possible options are <cite>“pickle”</cite> or <cite>“npz”</cite>. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – For unknown formats</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CCPStack object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><code class="xref py py-class docutils literal notranslate"><span class="pre">CCPStack</span></code></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Loading Files from numpy format will take a while as some
recomputations are necessary.</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.io">
<span id="pyglimer-ccp-io"></span><h3>pyglimer.ccp.io<a class="headerlink" href="#module-pyglimer.ccp.io" title="Permalink to this headline">¶</a></h3>
<p>This module will handle file IO. The problematic functions here are the
incoming <cite>.mat</cite> files that are produced by the GLImER database.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.io.load_rawrf">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></span><span class="sig-name descname"><span class="pre">load_rawrf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/io.html#load_rawrf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_rawrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a matlab raw RF file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – filename of the receiver function <code class="docutils literal notranslate"><span class="pre">.mat</span></code>-file to be loaded. The
<code class="docutils literal notranslate"><span class="pre">.mat</span></code>-file is expected to contain following parameters. See Notes
below for required content of matlab rawRf file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Set of RF variables</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>rfs, baz, rayp, lat, lon, elev, dt</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>File content</p>
<dl class="field-list simple">
<dt class="field-odd">Crfs</dt>
<dd class="field-odd"><p>MxN matrix of M Receiver Functions and N elements</p>
</dd>
<dt class="field-even">Cbaz</dt>
<dd class="field-even"><p>M elements long vector with back azimuth values corresponding to
Receiver functions</p>
</dd>
<dt class="field-odd">Crayp</dt>
<dd class="field-odd"><p>M elements long vector with ray parameter values corresponding to
Receiver functions</p>
</dd>
<dt class="field-even">Cslat</dt>
<dd class="field-even"><p>M elements long vector with station latitude corresponding to
Receiver functions</p>
</dd>
<dt class="field-odd">Cslon</dt>
<dd class="field-odd"><p>M elements long vector with station longitude corresponding to
Receiver functions</p>
</dd>
<dt class="field-even">Celev</dt>
<dd class="field-even"><p>M elements long vector with station elevation</p>
</dd>
<dt class="field-odd">Dt</dt>
<dd class="field-odd"><p>sampling interval</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.io.load_tracefile">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></span><span class="sig-name descname"><span class="pre">load_tracefile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/io.html#load_tracefile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_tracefile" title="Permalink to this definition">¶</a></dt>
<dd><p>Loading an RF file that has been raytraced.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.io.load_velocity_model">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.io.</span></span><span class="sig-name descname"><span class="pre">load_velocity_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/io.html#load_velocity_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.io.load_velocity_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads velocity model and outputs velocities and corresponding
parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>vlat, vlon, vdep, vp, vs</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.compute.bin">
<span id="pyglimer-ccp-compute-bin"></span><h3>pyglimer.ccp.compute.bin<a class="headerlink" href="#module-pyglimer.ccp.compute.bin" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)
Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Created: November 2019
Last Modified: Thursday, 19th August 2021 09:39:42 am</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyglimer.ccp.compute.bin.BinGrid">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.compute.bin.</span></span><span class="sig-name descname"><span class="pre">BinGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edist</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates Bingrid object from parameters</p>
<p>BinGrid object that can be used to find closest neighbours to
stations and CCP bins</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.array</cite>) – Latitudes</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.array</cite>) – Longitudes</p></li>
<li><p><strong>edist</strong> (<em>float</em>) – Distance (in degree) between bin centres.</p></li>
<li><p><strong>phase</strong> (<em>str</em>) – Seismic phase either “S” or “P”. Phase “S” will lead to
more grid points being created due to flatter incidence angle.
Hence, phase can be “S” for PRFs but not the other way around.
However, “P” is computationally more efficient.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – consoel output?, defaults to True</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.compute.bin.BinGrid.compute_bins">
<span class="sig-name descname"><span class="pre">compute_bins</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.compute_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.compute_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes bins close to all stations</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.compute.bin.BinGrid.query_bin_tree">
<span class="sig-name descname"><span class="pre">query_bin_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binrad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_bin_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_bin_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1-D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1-D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>binrad</strong> (<em>float</em>) – maximum  distance to be queried in euclidean distance
Equals the radius of the bin, higher = more averaging -&gt;
–&gt; less noise, lower resolution</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Number of neighbours to return. Note that this directly
depends on the ratio of deltabin/binrad.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>1D np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.compute.bin.BinGrid.query_station_tree">
<span class="sig-name descname"><span class="pre">query_station_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">latitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxdist</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.query_station_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.query_station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the query function of the KDTree but takes geolocations as
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>latitude</strong> (1D <cite>numpy.ndarray</cite>) – latitudes to be queried</p></li>
<li><p><strong>longitude</strong> (1D <cite>numpy.ndarray</cite>) – longitudes to be queried</p></li>
<li><p><strong>maxdist</strong> (<em>float</em>) – maximum  distance to be queried in degree</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Euclidian distances to next point, indices of next neighbour.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple with 2 1D <cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyglimer.ccp.compute.bin.BinGrid.station_tree">
<span class="sig-name descname"><span class="pre">station_tree</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/compute/bin.html#BinGrid.station_tree"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.compute.bin.BinGrid.station_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the input</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.plot_utils.plot_cross_section">
<span id="pyglimer-ccp-plot-utils-plot-cross-section"></span><h3>pyglimer.ccp.plot_utils.plot_cross_section<a class="headerlink" href="#module-pyglimer.ccp.plot_utils.plot_cross_section" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.plot_utils.plot_cross_section.get_ax_coor">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.plot_cross_section.</span></span><span class="sig-name descname"><span class="pre">get_ax_coor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/plot_utils/plot_cross_section.html#get_ax_coor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.plot_cross_section.get_ax_coor" title="Permalink to this definition">¶</a></dt>
<dd><p>Just a way to get axes coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>axes</em>) – Givenn axes</p></li>
<li><p><strong>lat</strong> (<em>float</em>) – Latitude</p></li>
<li><p><strong>lon</strong> (<em>float</em>) – Longitude</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Axes coordinates for a given set of lat, lon.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.08.20 11.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.plot_cross_section.</span></span><span class="sig-name descname"><span class="pre">plot_cross_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ccp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geoax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">cartopy.mpl.geoaxes.GeoAxes</span><span class="p"><span class="pre">,</span> </span><span class="pre">cartopy.mpl.geoaxes.GeoAxesSubplot</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapplot</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minillum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfcmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'seismic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depthextent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapextent</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Iterable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/plot_utils/plot_cross_section.html#plot_cross_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.plot_cross_section.plot_cross_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a cross section for given waypoints. If no axes are given, the
function will also create figures for the map and the cross section.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ccp</strong> (<a class="reference internal" href="#pyglimer.ccp.ccp.CCPStack" title="pyglimer.ccp.ccp.CCPStack"><em>CCPStack</em></a>) – CCPStack as computed using the cpp module</p></li>
<li><p><strong>lat</strong> (<em>Arraylike</em>) – Latitudes of the waypoints defining the cross section</p></li>
<li><p><strong>lon</strong> (<em>Arraylike</em>) – Longitudes of the waypoints defining the cross section</p></li>
<li><p><strong>z0</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – if given the map will be plotted with an illumination map at the given
depth, by default None</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>Axes</em><em>]</em><em>, </em><em>optional</em>) – Axes to plot the cross section in, by default None</p></li>
<li><p><strong>geoax</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>GeoAxes</em><em>, </em><em>GeoAxesSubplot</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Axes to plot the waypoins in, by default None</p></li>
<li><p><strong>mapplot</strong> (<em>bool</em><em>, </em><em>optional</em>) – plot the map or not, by default True</p></li>
<li><p><strong>minillum</strong> (<em>int</em><em>, </em><em>optional</em>) – minimum illumination count to not be grayed out, by default 50</p></li>
<li><p><strong>vmin</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – minimum value of the cross section, by default None</p></li>
<li><p><strong>vmax</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – maximum value of the cross section, by default None</p></li>
<li><p><strong>label</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – label to put in the corner of the cross section plot and the
cross section waypoints on the map, by default None</p></li>
<li><p><strong>rfcmap</strong> (<em>str</em><em>, </em><em>optional</em>) – cmap name for the plotting of the cross section, by default “seismic”</p></li>
<li><p><strong>depthextent</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>]</em><em>, </em><em>optional</em>) – List containing two entries defining min and max depth, by default None</p></li>
<li><p><strong>mapextent</strong> (<em>Optional</em><em>[</em><em>Iterable</em><em>]</em><em>, </em><em>optional</em>) – List of 4 entries defining [minlon,maxlon, minlat, maxlat],
by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ax, geoax</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.04.21 20.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.plot_utils.plot_line_buffer">
<span id="pyglimer-ccp-plot-utils-plot-line-buffer"></span><h3>pyglimer.ccp.plot_utils.plot_line_buffer<a class="headerlink" href="#module-pyglimer.ccp.plot_utils.plot_line_buffer" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.plot_utils.plot_line_buffer.plot_line_buffer">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.plot_line_buffer.</span></span><span class="sig-name descname"><span class="pre">plot_line_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/plot_utils/plot_line_buffer.html#plot_line_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.plot_line_buffer.plot_line_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in lat, lon points and creates circular polygons around it. Merges
the polygons of possible</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>np.ndarray</em>) – latitudes of a line</p></li>
<li><p><strong>lon</strong> (<em>np.ndarray</em>) – longitudes of a line</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – epicentral distance of the buffer, by default 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(patch, artist)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.04.21 20.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.ccp.plot_utils.line_buffer">
<span id="pyglimer-ccp-plot-utils-line-buffer"></span><h3>pyglimer.ccp.plot_utils.line_buffer<a class="headerlink" href="#module-pyglimer.ccp.plot_utils.line_buffer" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.ccp.plot_utils.line_buffer.line_buffer">
<span class="sig-prename descclassname"><span class="pre">pyglimer.ccp.plot_utils.line_buffer.</span></span><span class="sig-name descname"><span class="pre">line_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/ccp/plot_utils/line_buffer.html#line_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.ccp.plot_utils.line_buffer.line_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates buffer around geographical line using from pole rotated cap
outlines. This is far from perfect, but it does “a” job. There isn’t much
more that one can and be spherically accurate. As long as the amount of
points in the line is fair this should have no problem to immitate a true
buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>np.ndarray</em>) – latitudes</p></li>
<li><p><strong>lon</strong> (<em>np.ndarray</em>) – longitudes</p></li>
<li><p><strong>delta</strong> (<em>float</em><em>, </em><em>optional</em>) – epicentral distance to line, by default 1.0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Nx2 matrix with coordinates of a polygon that forms a buffer around
the line</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<dl class="field-list simple">
<dt class="field-odd">Authors</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">Last Modified</dt>
<dd class="field-even"><p>2021.04.21 20.00 (Lucas Sawade)</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="pyglimer-plot">
<h2>pyglimer.plot<a class="headerlink" href="#pyglimer-plot" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-pyglimer.plot.plot_map">
<span id="pyglimer-plot-plot-map"></span><h3>pyglimer.plot.plot_map<a class="headerlink" href="#module-pyglimer.plot.plot_map" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Created: Tuesday, 4th August 2020 11:02:52 am
Last Modified: Thursday, 19th August 2021 03:08:57 pm</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_map.plot_bins">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></span><span class="sig-name descname"><span class="pre">plot_bins</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">binlat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binlon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_bins"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_bins" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots bins into a map</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_map.plot_map">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></span><span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_map" title="Permalink to this definition">¶</a></dt>
<dd><p>plot a map</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_map.plot_map_ccp">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></span><span class="sig-name descname"><span class="pre">plot_map_ccp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bincoords</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dbin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illum</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">illummatrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_direct</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_map_ccp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_map_ccp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a map plot of the CCP Stack containing user-defined information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>tuple</em><em>, </em><em>optional</em>) – boundaries for the map view</p></li>
<li><p><strong>lon</strong> (<em>tuple</em><em>, </em><em>optional</em>) – boundaries for the map view</p></li>
<li><p><strong>stations</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot the station locations, by default False</p></li>
<li><p><strong>illum</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot bin location with colour depending on the depth-cumulative
illumination at bin b, by default False</p></li>
<li><p><strong>profile</strong> (<em>list</em><em> or </em><em>tupleor None</em><em>, </em><em>optional</em>) – Plot locations of cross sections into the plot. Information about
each cross section is given as a tuple (lon1, lon2, lat1, lat2),
several cross sections are given as a list of tuples in said
format, by default None.</p></li>
<li><p><strong>p_direct</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true the list in profile decribes areas with coordinates of the
lower left and upper right corner, by default True</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Save plot to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – Format for the file to be saved as, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – DPI for none vector format plots, by default 300</p></li>
<li><p><strong>geology</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot a geological map. Requires internet connection</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Set title for plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_map.plot_stations">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></span><span class="sig-name descname"><span class="pre">plot_stations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_stations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_stations" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots stations into a map</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_map.plot_vel_grad">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_map.</span></span><span class="sig-name descname"><span class="pre">plot_vel_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_amplitude</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'gist_rainbow'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geology</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_map.html#plot_vel_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_map.plot_vel_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot velocity gradient. Use method implemented into object!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em>) – lats and lons</p></li>
<li><p><strong>a</strong> (<em>np.ndarray</em>) – picked amplitudes</p></li>
<li><p><strong>z</strong> (<em>np.ndarray</em>) – picked depths</p></li>
<li><p><strong>plot_amplitude</strong> (<em>bool</em>) – Plot Amplitude or depth?</p></li>
<li><p><strong>lat</strong> (<em>tuple</em><em> or </em><em>None</em>) – Latitude boarder for map</p></li>
<li><p><strong>lon</strong> (<em>tuple o rNone</em>) – Longitude boarder for map</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em>, </em><em>optional</em>) – write plot to file, by default None</p></li>
<li><p><strong>format</strong> (<em>str</em><em>, </em><em>optional</em>) – file format, by default ‘pdf’</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>optional</em>) – resolution for none-vector plots, by default 300</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.plot.plot_utils">
<span id="pyglimer-plot-plot-utils"></span><h3>pyglimer.plot.plot_utils<a class="headerlink" href="#module-pyglimer.plot.plot_utils" title="Permalink to this headline">¶</a></h3>
<p>Plot utilities not to modify plots or base plots.</p>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)
Peter Makus (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>)</p>
</dd>
</dl>
<p>Last Update: June 19, 2020</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.baz_hist">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">baz_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#baz_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.baz_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in backazimuth distribution and number of bins to compute
the distribution of incoming angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>az</strong> (<em>numpy.ndarray</em>) – azimuthal distribution in 1D array</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – Number of bins</p></li>
<li><p><strong>Returns</strong> – </p></li>
<li><p><strong>-------å</strong> – </p></li>
<li><p><strong>None</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.plot_catalog">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalog</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#plot_catalog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.plot_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in event catalog and plots events as a function of location and
moment magnitude.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.plot_section">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_section</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rfst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">channel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timelimits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epilimits</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalingfactor</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#plot_section"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.plot_section" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a receiver function section as a function
of epicentral distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rfst</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pyglimer.RFStream</span></code>) – Stream of receiver functions</p></li>
<li><p><strong>timelimits</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – y axis time limits in seconds (len(list)==2).
If <cite>None</cite> full traces is plotted.
Default None.</p></li>
<li><p><strong>epilimits</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None = None</em><em>,</em>) – y axis time limits in seconds (len(list)==2).
If <cite>None</cite> from 30 to 90 degrees plotted.
Default None.</p></li>
<li><p><strong>scalingfactor</strong> (<em>float</em>) – sets the scale for the traces. Could be automated in
future functions(Something like mean distance between
traces)
Defaults to 2.0</p></li>
<li><p><strong>line</strong> (<em>bool</em>) – plots black line of the actual RF
Defaults to True</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – sets linewidth of individual traces</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – <dl class="simple">
<dt>If True, clears out all axes and plots RF only.</dt><dd><p>Defaults to False.</p>
</dd>
</dl>
<p>Returns</p>
</p></li>
<li><p><strong>-------</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.plot_single_rf">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">plot_single_rf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tlim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">matplotlib.axes._axes.Axes</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputdir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_fix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">post_fix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#plot_single_rf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.plot_single_rf" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates plot of a single receiver function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">pyglimer.RFTrace</span></code>) – single receiver function trace</p></li>
<li><p><strong>tlim</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – x axis time limits in seconds if type==’time’ or depth in km if
type==depth (len(list)==2).
If <cite>None</cite> full trace is plotted.
Default None.</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em> or </em><em>tuple</em><em> or </em><em>None</em>) – y axis amplitude limits in. If <cite>None</cite> ± 1.05 absmax. Default None.</p></li>
<li><p><strong>depth</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – 1D array of depths</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>) – Can define an axes to plot the RF into. Defaults to None.
If None, new figure is created.</p></li>
<li><p><strong>outputdir</strong> (<em>str</em><em>, </em><em>optional</em>) – If set, saves a pdf of the plot to the directory.
If None, plot will be shown instantly. Defaults to None.</p></li>
<li><p><strong>pre_fix</strong> (<em>str</em><em>, </em><em>optional</em>) – prepend filename</p></li>
<li><p><strong>post_fix</strong> (<em>str</em><em>, </em><em>optional</em>) – append to filename</p></li>
<li><p><strong>clean</strong> (<em>bool</em>) – If True, clears out all axes and plots RF only.
Defaults to False.</p></li>
<li><p><strong>std</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt><strong>Only if self.type == stastack</strong>. Plots the upper and lower</dt><dd><p>limit of the standard deviation in the plot. Provide the std
as a numpy array (can be easily computed from the output of
<a class="reference internal" href="#pyglimer.rf.create.RFStream.bootstrap" title="pyglimer.rf.create.RFStream.bootstrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bootstrap()</span></code></a>)</p>
</dd>
</dl>
<p>Returns</p>
</p></li>
<li><p><strong>-------</strong> – </p></li>
<li><p><strong>ax</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.rayp_hist">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">rayp_hist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#rayp_hist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.rayp_hist" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in rayparameter distribution and number of bins to compute
the distribution of incoming angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>numpy.ndarray</em>) – 1D ndarray of rayparameters</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – Number of bins</p></li>
<li><p><strong>v</strong> (<em>float</em>) – assummed surface velocity for the computation of the
incidence angle. Default 5.8 km/s.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – indicates which incidence wave is meant ‘S’ or ‘P’. Default is ‘P’
simple defines boundaries of the plot nothing more nothing less.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Get Incidence angle p = sin i/v &lt;–&gt; v sin i / p &lt;–&gt; i = asin(vp)
Default value 5.8 km/s taken from PREM.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.remove_all">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">remove_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'none'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#remove_all"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.remove_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes all frames and ticks.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.remove_topright">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">remove_topright</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#remove_topright"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.remove_topright" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes top and right border and ticks from input axes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.plot_utils.stream_dist">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.plot_utils.</span></span><span class="sig-name descname"><span class="pre">stream_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rayp</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baz</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">5.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'P'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/plot_utils.html#stream_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.plot_utils.stream_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses backazimuth and rayparameter histogram plotting tools to create
combined overview over the Distribution of incident waves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayp</strong> (<em>numpy.ndarray</em>) – 1D ndarray of rayparameters</p></li>
<li><p><strong>az</strong> (<em>numpy.ndarray</em>) – azimuthal distribution in 1D array</p></li>
<li><p><strong>nbins</strong> (<em>int</em>) – Number of bins</p></li>
<li><p><strong>v</strong> (<em>float</em>) – assummed surface velocity for the computation of the
incidence angle. Default 5.8 km/s.</p></li>
<li><p><strong>phase</strong> (<em>string</em>) – indicates which incidence wave is meant ‘S’ or ‘P’. Default is ‘P’
simple defines boundaries of the rayparemeter plot nothing
more nothing less.</p></li>
<li><p><strong>outputfile</strong> (<em>str</em><em> or </em><em>None</em>) – Path to savefile. If None plot is not saved just shown.
Defaults to None.</p></li>
<li><p><strong>format</strong> (<em>str</em>) – outputfile format</p></li>
<li><p><strong>dpi</strong> (<em>int</em>) – only used if file format is none vector.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyglimer.plot.plot_volume">
<span id="pyglimer-plot-plot-volume"></span><h3>pyglimer.plot.plot_volume<a class="headerlink" href="#module-pyglimer.plot.plot_volume" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: June 19, 2020</p>
</div>
<div class="section" id="module-pyglimer.plot.ui_utils">
<span id="pyglimer-plot-ui-utils"></span><h3>pyglimer.plot.ui_utils<a class="headerlink" href="#module-pyglimer.plot.ui_utils" title="Permalink to this headline">¶</a></h3>
<dl class="field-list simple">
<dt class="field-odd">copyright</dt>
<dd class="field-odd"><p>The PyGLImER development team (<a class="reference external" href="mailto:makus&#37;&#52;&#48;gfz-potsdam&#46;de">makus<span>&#64;</span>gfz-potsdam<span>&#46;</span>de</a>).</p>
</dd>
<dt class="field-even">license</dt>
<dd class="field-even"><p>GNU Lesser General Public License, Version 3
(<a class="reference external" href="https://www.gnu.org/copyleft/lesser.html">https://www.gnu.org/copyleft/lesser.html</a>)</p>
</dd>
<dt class="field-odd">author</dt>
<dd class="field-odd"><p>Lucas Sawade (<a class="reference external" href="mailto:lsawade&#37;&#52;&#48;princeton&#46;edu">lsawade<span>&#64;</span>princeton<span>&#46;</span>edu</a>)</p>
</dd>
</dl>
<p>Last Update: June 19, 2020</p>
<dl class="py function">
<dt class="sig sig-object py" id="pyglimer.plot.ui_utils.set_sliderval_no_callback">
<span class="sig-prename descclassname"><span class="pre">pyglimer.plot.ui_utils.</span></span><span class="sig-name descname"><span class="pre">set_sliderval_no_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slider</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">matplotlib.widgets.Slider</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyglimer/plot/ui_utils.html#set_sliderval_no_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyglimer.plot.ui_utils.set_sliderval_no_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Set slider value to <em>val</em></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>val</strong> (<em>float</em>) – </p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="plotting.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Plotting</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Peter Makus, Lucas Sawade<br/>
        
            &copy; Copyright 2021, the PyGLImER development team.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>